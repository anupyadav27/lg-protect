{
  "Compliance Name": "iso27001_2022_aws",
  "ID": "A.8.14",
  "Name": "Redundancy of information processing facilities",
  "Description": "Information processing facilities should be implemented with redundancy sufficient to meet availability",
  "Function Name": "elasticache_redis_cluster_multi_az_enabled",
  "API function": "client = boto3.client('elasticache')",
  "user function": "describe_replication_groups()"
}

:
{
You are given a compliance rule in above formate. Your task is to convert it into a structured JSON file that supports:
1. Multiple clients and functions
2. Field paths used from each function's response
3. Evaluation logic that compares or validates across clients

Output format:
{
  "Compliance Name": "...",
  "ID": "...",
  "Name": "...",
  "Description": "...",
  "Function Name": "...",
  "clients": ["ec2", "ssm"],
  "functions": {
    "ec2": {
      "method": "describe_instances",
      "field_path": "Reservations[].Instances[].InstanceId"
    },
    "ssm": {
      "method": "describe_instance_information",
      "field_path": "InstanceInformationList[].InstanceId"
    }
  },
  "evaluation": {
    "type": "subset",  # other possible values: equal, find, not exists
    "source_client": "ec2",
    "target_client": "ssm",
    "field": "InstanceId"
  }
}

Explanation:
This rule ensures all EC2 instances are also managed by SSM.
So, all EC2 Instance IDs must be found in the list of SSM-managed Instance IDs.

Save the output as:
  compliance_rules/ec2_instance_managed_by_ssm.json
"""

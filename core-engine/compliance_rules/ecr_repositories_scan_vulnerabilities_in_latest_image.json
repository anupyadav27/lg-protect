{
  "Compliance Name": "aws_account_security_onboarding_aws",
  "ID": "Deploy solution to periodically rescan currently used images and report found vulnerabilities",
  "Name": "ECR Repositories Scan Vulnerabilities in Latest Image",
  "Description": "Implement a solution to conduct regular scans on currently employed images and notify about any identified vulnerabilities.",
  "Function Name": "ecr_repositories_scan_vulnerabilities_in_latest_image",
  "clients": ["ecr"],
  "functions": {
    "ecr_repos": {
      "method": "describe_repositories",
      "field_path": "repositories[].repositoryName"
    },
    "ecr_images": {
      "method": "list_images",
      "field_path": "imageIds[].imageTag"
    },
    "ecr_scan_findings": {
      "method": "describe_image_scan_findings",
      "field_path": "imageScanFindings.findings[].severity"
    }
  },
  "evaluation": {
    "type": "exists",
    "source_client": "ecr",
    "field": "imageScanFindings"
  }
}

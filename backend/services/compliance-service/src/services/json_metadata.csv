Provider,FilePath,Tags,RelatedUrl,ServiceName,Description,Categories,Notes,CheckTitle,CheckAliases,DependsOn,SubServiceName,CheckType,CheckID,Remediation,Severity,RelatedTo,ResourceIdTemplate,ResourceType,Risk
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codebuild/codebuild_project_no_secrets_in_variables/codebuild_project_no_secrets_in_variables.metadata.json,,https://docs.aws.amazon.com/codebuild/latest/userguide/how-to-create-project-console.html,codebuild,This check ensures that AWS CodeBuild projects do not contain secrets in environment variables.,[],,Ensure CodeBuild projects do not contain secrets on plaintext environment variables,,[],,['Security Best Practices'],codebuild_project_no_secrets_in_variables,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Do not store secrets in plaintext environment variables. Use AWS Secrets Manager or AWS Systems Manager Parameter Store to securely store and retrieve sensitive information.', 'Url': 'https://docs.aws.amazon.com/codebuild/latest/userguide/change-project.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsCodeBuildProject,"Using plaintext AWS credentials in CodeBuild project environment variables can expose these sensitive keys, leading to unauthorized access and potential security breaches."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codebuild/codebuild_project_user_controlled_buildspec/codebuild_project_user_controlled_buildspec.metadata.json,,,codebuild,Ensure CodeBuild Project uses a controlled buildspec,[],,Ensure CodeBuild Project uses a controlled buildspec,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards']",codebuild_project_user_controlled_buildspec,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use buildspec.yml from a trusted source which user cant interfere with', 'Url': 'https://docs.aws.amazon.com/codebuild/latest/userguide/security.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCodeBuildProject,The CodeBuild projects with user controlled buildspec
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codebuild/codebuild_report_group_export_encrypted/codebuild_report_group_export_encrypted.metadata.json,,https://docs.aws.amazon.com/codebuild/latest/userguide/report-group-export-settings.html,codebuild,Ensure that CodeBuild report group exports are encrypted at rest.,['encryption'],,CodeBuild report group exports are encrypted at rest,,[],,[],codebuild_report_group_export_encrypted,"{'Code': {'CLI': 'aws codebuild update-report-group --arn <report-group-arn> --export-config ""exportConfigType=S3, s3Destination={bucket=, encryptionDisabled=true}""', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-7', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure CodeBuild report group exports to use encryption at rest. This can be done by specifying a KMS key ID when creating or updating the report group.', 'Url': 'https://docs.aws.amazon.com/codebuild/latest/userguide/report-group-export-settings.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,"If CodeBuild report group exports are not encrypted, sensitive data could be exposed to unauthorized access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codebuild/codebuild_project_source_repo_url_no_sensitive_credentials/codebuild_project_source_repo_url_no_sensitive_credentials.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/codebuild-project-source-repo-url-check.html,codebuild,This check ensures an AWS CodeBuild project source repository URL doesn't contain personal access tokens or a user name and password. The check fails if the source repository URL contains personal access tokens or a user name and password.,[],,Ensure CodeBuild project source repository URLs do not contain sensitive credentials,,[],,['Security Best Practices'],codebuild_project_source_repo_url_no_sensitive_credentials,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Update your CodeBuild project to use OAuth instead of personal access tokens or basic authentication in your repository URLs.', 'Url': 'https://docs.aws.amazon.com/codebuild/latest/userguide/use-case-based-samples.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsCodeBuildProject,"Storing or transmitting sign-in credentials in clear text or including them in the source repository URL can lead to unintended data exposure or unauthorized access, potentially compromising the security of the system."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codebuild/codebuild_project_s3_logs_encrypted/codebuild_project_s3_logs_encrypted.metadata.json,,https://docs.aws.amazon.com/codebuild/latest/userguide/change-project.html#change-project-console-logs,codebuild,Ensure that the S3 logs for CodeBuild projects are encrypted at rest.,"['encryption', 'logging']",,Ensure S3 Logs for CodeBuild Projects are encrypted at rest.,,[],,['Effects/Data Exposure'],codebuild_project_s3_logs_encrypted,"{'Code': {'CLI': 'aws codebuild update-project --name <project-name> --logs-config ""s3Logs={status=ENABLED, location=<bucket-name>/<path>, encryptionDisabled=false""}', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-3', 'Terraform': ''}, 'Recommendation': {'Text': ""Ensure that the CodeBuild project's S3 logs are encrypted at rest by setting the `encryptionDisabled` parameter to `false` in the `s3Logs` configuration."", 'Url': 'https://docs.aws.amazon.com/codebuild/latest/userguide/change-project.html#change-project-console-logs'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsCodeBuildProject,"If the logs are not encrypted, sensitive information could be exposed to unauthorized users."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codebuild/codebuild_project_older_90_days/codebuild_project_older_90_days.metadata.json,,,codebuild,Ensure CodeBuild Project has been invoked in the last 90 days,[],,Ensure CodeBuild Project has been invoked in the last 90 days,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards']",codebuild_project_older_90_days,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Check if CodeBuild project are really in use and remove the stale ones', 'Url': 'https://docs.aws.amazon.com/codebuild/latest/userguide/delete-project.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCodeBuildProject,Older CodeBuild projects can be checked to see if they are currently in use.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codebuild/codebuild_project_logging_enabled/codebuild_project_logging_enabled.metadata.json,,https://docs.aws.amazon.com/codebuild/latest/userguide/change-project.html#change-project-console-logs,codebuild,Ensure that CodeBuild projects have S3 or CloudWatch logging enabled.,['logging'],,Ensure that CodeBuild projects have S3 or CloudWatch logging enabled,,[],,[],codebuild_project_logging_enabled,"{'Code': {'CLI': 'aws codebuild update-project --name <project-name> --logs-config ""cloudWatchLogs={status=ENABLED},s3Logs={status=ENABLED""}', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/codebuild-controls.html#codebuild-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logging for CodeBuild projects to capture build events and logs for future analysis and incident response.', 'Url': 'https://docs.aws.amazon.com/codebuild/latest/userguide/change-project.html#change-project-console-logs'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCodeBuildProject,"Without logging, tracking and investigating security incidents in CodeBuild projects becomes challenging, reducing confidence in threat detections."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kinesis/kinesis_stream_data_retention_period/kinesis_stream_data_retention_period.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/kinesis-stream-backup-retention-check.html,kinesis,Ensure Kinesis streams have an adequate data retention period.,[],,Kinesis streams should have an adequate data retention period.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices'],kinesis_stream_data_retention_period,"{'Code': {'CLI': 'aws kinesis increase-stream-retention-period --stream-name <stream-name> --retention-period-hours <hours>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/kinesis-controls.html#kinesis-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure an adequate data retention period for Kinesis streams to ensure data is available for the required timeframe. Set the retention period based on your applicationâ€™s data retention requirements, and consider at least 168 hours (or customize as necessary).', 'Url': 'https://docs.aws.amazon.com/streams/latest/dev/kinesis-extended-retention.html'}}",medium,[],arn:partition:kinesis::account-id:stream/stream-name,AwsKinesisStream,"An inadequate data retention period may result in data records being deleted before they can be processed or backed up, increasing the risk of data loss. This is especially critical for applications that rely on historical data availability for analysis, monitoring, and recovery in case of failures."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kinesis/kinesis_stream_encrypted_at_rest/kinesis_stream_encrypted_at_rest.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html,kinesis,Ensure Kinesis streams use server-side encryption with AWS KMS keys for data protection.,[],,Kinesis streams should be encrypted at rest.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],kinesis_stream_encrypted_at_rest,"{'Code': {'CLI': 'aws kinesis start-stream-encryption --stream-name <your-stream-name> --encryption-type KMS --key-id <your-kms-key-id>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_22/#cloudformation', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/kinesis-controls.html#kinesis-1', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_22/#terraform'}, 'Recommendation': {'Text': 'Enable server-side encryption for Kinesis streams using AWS KMS keys to ensure that all data is encrypted before it is stored, protecting data at rest and reducing the risk of unauthorized access.', 'Url': 'https://docs.aws.amazon.com/streams/latest/dev/getting-started-with-sse.html'}}",medium,[],arn:partition:kinesis::account-id:stream/stream-name,AwsKinesisStream,"If Kinesis streams are not encrypted at rest, sensitive data stored in the stream could be exposed to unauthorized access or breaches. This could lead to potential data theft or misuse of unencrypted data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/organizations/organizations_opt_out_ai_services_policy/organizations_opt_out_ai_services_policy.metadata.json,,https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_ai-opt-out_all.html,organizations,This control checks whether the AWS Organizations opt-out of AI services policy is enabled and whether child-accounts are disallowed to overwrite this policy. The control fails if the policy is not enabled or if child-accounts are not disallowed to overwrite this policy.,[],,Ensure that AWS Organizations opt-out of AI services policy is enabled and disallow child-accounts to overwrite this policy.,,[],,[],organizations_opt_out_ai_services_policy,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Artificial Intelligence (AI) services opt-out policies enable you to control whether AWS AI services can store and use your content. Enable the AWS Organizations opt-out of AI services policy and disallow child-accounts to overwrite this policy.', 'Url': 'https://docs.aws.amazon.com/organizations/latest/userguide/disable-policy-type.html'}}",low,[],arn:partition:service::account-id:organization/organization-id,Other,"By default, AWS may be using your data to train its AI models. This may include data from your AWS CloudTrail logs, AWS Config rules, and AWS GuardDuty findings. If you opt out of AI services, AWS will not use your data to train its AI models."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/organizations/organizations_scp_check_deny_regions/organizations_scp_check_deny_regions.metadata.json,,,organizations,"As best practice, AWS Regions should be restricted and only allow the ones that are needed.",[],,Check if AWS Regions are restricted with SCP policies,,[],,['Logging and Monitoring'],organizations_scp_check_deny_regions,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Restrict AWS Regions using SCP policies.', 'Url': 'https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_examples_general.html#example-scp-deny-region'}}",low,[],arn:partition:service::account-id:organization/organization-id,Other,"The risk associated with not restricting AWS Regions with Service Control Policies (SCPs) is that it can lead to unauthorized access or use of resources in regions that are not intended for use. This can result in increased costs due to inefficiencies in resource usage and can also expose sensitive data to unauthorized access or breaches. By restricting access to AWS Regions with SCP policies, organizations can help ensure that only authorized personnel have access to the resources they need, while minimizing the risk of security breaches and compliance violations."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/organizations/organizations_tags_policies_enabled_and_attached/organizations_tags_policies_enabled_and_attached.metadata.json,,,organizations,Check if an AWS Organization has tags policies enabled and attached.,[],,Check if an AWS Organization has tags policies enabled and attached.,,[],,[],organizations_tags_policies_enabled_and_attached,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable and attach AWS Organizations tags policies.', 'Url': 'https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_tag-policies.html'}}",medium,[],arn:partition:service::account-id:organization/organization-id,Other,"If an AWS Organization tags policies are not enabled and attached, it is not possible to enforce tags on AWS resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/organizations/organizations_delegated_administrators/organizations_delegated_administrators.metadata.json,,,organizations,This check verify if there are AWS Organizations delegated administrators and if they are trusted (you can define your trusted delegated administrator in Prowler configuration),[],,Check if AWS Organizations delegated administrators are trusted,,[],,['Logging and Monitoring'],organizations_delegated_administrators,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Review delegated administrators', 'Url': 'https://docs.aws.amazon.com/organizations/latest/userguide/orgs_delegate_policies.html'}}",high,[],arn:partition:service::account-id:organization/organization-id,Other,"The risk associated with having untrusted delegated administrators within an AWS Organizations is that they may have the ability to access and make changes to sensitive data and resources within an organization's AWS accounts. This can result in unauthorized access or data breaches, which can lead to financial losses, damage to reputation, and legal liabilities. It's important to carefully vet and monitor AWS Organizations delegated administrators to ensure that they are trustworthy and have a legitimate need for access to the organization's resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/organizations/organizations_account_part_of_organizations/organizations_account_part_of_organizations.metadata.json,,,organizations,Ensure that AWS Organizations service is currently in use.,[],,Check if account is part of an AWS Organizations,,[],,['Logging and Monitoring'],organizations_account_part_of_organizations,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Create or Join an AWS Organization', 'Url': 'https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_org_create.html'}}",medium,[],arn:partition:service::account-id:organization/organization-id,Other,"The risk associated with not being part of an AWS Organizations is that it can lead to a lack of centralized management and control over the AWS accounts in an organization. This can make it difficult to enforce security policies consistently across all accounts, and can also result in increased costs due to inefficiencies in resource usage. Additionally, not being part of an AWS Organizations can make it harder to track and manage account usage and access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/shield/shield_advanced_protection_in_classic_load_balancers/shield_advanced_protection_in_classic_load_balancers.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,shield,Check if Classic Load Balancers are protected by AWS Shield Advanced.,[],,Check if Classic Load Balancers are protected by AWS Shield Advanced.,,[],,[],shield_advanced_protection_in_classic_load_balancers,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Add as a protected resource in AWS Shield Advanced.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html'}}",medium,[],,AwsElbLoadBalancer,AWS Shield Advanced provides expanded DDoS attack protection for your resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/shield/shield_advanced_protection_in_route53_hosted_zones/shield_advanced_protection_in_route53_hosted_zones.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,shield,Check if Route53 hosted zones are protected by AWS Shield Advanced.,[],,Check if Route53 hosted zones are protected by AWS Shield Advanced.,,[],,[],shield_advanced_protection_in_route53_hosted_zones,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Add as a protected resource in AWS Shield Advanced.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html'}}",medium,[],,AwsRoute53HostedZone,AWS Shield Advanced provides expanded DDoS attack protection for your resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/shield/shield_advanced_protection_in_cloudfront_distributions/shield_advanced_protection_in_cloudfront_distributions.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,shield,Check if Cloudfront distributions are protected by AWS Shield Advanced.,[],,Check if Cloudfront distributions are protected by AWS Shield Advanced.,,[],,[],shield_advanced_protection_in_cloudfront_distributions,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Add as a protected resource in AWS Shield Advanced.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html'}}",medium,[],,AwsCloudFrontDistribution,AWS Shield Advanced provides expanded DDoS attack protection for your resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/shield/shield_advanced_protection_in_global_accelerators/shield_advanced_protection_in_global_accelerators.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,shield,Check if Global Accelerators are protected by AWS Shield Advanced.,[],,Check if Global Accelerators are protected by AWS Shield Advanced.,,[],,[],shield_advanced_protection_in_global_accelerators,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Add as a protected resource in AWS Shield Advanced.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html'}}",medium,[],,Other,AWS Shield Advanced provides expanded DDoS attack protection for your resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/shield/shield_advanced_protection_in_associated_elastic_ips/shield_advanced_protection_in_associated_elastic_ips.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,shield,Check if Elastic IP addresses with associations are protected by AWS Shield Advanced.,[],,Check if Elastic IP addresses with associations are protected by AWS Shield Advanced.,,[],,[],shield_advanced_protection_in_associated_elastic_ips,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Add as a protected resource in AWS Shield Advanced.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html'}}",medium,[],,AwsEc2Eip,AWS Shield Advanced provides expanded DDoS attack protection for your resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/shield/shield_advanced_protection_in_internet_facing_load_balancers/shield_advanced_protection_in_internet_facing_load_balancers.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,shield,Check if internet-facing Application Load Balancers are protected by AWS Shield Advanced.,[],,Check if internet-facing Application Load Balancers are protected by AWS Shield Advanced.,,[],,[],shield_advanced_protection_in_internet_facing_load_balancers,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Add as a protected resource in AWS Shield Advanced.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html'}}",medium,[],,AwsElbv2LoadBalancer,AWS Shield Advanced provides expanded DDoS attack protection for your resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ssm/ssm_documents_set_as_public/ssm_documents_set_as_public.metadata.json,,https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-before-you-share.html,ssm,Check if there are SSM Documents set as public.,['internet-exposed'],,Check if there are SSM Documents set as public.,,[],,[],ssm_documents_set_as_public,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://github.com/cloudmatos/matos/tree/master/remediations/aws/ssm/ssm-doc-block', 'Terraform': ''}, 'Recommendation': {'Text': 'Carefully review the contents of the document before is shared. Enable SSM Block public sharing for documents.', 'Url': 'https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-before-you-share.html'}}",high,[],arn:aws:ssm:region:account-id:document/document-name,AwsSsmDocument,SSM Documents may contain private information or even secrets and tokens.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ssm/ssm_document_secrets/ssm_document_secrets.metadata.json,,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html,ssm,Find secrets in SSM Documents.,['secrets'],,Find secrets in SSM Documents.,,[],,[],ssm_document_secrets,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Implement automated detective control (e.g. using tools like Prowler) to scan accounts for passwords and secrets. Use Secrets Manager service to store and retrieve passwords and secrets.', 'Url': 'https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html'}}",critical,[],arn:aws:ssm:region:account-id:document/document-name,AwsSsmDocument,Secrets hardcoded into SSM Documents by malware and bad actors to gain lateral access to other services.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ssm/ssm_managed_compliant_patching/ssm_managed_compliant_patching.metadata.json,,https://docs.aws.amazon.com/systems-manager/latest/userguide/patch-compliance-identify.html,ssm,Check if EC2 instances managed by Systems Manager are compliant with patching requirements.,[],,Check if EC2 instances managed by Systems Manager are compliant with patching requirements.,,[],,[],ssm_managed_compliant_patching,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Consider using SSM in all accounts and services to at least monitor for missing patches on servers. Use a robust process to apply security fixes as soon as they are made available. Patch compliance data from Patch Manager can be sent to AWS Security Hub to centralize security issues.', 'Url': 'https://docs.aws.amazon.com/systems-manager/latest/userguide/patch-compliance-identify.html'}}",high,[],arn:aws:ec2:region:account-id:instance/instance-id,AwsSsmPatchCompliance,Without the most recent security patches your system is potentially vulnerable to cyberattacks. Even the best-designed software can not anticipate every future threat to cybersecurity. Poor patch management can leave an organizations data exposed subjecting them to malware and ransomware attacks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/servicecatalog/servicecatalog_portfolio_shared_within_organization_only/servicecatalog_portfolio_shared_within_organization_only.metadata.json,,https://docs.aws.amazon.com/servicecatalog/latest/adminguide/catalogs_portfolios_sharing.html,servicecatalog,This control checks whether AWS Service Catalog shares portfolios within an organization when the integration with AWS Organizations is enabled. The control fails if portfolios aren't shared within an organization.,['trustboundaries'],,Service Catalog portfolios should be shared within an AWS organization only,,[],,['Software and Configuration Checks/AWS Security Best Practices'],servicecatalog_portfolio_shared_within_organization_only,"{'Code': {'CLI': 'aws servicecatalog create-portfolio-share --portfolio-id <portfolio-id> --organization-ids <org-id>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/servicecatalog/latest/adminguide/catalogs_portfolios_sharing.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure AWS Service Catalog to share portfolios only within your AWS Organization for more secure access management.', 'Url': 'https://docs.aws.amazon.com/servicecatalog/latest/adminguide/catalogs_portfolios_sharing.html'}}",high,[],arn:aws:servicecatalog:{region}:{account-id}:portfolio/{portfolio-id},AwsServiceCatalogPortfolio,"Sharing Service Catalog portfolios outside of an organization may result in access granted to unintended AWS accounts, potentially exposing sensitive resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/secretsmanager/secretsmanager_automatic_rotation_enabled/secretsmanager_automatic_rotation_enabled.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html,secretsmanager,Check if Secrets Manager secret rotation is enabled.,[],Infrastructure Protection,Check if Secrets Manager secret rotation is enabled.,,[],,[],secretsmanager_automatic_rotation_enabled,"{'Code': {'CLI': 'aws secretsmanager rotate-secret --region <REGION> --secret-id <SECRET-ID> --rotation-lambda-arn <LAMBDA-ARN> --rotation-rules AutomaticallyAfterDays=30', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Implement automated detective control to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html'}}",medium,[],arn:aws:secretsmanager:region:account-id:secret:secret-name,AwsSecretsManagerSecret,Rotating secrets minimizes exposure to attacks using stolen secrets.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/secretsmanager/secretsmanager_not_publicly_accessible/secretsmanager_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/auth-and-access_resource-policies.html,secretsmanager,This control checks whether Secrets Manager secrets are not publicly accessible via resource policies.,['internet-exposed'],,Ensure Secrets Manager secrets are not publicly accessible.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],secretsmanager_not_publicly_accessible,"{'Code': {'CLI': 'aws secretsmanager delete-resource-policy --secret-id <secret-id>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Review and remove any public access from Secrets Manager policies to follow the Principle of Least Privilege.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/determine-acccess_examine-iam-policies.html'}}",high,[],arn:aws:secretsmanager:region:account-id:secret:secret-name,AwsSecretsManagerSecret,Publicly accessible secrets can expose sensitive information and pose a security risk.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/secretsmanager/secretsmanager_secret_rotated_periodically/secretsmanager_secret_rotated_periodically.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html,secretsmanager,Secrets should be rotated periodically to reduce the risk of unauthorized access.,['secrets'],,Secrets should be rotated periodically,,[],,[],secretsmanager_secret_rotated_periodically,"{'Code': {'CLI': 'aws secretsmanager rotate-secret --secret-id <secret-name>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/secretsmanager-controls.html#secretsmanager-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure automatic rotation for your Secrets Manager secrets.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotate-secrets_lambda.html'}}",medium,[],arn:aws:secretsmanager:region:account-id:secret:secret-name,AwsSecretsManagerSecret,"Rotating secrets in your AWS account reduces the risk of unauthorized access, especially for credentials like passwords or API keys. Automatic rotation via AWS Secrets Manager replaces long-term secrets with short-term ones, lowering the chances of compromise."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/secretsmanager/secretsmanager_secret_unused/secretsmanager_secret_unused.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/manage_delete-secret.html,secretsmanager,Checks whether Secrets Manager secrets are unused.,['secrets'],,Ensure secrets manager secrets are not unused,,[],,[],secretsmanager_secret_unused,"{'Code': {'CLI': 'aws secretsmanager delete-secret --secret-id <secret-arn>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/secretsmanager-controls.html#secretsmanager-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Regularly review Secrets Manager secrets and delete those that are no longer in use.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/manage_delete-secret.html'}}",medium,[],arn:aws:secretsmanager:region:account-id:secret:secret-name,AwsSecretsManagerSecret,"Unused secrets can be abused by former users or leaked to unauthorized entities, increasing the risk of unauthorized access and data breaches."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kms/kms_cmk_not_multi_region/kms_cmk_not_multi_region.metadata.json,,https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html#multi-region-concepts,kms,Ensure that AWS KMS customer managed keys (CMKs) are not multi-region to maintain strict data control and compliance with security best practices.,[],"Multi-region keys should be used only when absolutely necessary, such as for cross-region disaster recovery, and should be carefully managed with strict access controls.",AWS KMS customer managed keys should not be multi-Region,,[],,['Data Protection'],kms_cmk_not_multi_region,"{'Code': {'CLI': 'aws kms create-key --no-multi-region', 'NativeIaC': '', 'Other': '', 'Terraform': 'resource ""aws_kms_key"" ""example"" { description = ""Single-region key"" multi_region = false }'}, 'Recommendation': {'Text': 'Identify and replace multi-region keys with single-region KMS keys to enhance security and access control.', 'Url': 'https://docs.aws.amazon.com/kms/latest/developerguide/mrk-when-to-use.html'}}",high,[],arn:partition:kms:region:account-id:key/resource-id,AwsKmsKey,"Multi-region KMS keys can increase the risk of unauthorized access and data exposure, as managing access controls and auditing across multiple regions becomes more complex. This expanded attack surface may lead to compliance violations and data breaches."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kms/kms_cmk_are_used/kms_cmk_are_used.metadata.json,,,kms,Check if there are CMK KMS keys not used.,['encryption'],,Check if there are CMK KMS keys not used.,,[],,['Data Protection'],kms_cmk_are_used,"{'Code': {'CLI': 'aws kms schedule-key-deletion --key-id <key_id> --pending-window-in-days 7', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Before deleting a customer master key (CMK), you might want to know how many cipher-texts were encrypted under that key.', 'Url': 'https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys-determining-usage.html'}}",medium,[],arn:partition:kms:region:account-id:certificate/resource-id,AwsKmsKey,Unused keys may increase service cost.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kms/kms_key_not_publicly_accessible/kms_key_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/kms/latest/developerguide/determining-access.html,kms,Check exposed KMS keys,"['internet-exposed', 'encryption']",,Check exposed KMS keys,,[],,['Data Protection'],kms_key_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://github.com/cloudmatos/matos/tree/master/remediations/aws/kms/exposed-key', 'Terraform': ''}, 'Recommendation': {'Text': 'To determine the full extent of who or what currently has access to a customer master key (CMK) in AWS KMS, you must examine the CMK key policy, all grants that apply to the CMK and potentially all AWS Identity and Access Management (IAM) policies. You might do this to determine the scope of potential usage of a CMK.', 'Url': 'https://docs.aws.amazon.com/kms/latest/developerguide/determining-access.html'}}",medium,[],arn:partition:kms:region:account-id:certificate/resource-id,AwsKmsKey,Exposed KMS Keys or wide policy permissions my leave data unprotected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kms/kms_cmk_rotation_enabled/kms_cmk_rotation_enabled.metadata.json,,https://aws.amazon.com/blogs/security/how-to-get-ready-for-certificate-transparency/,kms,Ensure rotation for customer created KMS CMKs is enabled.,['encryption'],,Ensure rotation for customer created KMS CMKs is enabled.,,[],,['Data Protection'],kms_cmk_rotation_enabled,"{'Code': {'CLI': 'aws kms enable-key-rotation --key-id <key_id>', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-kms-have-rotation-policy#terraform'}, 'Recommendation': {'Text': 'For every KMS Customer Master Keys (CMKs), ensure that Rotate this key every year is enabled.', 'Url': 'https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html'}}",medium,[],arn:partition:kms:region:account-id:certificate/resource-id,AwsKmsKey,"Cryptographic best practices discourage extensive reuse of encryption keys. Consequently, Customer Master Keys (CMKs) should be rotated to prevent usage of compromised keys."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kms/kms_cmk_not_deleted_unintentionally/kms_cmk_not_deleted_unintentionally.metadata.json,,https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys-scheduling-key-deletion.html,kms,Ensure there is no customer keys scheduled for deletion.,['encryption'],,AWS KMS keys should not be deleted unintentionally,,[],,['Data Deletion Protection'],kms_cmk_not_deleted_unintentionally,"{'Code': {'CLI': 'aws kms cancel-key-deletion --key-id <key-id>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/kms-controls.html#kms-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Cancel the deletion before the end of the period unless you really want to delete that CMK, as it will no longer be usable.', 'Url': 'https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys-scheduling-key-deletion.html#deleting-keys-scheduling-key-deletion-console'}}",critical,[],arn:partition:kms:region:account-id:certificate/resource-id,AwsKmsKey,"KMS keys cannot be recovered once deleted, also, all the data under a KMS key is also permanently unrecoverable if the KMS key is deleted."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eventbridge/eventbridge_bus_exposed/eventbridge_bus_exposed.metadata.json,,https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CWE_GettingStarted.html,eventbridge,Ensure that your AWS EventBridge event bus is not exposed to everyone.,['internet-exposed'],,Ensure that your AWS EventBridge event bus is not exposed to everyone,,[],,[],eventbridge_bus_exposed,"{'Code': {'CLI': 'aws events remove-permission --event-bus-name <event_bus_name> --statement-id <statement_id>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchEvents/event-bus-exposed.html', 'Terraform': ''}, 'Recommendation': {'Text': 'To restrict access to your AWS EventBridge event bus, remove the permission that allows everyone to access it.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CloudWatchEvents-CrossAccountEventDelivery.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEventsEventbus,"If your AWS EventBridge event bus is exposed to everyone, unauthorized users can access your event bus and potentially view or modify your events."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eventbridge/eventbridge_bus_cross_account_access/eventbridge_bus_cross_account_access.metadata.json,,https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CWE_GettingStarted.html,eventbridge,Ensure that AWS EventBridge event buses do not allow unknown cross-account access for delivery of events.,[],,Ensure that AWS EventBridge event buses do not allow unknown cross-account access for delivery of events.,,[],eventbus,[],eventbridge_bus_cross_account_access,"{'Code': {'CLI': 'aws events remove-permission --event-bus-name <event_bus_name> --statement-id <statement_id>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchEvents/event-bus-cross-account-access.html', 'Terraform': ''}, 'Recommendation': {'Text': 'To remediate this issue, remove the unknown cross-account access for delivery of events from the AWS EventBridge event bus.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CloudWatchEvents-CrossAccountEventDelivery.html'}}",high,[],arn:partition:events:region:account-id:event-bus/resource-id,AwsEventsEventbus,"If an AWS EventBridge event bus allows unknown cross-account access for delivery of events, it can lead to unauthorized access to the event bus and its events."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eventbridge/eventbridge_global_endpoint_event_replication_enabled/eventbridge_global_endpoint_event_replication_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/global-endpoint-event-replication-enabled.html,eventbridge,Check if event replication is enabled for an Amazon EventBridge global endpoint. The control fails if event replication isn't enabled.,['redundancy'],,Check if EventBridge global endpoints have event replication enabled.,,[],,['Software and Configuration Checks/Vulnerabilities'],eventbridge_global_endpoint_event_replication_enabled,"{'Code': {'CLI': 'aws events update-endpoint --name <endpoint-name> --event-replication-enabled', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/eventbridge-controls.html#eventbridge-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable event replication for your EventBridge global endpoints to ensure failover and regional fault tolerance.', 'Url': 'https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-global-endpoints.html'}}",medium,[],arn:aws:events:{region}:{account-id}:endpoint/{endpoint-id},AwsEventsEndpoint,"Without event replication, automatic failover in case of Regional failure may not work as expected, increasing the risk of service disruption."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eventbridge/eventbridge_schema_registry_cross_account_access/eventbridge_schema_registry_cross_account_access.metadata.json,,https://aws.amazon.com/about-aws/whats-new/2021/09/cross-account-discovery-amazon-eventbridge-schema/,eventbridge,Ensure that AWS EventBridge schema registries do not allow unknown cross-account access for delivery of events.,[],,Ensure that AWS EventBridge schema registries do not allow unknown cross-account access for delivery of events.,,[],Schemas,[],eventbridge_schema_registry_cross_account_access,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To remediate this issue, ensure that the schema registry is not publicly accessible and that only authorized accounts have access to the schema registry.', 'Url': 'https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-schema.html'}}",high,[],arn:partition:events:region:account-id:event-bus/resource-id,AwsEventSchemasRegistry,"The schema registry is a central location for storing and managing schemas. If the schema registry is not properly secured, it can lead to unauthorized access to the schema registry and the schemas stored within it."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_unauthorized_api_calls/cloudwatch_log_metric_filter_unauthorized_api_calls.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for unauthorized API calls.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for unauthorized API calls.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_unauthorized_api_calls,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_1', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_1#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_changes_to_network_route_tables_alarm_configured/cloudwatch_changes_to_network_route_tables_alarm_configured.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,"Real-time monitoring of API calls can be achieved by directing Cloud Trail Logs to CloudWatch Logs, or an external Security information and event management (SIEM)environment, and establishing corresponding metric filters and alarms. Routing tablesare used to route network traffic between subnets and to network gateways. It isrecommended that a metric filter and alarm be established for changes to route tables.",[],,Ensure route table changes are monitored,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_changes_to_network_route_tables_alarm_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_13', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_13#fix---buildtime'}, 'Recommendation': {'Text': ""If you are using CloudTrails and CloudWatch, perform the following to setup the metric filter, alarm, SNS topic, and subscription: 1. Create a metric filter based on filter pattern provided which checks for route table changes and the <cloudtrail_log_group_name> taken from audit step 1. aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> -- filter-name `<route_table_changes_metric>` --metric-transformations metricName= `<route_table_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventSource = ec2.amazonaws.com) && (($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable)) }' Note: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. 2. Create an SNS topic that the alarm will notify aws sns create-topic --name <sns_topic_name> Note: you can execute this command once and then re-use the same topic for all monitoring alarms. 3. Create an SNS subscription to the topic created in step 2 aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> - -notification-endpoint <sns_subscription_endpoints> Note: you can execute this command once and then re-use the SNS subscription for all monitoring alarms. 4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 aws cloudwatch put-metric-alarm --alarm-name `<route_table_changes_alarm>` --metric-name `<route_table_changes_metric>` --statistic Sum --period 300 - -threshold 1 --comparison-operator GreaterThanOrEqualToThreshold -- evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn>"", 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,"CloudWatch is an AWS native service that allows you to ob serve and monitor resources and applications. CloudTrail Logs can also be sent to an external Security informationand event management (SIEM) environment for monitoring and alerting.Monitoring changes to route tables will help ensure that all VPC traffic flows through anexpected path and prevent any accidental or intentional modifications that may lead touncontrolled network traffic. An alarm should be triggered every time an AWS API call isperformed to create, replace, delete, or disassociate a Route Table."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_changes_to_network_gateways_alarm_configured/cloudwatch_changes_to_network_gateways_alarm_configured.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for changes to network gateways.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for changes to network gateways.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_changes_to_network_gateways_alarm_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_12', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_12#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_for_s3_bucket_policy_changes/cloudwatch_log_metric_filter_for_s3_bucket_policy_changes.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for S3 bucket policy changes.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for S3 bucket policy changes.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_for_s3_bucket_policy_changes,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_8', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_8#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_group_kms_encryption_enabled/cloudwatch_log_group_kms_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/cli/latest/reference/logs/associate-kms-key.html,cloudwatch,Check if CloudWatch log groups are protected by AWS KMS.,['encryption'],,Check if CloudWatch log groups are protected by AWS KMS.,,[],logs,['Data Protection'],cloudwatch_log_group_kms_encryption_enabled,"{'Code': {'CLI': 'associate-kms-key --log-group-name <value> --kms-key-id <value>', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_21#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Associate KMS Key with Cloudwatch log group.', 'Url': 'https://docs.aws.amazon.com/cli/latest/reference/logs/associate-kms-key.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,Other,Using customer managed KMS to encrypt CloudWatch log group provide additional confidentiality and control over the log data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled/cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for CloudTrail configuration changes.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for CloudTrail configuration changes.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_5', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_5#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_cross_account_sharing_disabled/cloudwatch_cross_account_sharing_disabled.metadata.json,,https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Cross-Account-Cross-Region.html,cloudwatch,Check if CloudWatch has allowed cross-account sharing.,[],,Check if CloudWatch has allowed cross-account sharing.,,[],,['Logging and Monitoring'],cloudwatch_cross_account_sharing_disabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Grant usage permission on a per-resource basis to enforce least privilege and Zero Trust principles.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Cross-Account-Cross-Region.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsAccount,Cross-Account access to CloudWatch could increase the risk of compromising information between accounts.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_group_retention_policy_specific_days_enabled/cloudwatch_log_group_retention_policy_specific_days_enabled.metadata.json,,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Logs.html,cloudwatch,Check if CloudWatch Log Groups have a retention policy of specific days.,[],,Check if CloudWatch Log Groups have a retention policy of specific days.,,[],logs,['Data Retention'],cloudwatch_log_group_retention_policy_specific_days_enabled,"{'Code': {'CLI': 'aws logs put-retention-policy --log-group-name <LOG_GROUP_NAME> --retention-in-days <DAYS>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/logging_13#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_13', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/logging_13#terraform'}, 'Recommendation': {'Text': 'Add Log Retention policy of specific days to log groups. This will persist logs and traces for a long time.', 'Url': 'https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Logs.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsLogsLogGroup,"If log groups have a low retention policy of less than specific days, crucial logs and data can be lost."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_changes_to_vpcs_alarm_configured/cloudwatch_changes_to_vpcs_alarm_configured.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for VPC changes.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for VPC changes.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_changes_to_vpcs_alarm_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_14', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_14#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_group_no_secrets_in_logs/cloudwatch_log_group_no_secrets_in_logs.metadata.json,"{'Tag1Key': 'value', 'Tag2Key': 'value'}",https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Check if secrets exists in CloudWatch logs,['secrets'],,Check if secrets exists in CloudWatch logs.,,[],,"['Protect', 'Secure development']",cloudwatch_log_group_no_secrets_in_logs,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'It is recommended that sensitive information is not logged to CloudWatch logs. Alternatively, sensitive data may be masked using a protection policy', 'Url': 'https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/mask-sensitive-log-data.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:log-group/resource-id,Other,Storing sensitive data in CloudWatch logs could allow an attacker with read-only access to escalate their privileges or gain unauthorised access to systems.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_aws_organizations_changes/cloudwatch_log_metric_filter_aws_organizations_changes.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for AWS Organizations changes.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for AWS Organizations changes.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_aws_organizations_changes,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/organizations-changes-alarm.html', 'Terraform': ''}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_alarm_actions_alarm_state_configured/cloudwatch_alarm_actions_alarm_state_configured.metadata.json,,https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html#alarms-and-actions,cloudwatch,This control checks whether an Amazon CloudWatch alarm has at least one action configured for the ALARM state. The control fails if the alarm doesn't have an action configured for the ALARM state.,[],,Check if CloudWatch alarms have specified actions configured for the ALARM state.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],cloudwatch_alarm_actions_alarm_state_configured,"{'Code': {'CLI': 'aws cloudwatch put-metric-alarm --alarm-name <alarm-name> --alarm-actions <action-arn>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-15', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure your CloudWatch alarms to trigger actions, such as sending notifications via Amazon SNS, when the alarm state changes to ALARM.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatch/cloudwatch-alarm-action.html'}}",high,[],arn:aws:cloudwatch:region:account-id:alarm/alarm-name,AwsCloudWatchAlarm,"Without an action configured for the ALARM state, the CloudWatch alarm will not notify you or take any predefined action when a monitored metric goes beyond the defined threshold, potentially delaying responses to critical events."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk/cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs.,['encryption'],Logging and Monitoring,Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_7', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_7#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_authentication_failures/cloudwatch_log_metric_filter_authentication_failures.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for AWS Management Console authentication failures.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for AWS Management Console authentication failures.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_authentication_failures,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_6', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_6#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_sign_in_without_mfa/cloudwatch_log_metric_filter_sign_in_without_mfa.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for Management Console sign-in without MFA.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for Management Console sign-in without MFA.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_sign_in_without_mfa,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_2', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_2#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_security_group_changes/cloudwatch_log_metric_filter_security_group_changes.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for security group changes.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for security group changes.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_security_group_changes,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_10', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_10#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_changes_to_network_acls_alarm_configured/cloudwatch_changes_to_network_acls_alarm_configured.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL).,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL).,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_changes_to_network_acls_alarm_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_11', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_11#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_group_not_publicly_accessible/cloudwatch_log_group_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html,cloudwatch,This check ensures that no CloudWatch Log Groups are publicly accessible by checking for resource policies that allow access from any entity (Principal: '*'). Publicly exposed log groups pose a serious security risk as sensitive log data could be accessed by unauthorized parties.,['internet-exposed'],,Ensure that CloudWatch Log Groups are not publicly accessible,,[],,['Software and Configuration Checks/AWS Security Best Practices'],cloudwatch_log_group_not_publicly_accessible,"{'Code': {'CLI': 'aws logs delete-resource-policy --policy-name <policy-name>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': ""Ensure that CloudWatch Log Groups are not publicly accessible. Review and remove any resource policies that allow public access (Principal: '*') to log groups."", 'Url': 'https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html'}}",high,[],arn:aws:ses:region:account-id:log-group/log_group_name,Other,"Publicly accessible CloudWatch Log Groups can expose sensitive information, leading to data breaches or unauthorized access. It is important to ensure that log groups are only accessible by trusted entities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_root_usage/cloudwatch_log_metric_filter_root_usage.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for usage of root account.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for usage of root account.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_root_usage,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_3', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_3#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_policy_changes/cloudwatch_log_metric_filter_policy_changes.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for IAM policy changes.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for IAM policy changes.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_policy_changes,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_4', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_4#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_alarm_actions_enabled/cloudwatch_alarm_actions_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html#alarms-and-actions,cloudwatch,"Alarm actions automatically alert you when a monitored metric is outside the defined threshold. If the alarm action is deactivated, no actions are run when the alarm changes state, and you won't be alerted to changes in monitored metrics. We recommend activating CloudWatch alarm actions to help you quickly respond to security and operational issues.",[],,Check if CloudWatch alarms have actions enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices'],cloudwatch_alarm_actions_enabled,"{'Code': {'CLI': 'aws cloudwatch enable-alarm-actions --alarm-names <alarm-name>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-17', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that all CloudWatch alarms have at least one action configured. This can include sending notifications to SNS topics, invoking Lambda functions, or triggering other AWS services.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatch/cloudwatch-alarm-action-activated.html'}}",high,[],arn:aws:cloudwatch:region:account-id:alarm/alarm-name,AwsCloudWatchAlarm,"Without active alarm actions, you may not be alerted to security or operational issues, potentially leading to delayed responses and increased risk."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudwatch/cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled/cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled.metadata.json,,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,cloudwatch,Ensure a log metric filter and alarm exist for AWS Config configuration changes.,[],Logging and Monitoring,Ensure a log metric filter and alarm exist for AWS Config configuration changes.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_9', 'Terraform': 'https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_9#fix---buildtime'}, 'Recommendation': {'Text': 'It is recommended that a metric filter and alarm be established for unauthorized requests.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html'}}",medium,[],arn:partition:cloudwatch:region:account-id:certificate/resource-id,AwsCloudWatchAlarm,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_etl_jobs_amazon_s3_encryption_enabled/glue_etl_jobs_amazon_s3_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,glue,Check if Glue ETL Jobs have S3 encryption enabled.,['encryption'],Data Protection,Check if Glue ETL Jobs have S3 encryption enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_etl_jobs_amazon_s3_encryption_enabled,"{'Code': {'CLI': ""aws glue create-security-configuration --name s3-encrypted-sec-config --encryption-configuration {'S3Encryption': [{'S3EncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/s3-encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform'}, 'Recommendation': {'Text': 'Provide the encryption properties that are used by crawlers, jobs and development endpoints.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,AwsGlueJob,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_development_endpoints_s3_encryption_enabled/glue_development_endpoints_s3_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/encryption-security-configuration.html,glue,Check if Glue development endpoints have S3 encryption enabled.,['encryption'],Data Protection,Check if Glue development endpoints have S3 encryption enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_development_endpoints_s3_encryption_enabled,"{'Code': {'CLI': ""aws glue create-security-configuration --name s3-encrypted-sec-config --encryption-configuration {'S3Encryption': [{'S3EncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/s3-encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform'}, 'Recommendation': {'Text': 'Specify AWS KMS keys to use for input and output from S3 and EBS.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/encryption-security-configuration.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,Other,Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_data_catalogs_metadata_encryption_enabled/glue_data_catalogs_metadata_encryption_enabled.metadata.json,,,glue,Check if Glue data catalog settings have metadata encryption enabled.,['encryption'],Data Protection,Check if Glue data catalog settings have metadata encryption enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_data_catalogs_metadata_encryption_enabled,"{'Code': {'CLI': 'aws glue put-data-catalog-encryption-settings --data-catalog-encryption-settings EncryptionAtRest={CatalogEncryptionMode=SSE-KMS,SseAwsKmsKeyId=<ksm_key_arn>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/data-catalog-encryption-at-rest.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#terraform'}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/encrypt-glue-data-catalog.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,Other,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_etl_jobs_logging_enabled/glue_etl_jobs_logging_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/monitor-continuous-logging.html,glue,[DEPRECATED] Ensure that Glue ETL Jobs have CloudWatch logs enabled.,['logging'],This check is being removed since logs for all AWS Glue jobs are now always sent to Amazon CloudWatch.,[DEPRECATED] Check if Glue ETL Jobs have logging enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices'],glue_etl_jobs_logging_enabled,"{'Code': {'CLI': 'aws glue update-job --job-name <job-name> --job-update ""Command={DefaultArguments={--enable-continuous-cloudwatch-log=true}}""', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/glue-controls.html#glue-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logging for AWS Glue jobs to capture and monitor job events. Logging allows for better visibility into job performance, error detection, and security oversight.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/monitor-continuous-logging-enable.html'}}",medium,[],arn:partition:glue:region:account-id:job/job-name,AwsGlueJob,"Without logging enabled, AWS Glue jobs lack visibility into job activities and failures, making it difficult to detect unauthorized access, troubleshoot issues, and ensure compliance. This may result in untracked security incidents or operational issues that affect data processing."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_data_catalogs_connection_passwords_encryption_enabled/glue_data_catalogs_connection_passwords_encryption_enabled.metadata.json,,,glue,Check if Glue data catalog settings have encrypt connection password enabled.,['encryption'],Data Protection,Check if Glue data catalog settings have encrypt connection password enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_data_catalogs_connection_passwords_encryption_enabled,"{'Code': {'CLI': 'aws glue put-data-catalog-encryption-settings --data-catalog-encryption-settings ConnectionPasswordEncryption={ReturnConnectionPasswordEncrypted=True,AwsKmsKeyId=<ksm_key_arn>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_37#terraform'}, 'Recommendation': {'Text': 'On the AWS Glue console, you can enable this option on the Data catalog settings page.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/encrypt-connection-passwords.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,Other,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_ml_transform_encrypted_at_rest/glue_ml_transform_encrypted_at_rest.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/encryption-at-rest.html,glue,This control checks whether an AWS Glue machine learning transform is encrypted at rest. The control fails if the machine learning transform isn't encrypted at rest.,['encryption'],,Check if Glue ML Transform Encryption at Rest is Enabled,,[],,[],glue_ml_transform_encrypted_at_rest,"{'Code': {'CLI': 'aws glue update-ml-transform --transform-id <transform-id> --encryption-at-rest {""Enabled"":true,""KmsKey"":""<kms-key-arn>""}', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/glue-controls.html#glue-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable encryption at rest for Glue ML Transforms using AWS KMS keys.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/encryption-at-rest.html'}}",medium,[],arn:aws:glue:region:account-id:mlTransform/transform-id,Other,"Data at rest refers to data that's stored in persistent, non-volatile storage for any duration. Encrypting data at rest helps you protect its confidentiality, which reduces the risk that an unauthorized user can access it."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_development_endpoints_cloudwatch_logs_encryption_enabled/glue_development_endpoints_cloudwatch_logs_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,glue,Check if Glue development endpoints have CloudWatch logs encryption enabled.,['encryption'],Data Protection,Check if Glue development endpoints have CloudWatch logs encryption enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_development_endpoints_cloudwatch_logs_encryption_enabled,"{'Code': {'CLI': ""aws glue create-security-configuration --name cw-encrypted-sec-config --encryption-configuration {'CloudWatchEncryption': [{'CloudWatchEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/cloud-watch-logs-encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform'}, 'Recommendation': {'Text': 'Enable Encryption in the Security configurations.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,Other,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_database_connections_ssl_enabled/glue_database_connections_ssl_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/encryption-in-transit.html,glue,Check if Glue database connection has SSL connection enabled.,['encryption'],Data Protection,Check if Glue database connection has SSL connection enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_database_connections_ssl_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure encryption settings for crawlers, ETL jobs and development endpoints using security configurations in AWS Glue.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/encryption-in-transit.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,Other,Data exfiltration could happen if information is not protected in transit.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_etl_jobs_job_bookmark_encryption_enabled/glue_etl_jobs_job_bookmark_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,glue,Check if Glue ETL Jobs have Job bookmark encryption enabled.,['encryption'],Logging and Monitoring,Check if Glue ETL Jobs have Job bookmark encryption enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_etl_jobs_job_bookmark_encryption_enabled,"{'Code': {'CLI': ""aws glue create-security-configuration --name jb-encrypted-sec-config --encryption-configuration {'JobBookmarksEncryption': [{'JobBookmarksEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/job-bookmark-encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform'}, 'Recommendation': {'Text': 'Enable Encryption in the Security configurations.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,AwsGlueJob,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_data_catalogs_not_publicly_accessible/glue_data_catalogs_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/security_iam_service-with-iam.html?icmpid=docs_console_unmapped#security_iam_service-with-iam-resource-based-policies,glue,This control checks whether Glue Data Catalogs are not publicly accessible via resource policies.,['internet-exposed'],,Ensure Glue Data Catalogs are not publicly accessible.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],glue_data_catalogs_not_publicly_accessible,"{'Code': {'CLI': 'aws glue delete-resource-policy', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Review Glue Data Catalog policies and ensure they are not publicly accessible. Implement the Principle of Least Privilege.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/security_iam_service-with-iam.html?icmpid=docs_console_unmapped#security_iam_service-with-iam-resource-based-policies'}}",high,[],arn:aws:glue:region:account-id:catalog,AwsGlueDataCatalog,"Publicly accessible Glue Data Catalogs can expose sensitive data schema and metadata, leading to potential security risks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_development_endpoints_job_bookmark_encryption_enabled/glue_development_endpoints_job_bookmark_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,glue,Check if Glue development endpoints have Job bookmark encryption enabled.,['encryption'],Data Protection,Check if Glue development endpoints have Job bookmark encryption enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_development_endpoints_job_bookmark_encryption_enabled,"{'Code': {'CLI': ""aws glue create-security-configuration --name jb-encrypted-sec-config --encryption-configuration {'JobBookmarksEncryption': [{'JobBookmarksEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/job-bookmark-encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform'}, 'Recommendation': {'Text': 'Enable Encryption in the Security configurations.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,Other,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glue/glue_etl_jobs_cloudwatch_logs_encryption_enabled/glue_etl_jobs_cloudwatch_logs_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,glue,Check if Glue ETL Jobs have CloudWatch Logs encryption enabled.,['encryption'],Logging and Monitoring,Check if Glue ETL Jobs have CloudWatch Logs encryption enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],glue_etl_jobs_cloudwatch_logs_encryption_enabled,"{'Code': {'CLI': ""aws glue create-security-configuration --name cw-encrypted-sec-config --encryption-configuration {'CloudWatchEncryption': [{'CloudWatchEncryptionMode': 'SSE-KMS','KmsKeyArn': <kms_arn>}]}"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Glue/cloud-watch-logs-encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_41#terraform'}, 'Recommendation': {'Text': 'Enable Encryption in the Security configurations.', 'Url': 'https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html'}}",medium,[],arn:partition:glue:region:account-id:certificate/resource-id,AwsGlueJob,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_access_point_public_access_block/s3_access_point_public_access_block.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html#access-points-policies,s3,Ensures that public access is blocked on S3 Access Points.,[],,Block Public Access Settings enabled on Access Points.,,[],,['Data Protection'],s3_access_point_public_access_block,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-19', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure S3 access points are private by default, applying strict access controls, and regularly auditing permissions to prevent unauthorized public access.', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/s3-access-point-public-access-blocks.html'}}",critical,[],arn:partition:s3:::bucket_name,AwsS3AccessPoint,"Leaving S3 access points open to the public in AWS can lead to data exposure, breaches, compliance violations, unauthorized access, and data integrity issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_lifecycle_enabled/s3_bucket_lifecycle_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html,s3,Check if S3 buckets have Lifecycle configuration enabled.,[],,Check if S3 buckets have a Lifecycle configuration enabled,,[],,['AWS Foundational Security Best Practices'],s3_bucket_lifecycle_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-13', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/S3/lifecycle-configuration.html'}, 'Recommendation': {'Text': 'Enable lifecycle policies on your S3 buckets to automatically manage the transition and expiration of data.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/how-to-set-lifecycle-configuration-intro.html'}}",low,[],arn:partition:s3:::bucket_name,AwsS3Bucket,"The risks of not having lifecycle management enabled for S3 buckets include higher storage costs, unmanaged data retention, and potential non-compliance with data policies."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_server_access_logging_enabled/s3_bucket_server_access_logging_enabled.metadata.json,,,s3,Check if S3 buckets have server access logging enabled,['forensics-ready'],,Check if S3 buckets have server access logging enabled,,[],,['Logging and Monitoring'],s3_bucket_server_access_logging_enabled,"{'Code': {'CLI': 'aws s3api put-bucket-logging --bucket <BUCKET_NAME> --bucket-logging-status <LOGGING_FILE_JSON>', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/s3-policies/s3_13-enable-logging', 'Terraform': 'https://docs.prowler.com/checks/aws/s3-policies/s3_13-enable-logging#terraform'}, 'Recommendation': {'Text': 'Ensure that S3 buckets have Logging enabled. CloudTrail data events can be used in place of S3 bucket logging. If that is the case, this finding can be considered a false positive.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,"Server access logs can assist you in security and access audits, help you learn about your customer base, and understand your Amazon S3 bill."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_object_versioning/s3_bucket_object_versioning.metadata.json,,,s3,Check if S3 buckets have object versioning enabled,[],,Check if S3 buckets have object versioning enabled,,[],,['Data Protection'],s3_bucket_object_versioning,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/s3-policies/s3_16-enable-versioning#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/s3-policies/s3_16-enable-versioning#terraform'}, 'Recommendation': {'Text': 'Configure versioning using the Amazon console or API for buckets with sensitive information that is changing frequently, and backup may not be enough to capture all the changes.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/Versioning.html'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,"With versioning, you can easily recover from both unintended user actions and application failures."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_kms_encryption/s3_bucket_kms_encryption.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html,s3,Check if S3 buckets have KMS encryption enabled.,['encryption'],,Check if S3 buckets have KMS encryption enabled.,,[],,['Data Protection'],s3_bucket_kms_encryption,"{'Code': {'CLI': 'aws put-bucket-encryption --bucket <BUCKET_NAME> --server-side-encryption-configuration \'{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""aws:kms"",""KMSMasterKeyID"":""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>""}}]}\'', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default#terraform'}, 'Recommendation': {'Text': 'Ensure that S3 buckets have encryption at rest enabled using KMS.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Amazon S3 KMS encryption provides a way to set the encryption behavior for an S3 bucket using a managed key. This will ensure data-at-rest is encrypted.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_cross_account_access/s3_bucket_cross_account_access.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html,s3,"This check verifies that S3 bucket policies are configured in a way that limits access to the intended AWS accounts only, preventing unauthorized access by external or unintended accounts.",[],,Ensure that general-purpose bucket policies restrict access to other AWS accounts.,,[],,['Effects/Data Exposure'],s3_bucket_cross_account_access,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Review and update your S3 bucket policies to remove permissions that grant external AWS accounts access to critical actions and implement least privilege principles to ensure sensitive operations are restricted to trusted accounts only', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html'}}",high,[],arn:partition:s3:::bucket_name,AwsS3Bucket,"Allowing other AWS accounts to perform sensitive actions (e.g., modifying bucket policies, ACLs, or encryption settings) on your S3 buckets can lead to data exposure, unauthorized access, or misconfigurations, increasing the risk of insider threats or attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_no_mfa_delete/s3_bucket_no_mfa_delete.metadata.json,,,s3,Check if S3 bucket MFA Delete is not enabled.,[],,Check if S3 bucket MFA Delete is not enabled.,,[],,['Logging and Monitoring'],s3_bucket_no_mfa_delete,"{'Code': {'CLI': ""aws s3api put-bucket-versioning --profile my-root-profile --bucket my-bucket-name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa 'arn:aws:iam::00000000:mfa/root-account-mfa-device 123456'"", 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_24#terraform'}, 'Recommendation': {'Text': 'Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Your security credentials are compromised or unauthorized access is granted.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_multi_region_access_point_public_access_block/s3_multi_region_access_point_public_access_block.metadata.json,,https://aws.amazon.com/es/getting-started/hands-on/getting-started-with-amazon-s3-multi-region-access-points/,s3,Ensures that public access is blocked on S3 Access Points.,[],,Block Public Access Settings enabled on Multi Region Access Points.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices'],s3_multi_region_access_point_public_access_block,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-24', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure S3 multi region access points are private by default, applying strict access controls, and regularly auditing permissions to prevent unauthorized public access.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/multi-region-access-point-block-public-access.html'}}",high,[],arn:aws:s3:region:account-id:accesspoint/access-point-name,AwsS3AccessPoint,"Leaving S3 multi region access points open to the public in AWS can lead to data exposure, breaches, compliance violations, unauthorized access, and data integrity issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_public_write_acl/s3_bucket_public_write_acl.metadata.json,,,s3,Ensure there are no S3 buckets writable by Everyone or Any AWS customer.,['internet-exposed'],,Ensure there are no S3 buckets writable by Everyone or Any AWS customer.,,[],,['Data Protection'],s3_bucket_public_write_acl,"{'Code': {'CLI': 'aws s3api put-bucket-acl --bucket <bucket_name> --acl private', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-write-access.html', 'Other': '', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-write-access.html'}, 'Recommendation': {'Text': 'You can enable block public access settings only for access points, buckets and AWS accounts. Amazon S3 does not support block public access settings on a per-object basis. When you apply block public access settings to an account, the settings apply to all AWS Regions globally. The settings might not take effect in all Regions immediately or simultaneously, but they eventually propagate to all Regions.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html'}}",critical,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Even if you enable all possible bucket ACL options available in the Amazon S3 console the ACL alone does not allow everyone to download objects from your bucket. Depending on which option you select any user could perform some actions.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_acl_prohibited/s3_bucket_acl_prohibited.metadata.json,,,s3,Check if S3 buckets have ACLs enabled,[],,Check if S3 buckets have ACLs enabled,,[],,['Logging and Monitoring'],s3_bucket_acl_prohibited,"{'Code': {'CLI': 'aws s3api put-bucket-ownership-controls --bucket <bucket-name> --ownership-controls Rules=[{ObjectOwnership=BucketOwnerEnforced}]', 'NativeIaC': 'https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-ownershipcontrols.html', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that S3 ACLs are disabled (BucketOwnerEnforced). Use IAM policies and bucket policies to manage access.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,S3 ACLs are a legacy access control mechanism that predates IAM. IAM and bucket policies are currently the preferred methods.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_event_notifications_enabled/s3_bucket_event_notifications_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/notification-how-to-event-types-and-destinations.html#supported-notification-event-types,s3,Ensure whether S3 buckets have event notifications enabled.,[],,Check if S3 buckets have event notifications enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],s3_bucket_event_notifications_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-11', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable event notifications for all S3 general-purpose buckets to monitor important events such as object creation, deletion, tagging, and lifecycle events, ensuring visibility and quick action on relevant changes.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/EventNotifications.html'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,"Without event notifications, important actions on S3 buckets may go unnoticed, leading to missed opportunities for timely response to critical changes, such as object creation, deletion, or updates that could impact data security and availability."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_policy_public_write_access/s3_bucket_policy_public_write_access.metadata.json,,,s3,Check if S3 buckets have policies which allow WRITE access.,['internet-exposed'],,Check if S3 buckets have policies which allow WRITE access.,,[],,['IAM'],s3_bucket_policy_public_write_access,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/s3-policies/s3_18-write-permissions-public#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure proper bucket policy is in place with the least privilege principle applied.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_s3_rw-bucket.html'}}",critical,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Non intended users can put objects in a given bucket.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_public_access/s3_bucket_public_access.metadata.json,,,s3,Ensure there are no S3 buckets open to Everyone or Any AWS user.,['internet-exposed'],,Ensure there are no S3 buckets open to Everyone or Any AWS user.,,[],,['Data Protection'],s3_bucket_public_access,"{'Code': {'CLI': 'aws s3api put-public-access-block --public-access-block-configuration BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true --bucket <bucket_name>', 'NativeIaC': '', 'Other': 'https://github.com/cloudmatos/matos/tree/master/remediations/aws/s3/s3/block-public-access', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached#terraform'}, 'Recommendation': {'Text': 'You can enable block public access settings only for access points, buckets and AWS accounts. Amazon S3 does not support block public access settings on a per-object basis. When you apply block public access settings to an account, the settings apply to all AWS Regions globally. The settings might not take effect in all Regions immediately or simultaneously, but they eventually propagate to all Regions.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html'}}",critical,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Even if you enable all possible bucket ACL options available in the Amazon S3 console the ACL alone does not allow everyone to download objects from your bucket. Depending on which option you select any user could perform some actions.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_public_list_acl/s3_bucket_public_list_acl.metadata.json,,,s3,Ensure there are no S3 buckets listable by Everyone or Any AWS customer.,['internet-exposed'],,Ensure there are no S3 buckets listable by Everyone or Any AWS customer.,,[],,['Data Protection'],s3_bucket_public_list_acl,"{'Code': {'CLI': 'aws s3api put-bucket-acl --bucket <bucket_name> --acl private', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-read-access.html', 'Other': '', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/s3-bucket-public-read-access.html'}, 'Recommendation': {'Text': 'You can enable block public access settings only for access points, buckets and AWS accounts. Amazon S3 does not support block public access settings on a per-object basis. When you apply block public access settings to an account, the settings apply to all AWS Regions globally. The settings might not take effect in all Regions immediately or simultaneously, but they eventually propagate to all Regions.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html'}}",critical,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Even if you enable all possible bucket ACL options available in the Amazon S3 console the ACL alone does not allow everyone to download objects from your bucket. Depending on which option you select any user could perform some actions.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_cross_region_replication/s3_bucket_cross_region_replication.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication.html,s3,"Verifying whether S3 buckets have cross-region replication enabled, ensuring data redundancy and availability across multiple AWS regions",['redundancy'],,Check if S3 buckets use cross region replication.,,[],,['Secure access management'],s3_bucket_cross_region_replication,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-7', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled#terraform'}, 'Recommendation': {'Text': 'Ensure that S3 buckets have cross region replication.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough1.html'}}",low,[],arn:partition:s3:::bucket_name,AwsS3Bucket,"Without cross-region replication in S3 buckets, data is at risk of being lost or inaccessible if an entire region goes down, leading to potential service disruptions and data unavailability."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_default_encryption/s3_bucket_default_encryption.metadata.json,,,s3,Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it.,['encryption'],,Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it.,,[],,['Data Protection'],s3_bucket_default_encryption,"{'Code': {'CLI': ""aws s3api put-bucket-encryption --bucket <bucket_name> --server-side-encryption-configuration '{'Rules': [{'ApplyServerSideEncryptionByDefault': {'SSEAlgorithm': 'AES256'}}]}'"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/s3-policies/s3_14-data-encrypted-at-rest#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/s3-policies/s3_14-data-encrypted-at-rest#terraform'}, 'Recommendation': {'Text': 'Ensure that S3 buckets have encryption at rest enabled.', 'Url': 'https://aws.amazon.com/blogs/security/how-to-prevent-uploads-of-unencrypted-objects-to-amazon-s3/'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Amazon S3 default encryption provides a way to set the default encryption behavior for an S3 bucket. This will ensure data-at-rest is encrypted.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_account_level_public_access_blocks/s3_account_level_public_access_blocks.metadata.json,,,s3,Check S3 Account Level Public Access Block.,[],,Check S3 Account Level Public Access Block.,,[],,['Data Protection'],s3_account_level_public_access_blocks,"{'Code': {'CLI': 'aws s3control put-public-access-block --public-access-block-configuration BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true --account-id <account_id>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_21#cloudformation', 'Other': 'https://github.com/cloudmatos/matos/tree/master/remediations/aws/s3/s3control/block-public-access', 'Terraform': 'https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_21#terraform'}, 'Recommendation': {'Text': 'You can enable Public Access Block at the account level to prevent the exposure of your data stored in S3.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html'}}",high,[],arn:partition:s3:::bucket_name,AwsS3AccountPublicAccessBlock,Public access policies may be applied to sensitive data buckets.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_secure_transport_policy/s3_bucket_secure_transport_policy.metadata.json,,,s3,Check if S3 buckets have secure transport policy.,['encryption'],,Check if S3 buckets have secure transport policy.,,[],,['Data Protection'],s3_bucket_secure_transport_policy,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/s3-policies/s3_15-secure-data-transport#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that S3 buckets have encryption in transit enabled.', 'Url': 'https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,"If HTTPS is not enforced on the bucket policy, communication between clients and S3 buckets can use unencrypted HTTP. As a result, sensitive information could be transmitted in clear text over the network or internet."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_level_public_access_block/s3_bucket_level_public_access_block.metadata.json,"{'Tag1Key': 'value', 'Tag2Key': 'value'}",https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html,s3,Check S3 Bucket Level Public Access Block.,[],,Check S3 Bucket Level Public Access Block.,,[],,['Data Protection'],s3_bucket_level_public_access_block,"{'Code': {'CLI': 'aws s3api put-public-access-block --region <REGION_NAME> --public-access-block-configuration BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true --bucket <BUCKET_NAME>', 'NativeIaC': '', 'Other': 'https://github.com/cloudmatos/matos/tree/master/remediations/aws/s3/s3/block-public-access', 'Terraform': 'https://docs.prowler.com/checks/aws/s3-policies/bc_aws_s3_20#terraform'}, 'Recommendation': {'Text': 'You can enable Public Access Block at the bucket level to prevent the exposure of your data stored in S3.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html'}}",medium,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Public access policies may be applied to sensitive data buckets.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/s3/s3_bucket_object_lock/s3_bucket_object_lock.metadata.json,,,s3,Check if S3 buckets have object lock enabled,[],,Check if S3 buckets have object lock enabled,,[],,['Data Protection'],s3_bucket_object_lock,"{'Code': {'CLI': 'aws s3 put-object-lock-configuration --bucket <BUCKET_NAME> --object-lock-configuration \'{""ObjectLockEnabled"":""Enabled"",""Rule"":{""DefaultRetention"":{""Mode"":""GOVERNANCE"",""Days"":1}}}\'', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/S3/object-lock.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-s3-bucket-has-lock-configuration-enabled-by-default#terraform'}, 'Recommendation': {'Text': 'Ensure that your Amazon S3 buckets have Object Lock feature enabled in order to prevent the objects they store from being deleted.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock-overview.html'}}",low,[],arn:partition:s3:::bucket_name,AwsS3Bucket,Store objects using a write-once-read-many (WORM) model to help you prevent objects from being deleted or overwritten for a fixed amount of time or indefinitely. That helps to prevent ransomware attacks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/emr/emr_cluster_account_public_block_enabled/emr_cluster_account_public_block_enabled.metadata.json,,https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html,emr,EMR Account Public Access Block enabled.,['internet-exposed'],,EMR Account Public Access Block enabled.,,[],,[],emr_cluster_account_public_block_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://github.com/cloudmatos/matos/tree/master/remediations/aws/emr/block-emr-public-access', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable EMR Account Public Access Block.', 'Url': 'https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html'}}",high,[],arn:aws:emr:region:account-id,AwsAccount,EMR Clusters must have Account Public Access Block enabled.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/emr/emr_cluster_master_nodes_no_public_ip/emr_cluster_master_nodes_no_public_ip.metadata.json,,https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html,emr,EMR Cluster without Public IP.,[],,EMR Cluster without Public IP.,,[],,[],emr_cluster_master_nodes_no_public_ip,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Only make acceptable EMR clusters public.', 'Url': 'https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html'}}",medium,[],arn:aws:emr:region:account-id,Other,EMR Cluster should not have Public IP.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/emr/emr_cluster_publicly_accesible/emr_cluster_publicly_accesible.metadata.json,,https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html,emr,Publicly accessible EMR Cluster.,['internet-exposed'],,Publicly accessible EMR Cluster.,,[],,[],emr_cluster_publicly_accesible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-that-amazon-emr-clusters-security-groups-are-not-open-to-the-world#terraform'}, 'Recommendation': {'Text': 'Only make acceptable EMR clusters public.', 'Url': 'https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html'}}",medium,[],arn:aws:emr:region:account-id,Other,EMR Clusters should not be publicly accessible.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/documentdb/documentdb_cluster_storage_encrypted/documentdb_cluster_storage_encrypted.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-1,documentdb,Check if DocumentDB cluster storage is encrypted.,[],,Check if DocumentDB cluster storage is encrypted.,,[],,['Data Protection'],documentdb_cluster_storage_encrypted,"{'Code': {'CLI': 'aws docdb create-db-cluster --db-cluster-identifier <DB_CLUSTER_ID> --port <PORT> --engine docdb --master-username <MASTER_USERNAME> --master-user-password <MASTER_PASSWORD> --storage-encrypted', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_28/', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_28#fix-buildtime'}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-1'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsRdsDbCluster,Ensure that encryption of data at rest is enabled for your Amazon DocumentDB (with MongoDB compatibility) database clusters for additional data security and regulatory compliance.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/documentdb/documentdb_cluster_backup_enabled/documentdb_cluster_backup_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-2,DocumentDB,Check if DocumentDB Clusters have backup enabled.,[],,Check if DocumentDB Clusters have backup enabled.,,[],,[],documentdb_cluster_backup_enabled,"{'Code': {'CLI': 'aws docdb modify-db-cluster --region <REGION> --db-cluster-identifier <DB_CLUSTER_ID> --backup-retention-period 7 --apply-immediately', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/sufficient-backup-retention-period.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/sufficient-backup-retention-period.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/sufficient-backup-retention-period.html#'}, 'Recommendation': {'Text': 'Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-2'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,Ensure that your Amazon DocumentDB database clusters have set a minimum backup retention period in order to achieve compliance requirements in your organization.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/documentdb/documentdb_cluster_multi_az_enabled/documentdb_cluster_multi_az_enabled.metadata.json,,https://docs.aws.amazon.com/documentdb/latest/developerguide/failover.html,documentdb,Ensure DocumentDB Cluster have Multi-AZ enabled.,['redundancy'],,Ensure DocumentDB Cluster have Multi-AZ enabled.,,[],,[],documentdb_cluster_multi_az_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Multi-AZ for all DocumentDB Clusters.', 'Url': 'https://docs.aws.amazon.com/documentdb/latest/developerguide/failover.html'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"Ensure that your Amazon DocumentDB Clusters are using Multi-AZ deployment configurations to provide High Availability (HA) through automatic failover to standby replicas in the event of a failure such as an Availability Zone (AZ) outage, an internal hardware or network outage, a software failure or in case of a planned maintenance session."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/documentdb/documentdb_cluster_public_snapshot/documentdb_cluster_public_snapshot.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/docdb-cluster-snapshot-public-prohibited.html,documentdb,Check if DocumentDB manual cluster snapshot is public.,['internet-exposed'],,Check if DocumentDB manual cluster snapshot is public.,,[],,[],documentdb_cluster_public_snapshot,"{'Code': {'CLI': 'aws docdb modify-db-snapshot-attribute --db-snapshot-identifier <snapshot_id> --attribute-name restore --values-to-remove all', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-3', 'Terraform': ''}, 'Recommendation': {'Text': 'To remove public access from a manual snapshot, follow the Sharing a snapshot tutorial.', 'Url': 'https://docs.aws.amazon.com/documentdb/latest/developerguide/backup_restore-share_cluster_snapshots.html#backup_restore-share_snapshots'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsRdsDbClusterSnapshot,"If you share an unencrypted manual snapshot as public, the snapshot is available to all AWS accounts. Public snapshots may result in unintended data exposure."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/documentdb/documentdb_cluster_cloudwatch_log_export/documentdb_cluster_cloudwatch_log_export.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-4,documentdb,Check if DocumentDB clusters are using the log export feature.,[],,Check if DocumentDB clusters are using the log export feature.,,[],,[],documentdb_cluster_cloudwatch_log_export,"{'Code': {'CLI': ""aws docdb modify-db-cluster --region <REGION> --db-cluster-identifier <DB_CLUSTER_ID> --db-cluster-parameter-group-name <DB_CLUSTER_PARAMETER_GROUP_NAME> --cloudwatch-logs-export-configuration '{EnableLogTypes:[profiler]}' --apply-immediately"", 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/enable-profiler.html', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/enable-profiler.html', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/enable-profiler.html'}, 'Recommendation': {'Text': 'Enabled DocumentDB Log export functionality to analyze, monitor, and archive auditing events for security and compliance requirements.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-4'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsRdsDbCluster,"Ensure that all your Amazon DocumentDB clusters are using the Log Exports feature in order to publish audit logs directly to CloudWatch Logs. The events recorded by Log Exports include events such as successful and failed authentication attempts, creating indexes, or dropping collections in DocumentDB databases."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/documentdb/documentdb_cluster_deletion_protection/documentdb_cluster_deletion_protection.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-5,documentdb,Check if DocumentDB Clusters has deletion protection enabled.,[],,Check if DocumentDB Clusters has deletion protection enabled.,,[],,[],documentdb_cluster_deletion_protection,"{'Code': {'CLI': 'aws aws docdb modify-db-cluster --region <REGION> --db-cluster-identifier <DB_CLUSTER_ID> --deletion-protection --apply-immediately', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/deletion-protection.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/deletion-protection.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DocumentDB/deletion-protection.html#'}, 'Recommendation': {'Text': 'Enable deletion protection for production DocumentDB Clusters.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/documentdb-controls.html#documentdb-5'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,Enabling cluster deletion protection offers an additional layer of protection against accidental database deletion or deletion by an unauthorized user. A DocumentDB cluster can't be deleted while deletion protection is enabled. You must first disable deletion protection before a delete request can succeed.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sns/sns_subscription_not_using_http_endpoints/sns_subscription_not_using_http_endpoints.metadata.json,,https://docs.aws.amazon.com/sns/latest/dg/sns-security-best-practices.html#enforce-encryption-data-in-transit,sns,Ensure there are no SNS subscriptions using HTTP endpoints,['encryption'],,Ensure there are no SNS subscriptions using HTTP endpoints,,[],,[],sns_subscription_not_using_http_endpoints,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': ""To enforce only encrypted connections over HTTPS, add the aws:SecureTransport condition in the IAM policy that's attached to unencrypted SNS topics. This forces message publishers to use HTTPS instead of HTTP"", 'Url': 'https://docs.aws.amazon.com/sns/latest/dg/sns-security-best-practices.html#enforce-encryption-data-in-transit'}}",high,[],arn:aws:sns:region:account-id:topic,AwsSnsTopic,"When you use HTTPS, messages are automatically encrypted during transit, even if the SNS topic itself isn't encrypted. Without HTTPS, a network-based attacker can eavesdrop on network traffic or manipulate it using an attack such as man-in-the-middle."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sns/sns_topics_kms_encryption_at_rest_enabled/sns_topics_kms_encryption_at_rest_enabled.metadata.json,,https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html,sns,Ensure there are no SNS Topics unencrypted,['encryption'],,Ensure there are no SNS Topics unencrypted,,[],,[],sns_topics_kms_encryption_at_rest_enabled,"{'Code': {'CLI': ""aws sns set-topic-attributes --topic-arn <TOPIC_ARN> --attribute-name 'KmsMasterKeyId' --attribute-value <KEY>"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_15#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SNS/topic-encrypted-with-kms-customer-master-keys.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_15#terraform'}, 'Recommendation': {'Text': 'Use Amazon SNS with AWS KMS.', 'Url': 'https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html'}}",high,[],arn:aws:sns:region:account-id:topic,AwsSnsTopic,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sns/sns_topics_not_publicly_accessible/sns_topics_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/sns-topic-policy.html,sns,Check if SNS topics have policy set as Public,['internet-exposed'],,Check if SNS topics have policy set as Public,,[],,[],sns_topics_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SNS/topics-everyone-publish.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it#terraform'}, 'Recommendation': {'Text': 'Ensure there is a business requirement for service to be public.', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/sns-topic-policy.html'}}",high,[],arn:aws:sns:region:account-id:topic,AwsSnsTopic,Publicly accessible services could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/datasync/datasync_task_logging_enabled/datasync_task_logging_enabled.metadata.json,,https://docs.aws.amazon.com/datasync/latest/userguide/monitor-datasync.html#enable-logging,datasync,This control checks if AWS DataSync tasks have logging enabled. The control fails if the task doesn't have the CloudWatchLogGroupArn property defined.,['logging'],,DataSync tasks should have logging enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices'],datasync_task_logging_enabled,"{'Code': {'CLI': 'aws datasync update-task --task-arn <task-arn> --cloud-watch-log-group-arn <log-group-arn>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/datasync/latest/userguide/monitor-datasync.html#enable-logging', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure logging for your DataSync tasks to ensure that operational data is captured and available for debugging, monitoring, and auditing purposes.', 'Url': 'https://docs.aws.amazon.com/datasync/latest/userguide/monitor-datasync.html#enable-logging'}}",high,[],arn:aws:datasync:{region}:{account-id}:task/{task-id},AwsDataSyncTask,"Without logging enabled, important operational data may be lost, making it difficult to troubleshoot issues, monitor performance, and ensure compliance with auditing requirements."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/macie/macie_is_enabled/macie_is_enabled.metadata.json,,,macie,Check if Amazon Macie is enabled.,['forensics-ready'],,Check if Amazon Macie is enabled.,,[],,['Data Protection'],macie_is_enabled,"{'Code': {'CLI': 'aws macie2 enable-macie', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Amazon Macie and create appropriate jobs to discover sensitive data.', 'Url': 'https://aws.amazon.com/macie/getting-started/'}}",low,[],arn:partition:access-analyzer:region:account-id:analyzer/resource-id,Other,"Amazon Macie is a fully managed data security and data privacy service that uses machine learning and pattern matching to help you discover, monitor and protect your sensitive data in AWS."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/macie/macie_automated_sensitive_data_discovery_enabled/macie_automated_sensitive_data_discovery_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/macie-auto-sensitive-data-discovery-check.html,macie,Check if automated sensitive data discovery is enabled for an Amazon Macie account. The control fails if it isn't enabled.,[],,Check if Macie automated sensitive data discovery is enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],macie_automated_sensitive_data_discovery_enabled,"{'Code': {'CLI': 'aws macie2 update-automated-discovery-configuration --status ENABLED', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/macie-controls.html#macie-2', 'Terraform': ''}, 'Recommendation': {'Text': 'To enable and configure automated sensitive data discovery jobs for S3 buckets, refer to the Configuring automated sensitive data discovery tutorial.', 'Url': 'https://docs.aws.amazon.com/macie/latest/user/discovery-asdd-account-enable.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsAccount,"Without automated sensitive data discovery, there could be delays in identifying sensitive data, leading to data exposure risks in Amazon S3 buckets."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/inspector2/inspector2_is_enabled/inspector2_is_enabled.metadata.json,,https://docs.aws.amazon.com/inspector/latest/user/findings-understanding.html,inspector2,"Ensure that the new version of Amazon Inspector is enabled in order to help you improve the security and compliance of your AWS cloud environment. Amazon Inspector 2 is a vulnerability management solution that continually scans scans your Amazon EC2 instances, ECR container images, and Lambda functions to identify software vulnerabilities and instances of unintended network exposure.",[],,"Check if Inspector2 is enabled for Amazon EC2 instances, ECR container images and Lambda functions.",['inspector2_findings_exist'],[],,['Software and Configuration Checks/AWS Security Best Practices'],inspector2_is_enabled,"{'Code': {'CLI': ""aws inspector2 enable --resource-types 'EC2' 'ECR' 'LAMBDA' 'LAMBDA_CODE'"", 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Inspector2/enable-amazon-inspector2.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Amazon Inspector 2 for your AWS account.', 'Url': 'https://docs.aws.amazon.com/inspector/latest/user/getting_started_tutorial.html'}}",medium,[],arn:aws:inspector2:region:account-id/detector-id,AwsAccount,"Without using AWS Inspector, you may not be aware of all the security vulnerabilities in your AWS resources, which could lead to unauthorized access, data breaches, or other security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/inspector2/inspector2_active_findings_exist/inspector2_active_findings_exist.metadata.json,,https://docs.aws.amazon.com/inspector/latest/user/findings-understanding.html,inspector2,This check determines if there are any active findings in your AWS account that have been detected by AWS Inspector2. Inspector2 is an automated security assessment service that helps improve the security and compliance of applications deployed on AWS.,[],,Check if Inspector2 active findings exist,['inspector2_findings_exist'],[],,[],inspector2_active_findings_exist,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Inspector/amazon-inspector-findings.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Review the active findings from Inspector2', 'Url': 'https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html'}}",medium,[],arn:aws:inspector2:region:account-id/detector-id,Other,"Without using AWS Inspector, you may not be aware of all the security vulnerabilities in your AWS resources, which could lead to unauthorized access, data breaches, or other security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/config/config_recorder_all_regions_enabled/config_recorder_all_regions_enabled.metadata.json,,https://aws.amazon.com/blogs/mt/aws-config-best-practices/,config,Ensure AWS Config is enabled in all regions.,['forensics-ready'],,Ensure AWS Config is enabled in all regions.,,[],,['Logging and Monitoring'],config_recorder_all_regions_enabled,"{'Code': {'CLI': 'aws configservice subscribe --s3-bucket <S3_BUCKET> --sns-topic <TOPIC_ARN>--iam-role <ROLE_ARN> ', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_5-enable-aws-config-regions', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/logging_5-enable-aws-config-regions#terraform'}, 'Recommendation': {'Text': 'It is recommended to enable AWS Config in all regions.', 'Url': 'https://aws.amazon.com/blogs/mt/aws-config-best-practices/'}}",medium,[],arn:partition:access-recorder:region:account-id:recorder/resource-id,Other,"The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking and compliance auditing."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/config/config_recorder_using_aws_service_role/config_recorder_using_aws_service_role.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/using-service-linked-roles.html,config,"AWS Config uses an IAM role to access other AWS services. This role should be AWSServiceRoleForConfig, not a custom role. Using AWSServiceRoleForConfig ensures that the Config recorder has the necessary permissions to record configuration changes and that the role is managed by AWS, reducing the risk of misconfiguration.",[],,Ensure Config Recorder is using service-linked AWS Config role,,[],,['Software and Configuration Checks/AWS Security Best Practices/AWS Foundational Security Best Practices'],config_recorder_using_aws_service_role,"{'Code': {'CLI': 'aws configservice put-configuration-recorder --configuration-recorder- name=<recorder-name>,roleARN=arn:<audited_partition>:iam::<account_number>:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/config-controls.html#config-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Use service-linked role AWSServiceRoleForConfig for AWS Config recorders.', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/using-service-linked-roles.html'}}",medium,[],arn:partition:access-recorder:region:account-id:recorder/resource-id,Other,"If the Config recorder is not using AWSServiceRoleForConfig, it may not have the necessary permissions to record configuration changes, which could lead in not following the principle of least privilege, which could lead to misconfiguration and potential security vulnerabilities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_blocks_compromised_credentials_sign_in_attempts/cognito_user_pool_blocks_compromised_credentials_sign_in_attempts.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html,cognito,"Amazon Cognito User Pools can be configured to block sign-in by users with suspected compromised credentials. This feature uses Amazon Cognito advanced security features to detect anomalous sign-in attempts and block them. When enabled, Amazon Cognito User Pools will block sign-in by users with suspected compromised credentials. This helps protect your users from unauthorized access to their accounts.",[],,Ensure that advanced security features are enabled for Amazon Cognito User Pools to block sign-in by users with suspected compromised credentials,,[],,[],cognito_user_pool_blocks_compromised_credentials_sign_in_attempts,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To enable advanced security features for an Amazon Cognito User Pool, follow the steps below:', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If advanced security features are not enabled for an Amazon Cognito User Pool, users with compromised credentials may be able to sign in to their accounts. This could lead to unauthorized access to user data and other resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_temporary_password_expiration/cognito_user_pool_temporary_password_expiration.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html,cognito,"Temporary passwords are set by the administrator and are used to allow users to sign in and change their password. Temporary passwords are valid for a limited period of time, after which they expire. Temporary passwords are used when an administrator creates a new user account or resets a user password. The temporary password expiration period is the length of time that the temporary password is valid. The default value is 7 days. You can set the expiration period to a value between 0 and 365 days.",[],,Ensure that the user pool has a temporary password expiration period of 7 days or less,,[],,[],cognito_user_pool_temporary_password_expiration,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Set the temporary password expiration period to 7 days or less.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If the temporary password expiration period is too long, it increases the risk of unauthorized access to the user account. If the temporary password expiration period is too short, it increases the risk of users being unable to sign in and change their password."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_password_policy_uppercase/cognito_user_pool_password_policy_uppercase.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html,cognito,"User pools allow you to configure a password policy for your user pool to specify requirements for user passwords. You can require that passwords have a minimum length, contain at least one uppercase letter, and contain at least one number. You can also require that passwords have at least one special character. You can also set the password policy to require that passwords be case-sensitive.",[],,Ensure that the password policy for your user pool requires at least one uppercase letter,,[],,[],cognito_user_pool_password_policy_uppercase,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To require that the password policy for your user pool requires at least one uppercase letter, you can use the AWS Management Console or the AWS CLI. For more information, see the documentation on user pool settings and policies.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If the password policy for your user pool does not require at least one uppercase letter, it may be easier for an attacker to guess or crack user passwords."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_password_policy_number/cognito_user_pool_password_policy_number.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html,cognito,Checks whether the password policy for your user pool requires a number.,[],,Ensure that the password policy for your user pool requires a number,,[],,[],cognito_user_pool_password_policy_number,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To require a number in the password policy for your user pool, perform the following actions:', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If the password policy for your user pool does not require a number, the user pool is less secure and more vulnerable to attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_identity_pool_guest_access_disabled/cognito_identity_pool_guest_access_disabled.metadata.json,,https://docs.aws.amazon.com/location/latest/developerguide/authenticating-using-cognito.html,cognito,"Guest access allows unauthenticated users to access your identity pool. This is useful for public websites that allow users to sign in with a social identity provider, but it can also be a security risk. If you don't need guest access, you should disable it.",[],,Ensure Cognito Identity Pool has guest access disabled,,[],,[],cognito_identity_pool_guest_access_disabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Gues access should be disabled for Cognito Identity Pool. To disable guest access, follow the steps in the Amazon Cognito documentation.', 'Url': 'https://docs.aws.amazon.com/location/latest/developerguide/authenticating-using-cognito.html'}}",medium,[],arn:aws:cognito-idp:region:account:identitypool/identitypool-id,Other,"If guest access is enabled, unauthenticated users can access your identity pool. This can be a security risk if you don't need guest access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_deletion_protection_enabled/cognito_user_pool_deletion_protection_enabled.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-deletion-protection.html,cognito,"Deletion protection is a feature that allows you to lock a user pool to prevent it from being deleted. When deletion protection is enabled, you cannot delete the user pool. By default, deletion protection is disabled",[],,Ensure cognito user pools deletion protection enabled to prevent accidental deletion,,[],,[],cognito_user_pool_deletion_protection_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Deletion protection should be enabled for the user pool to prevent accidental deletion', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-deletion-protection.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If deletion protection is not enabled, the user pool can be deleted by any user with the necessary permissions. This can lead to loss of data and service disruption"
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_password_policy_lowercase/cognito_user_pool_password_policy_lowercase.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html,cognito,User pool password policy should require at least one lowercase letter.,[],,Ensure Cognito User Pool has password policy to require at least one lowercase letter,,[],,[],cognito_user_pool_password_policy_lowercase,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To require at least one lowercase letter in the password, update the password policy for the user pool.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If the password policy does not require at least one lowercase letter, it may be easier for an attacker to crack the password."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_blocks_potential_malicious_sign_in_attempts/cognito_user_pool_blocks_potential_malicious_sign_in_attempts.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html,cognito,"Amazon Cognito provides adaptive authentication, which helps protect your applications from malicious actors and compromised credentials by evaluating the risk associated with each user login and providing the appropriate level of security to mitigate that risk. Adaptive authentication is a feature of advanced security that you can enable for your user pool. When adaptive authentication is enabled, Amazon Cognito evaluates the risk associated with each user login and provides the appropriate level of security to mitigate that risk. You can configure adaptive authentication to block sign-in attempts that are likely to be malicious.",[],,Ensure that your Amazon Cognito user pool blocks potential malicious sign-in attempts,,[],,[],cognito_user_pool_blocks_potential_malicious_sign_in_attempts,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To enable adaptive authentication with automatic risk response as block sign-in, perform the following actions:', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If adaptive authentication with automatic risk response as block sign-in is not enabled, your user pool may not be able to block sign-in attempts that are likely to be malicious."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_advanced_security_enabled/cognito_user_pool_advanced_security_enabled.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html,cognito,"Advanced security features for Amazon Cognito User Pools provide additional security for your user pool. These features include compromised credentials protection, phone number verification, and account takeover protection.",[],,Ensure cognito user pools has advanced security enabled with full-function,,[],,[],cognito_user_pool_advanced_security_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To enable advanced security features for an Amazon Cognito User Pool, follow the instructions in the Amazon Cognito documentation.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If advanced security features are not enabled, your user pool is more vulnerable to unauthorized access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_client_token_revocation_enabled/cognito_user_pool_client_token_revocation_enabled.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/token-revocation.html,cognito,"Token revocation is a security feature that allows you to revoke tokens and end sessions for users. When you enable token revocation, Amazon Cognito automatically revokes tokens for users who sign out or are deleted. This helps protect your users' data and prevent unauthorized access to your resources.",[],,Ensure that token revocation is enabled for Amazon Cognito User Pools,,[],,[],cognito_user_pool_client_token_revocation_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To enable token revocation for an Amazon Cognito User Pool, use the Amazon Cognito console or the AWS CLI. For more information, see the Amazon Cognito documentation.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/token-revocation.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPoolClient,"If token revocation is not enabled, users' tokens will not be revoked when they sign out or are deleted. This can lead to unauthorized access to your resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_password_policy_minimum_length_14/cognito_user_pool_password_policy_minimum_length_14.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html,cognito,User pools allow you to configure a password policy for your user pool to specify complexity requirements for user passwords. The password policy for your user pools should require a minimum length of 14 or greater.,[],,Ensure that the password policy for your user pools require a minimum length of 14 or greater,,[],,[],cognito_user_pool_password_policy_minimum_length_14,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To require a minimum length of 14 or greater for user passwords in your user pools, you can update the password policy for your user pool using the AWS Management Console, AWS CLI, or SDK.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If the password policy for your user pools does not require a minimum length of 14 or greater, it may be easier for attackers to guess or brute force user passwords."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_client_prevent_user_existence_errors/cognito_user_pool_client_prevent_user_existence_errors.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-managing-errors.html,cognito,"Amazon Cognito User Pool should be configured to prevent user existence errors. This setting prevents user existence errors by requiring the user to enter a username and password to sign in. If the user does not exist, the user will receive an error message.",[],,Amazon Cognito User Pool should prevent user existence errors,,[],,[],cognito_user_pool_client_prevent_user_existence_errors,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To prevent user existence errors, you should configure the Amazon Cognito User Pool to require a username and password to sign in. If the user does not exist, the user will receive an error message.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-managing-errors.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPoolClient,Revealing user existence errors can be a security risk as it can allow an attacker to determine if a user exists in the system. This can be used to perform user enumeration attacks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_mfa_enabled/cognito_user_pool_mfa_enabled.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-mfa.html,cognito,Checks whether Multi-Factor Authentication (MFA) is enabled for Amazon Cognito User Pools.,[],,Ensure Multi-Factor Authentication (MFA) is enabled for Amazon Cognito User Pools,,[],,[],cognito_user_pool_mfa_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To enable MFA for an Amazon Cognito User Pool, follow the instructions in the Amazon Cognito documentation.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-mfa.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If MFA is not enabled, unauthorized users could gain access to the user pool and potentially compromise the security of the application."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_password_policy_symbol/cognito_user_pool_password_policy_symbol.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html,cognito,Check whether the password policy for your Amazon Cognito user pool requires at least one symbol.,[],,Ensure that the password policy for your Amazon Cognito user pool requires at least one symbol.,,[],,[],cognito_user_pool_password_policy_symbol,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To require at least one symbol in the password policy for your Amazon Cognito user pool, you can use the AWS Management Console or the AWS CLI.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-policies.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If the password policy for your Amazon Cognito user pool does not require at least one symbol, it can be easier for attackers to crack passwords."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_waf_acl_attached/cognito_user_pool_waf_acl_attached.metadata.json,,https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-waf.html,cognito,"Web ACLs are used to control access to your content. You can use a Web ACL to control who can access your content. You can also use a Web ACL to block requests based on IP address, HTTP headers, HTTP body, URI, or URI query string parameters. You can associate a Web ACL with a Cognito User Pool to control access to your content.",[],,Ensure that Amazon Cognito User Pool is associated with a WAF Web ACL,,[],,[],cognito_user_pool_waf_acl_attached,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'The Web ACL should be associated with the Cognito User Pool. To associate a Web ACL with a Cognito User Pool, use the AWS Management Console.', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-waf.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If a Web ACL is not associated with a Cognito User Pool, then the content is not protected by the Web ACL. This could lead to unauthorized access to your content."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cognito/cognito_user_pool_self_registration_disabled/cognito_user_pool_self_registration_disabled.metadata.json,,https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_SignUp.html,cognito,"Checks whether self registration is disabled for the Amazon Cognito User Pool. Self registration allows users to sign up for an account in the user pool. If self registration is enabled, users can sign up for an account in the user pool without any intervention from the administrator. This can lead to unauthorized access to the application.",[],,Ensure self registration is disabled for Amazon Cognito User Pools,,[],,[],cognito_user_pool_self_registration_disabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To disable self registration for the Amazon Cognito User Pool, perform the following actions:', 'Url': 'https://docs.aws.amazon.com/cognito/latest/developerguide/signing-up-users-in-your-app.html'}}",medium,[],arn:aws:cognito-idp:region:account:userpool/userpool-id,AwsCognitoUserPool,"If self registration is enabled, users can sign up for an account in the user pool without any intervention from the administrator. This can lead to unauthorized access to the application."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/memorydb/memorydb_cluster_auto_minor_version_upgrades/memorydb_cluster_auto_minor_version_upgrades.metadata.json,,https://docs.aws.amazon.com/memorydb/latest/devguide/engine-versions.html,memorydb,Ensure Memory DB clusters have minor version upgrade enabled.,[],,Ensure Memory DB clusters have minor version upgrade enabled.,,[],,[],memorydb_cluster_auto_minor_version_upgrades,"{'Code': {'CLI': 'aws memorydb update-cluster --cluster-name <cluster-name> --auto-minor-version-upgrade ', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable auto minor version upgrade for all Memory DB clusters.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.Upgrading.html#USER_UpgradeDBInstance.Upgrading.AutoMinorVersionUpgrades'}}",medium,[],arn:aws:memorydb:region:account-id:db-cluster,AwsMemoryDb,Auto Minor Version Upgrade is a feature that you can enable to have your database automatically upgraded when a new minor database engine version is available. Minor version upgrades often patch security vulnerabilities and fix bugs and therefore should be applied.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/fms/fms_policy_compliant/fms_policy_compliant.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms-intro.html,fms,This check ensures all FMS policies inside an admin account are compliant,[],,Ensure that all FMS policies inside an admin account are compliant,,[],,[],fms_policy_compliant,"{'Code': {'CLI': 'aws fms list-policies', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure FMS is enabled and all the policies are compliant across your AWS accounts', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms-intro.html'}}",medium,[],arn:aws:fms:region:account-id:policy/policy,Other,"If FMS policies are not compliant, means there are resources unprotected by the policies"
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ssmincidents/ssmincidents_enabled_with_plans/ssmincidents_enabled_with_plans.metadata.json,,https://docs.aws.amazon.com/incident-manager/latest/userguide/response-plans.html,ssm,Ensure SSM Incidents is enabled with response plans.,[],,Ensure SSM Incidents is enabled with response plans.,,[],,[],ssmincidents_enabled_with_plans,"{'Code': {'CLI': 'aws ssm-incidents create-response-plan', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable SSM Incidents and create response plans', 'Url': 'https://docs.aws.amazon.com/incident-manager/latest/userguide/response-plans.html'}}",low,[],arn:aws:ssm:region:account-id:document/document-name,Other,"Not having SSM Incidents enabled can increase the risk of delayed detection and response to security incidents, unauthorized access, limited visibility into incidents and vulnerabilities"
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_https_enabled/cloudfront_distributions_https_enabled.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html,cloudfront,Check if CloudFront distributions are set to HTTPS.,['internet-exposed'],,Check if CloudFront distributions are set to HTTPS.,,[],,[],cloudfront_distributions_https_enabled,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/networking-policies/networking_32#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/security-policy.html', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/networking_32#terraform'}, 'Recommendation': {'Text': 'Use HTTPS everywhere possible. It will enforce privacy and protect against account hijacking and other threats.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https.html'}}",medium,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,If not enabled sensitive information in transit is not protected. Surveillance and other threats are risks may exists.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_https_sni_enabled/cloudfront_distributions_https_sni_enabled.metadata.json,,https://www.cloudflare.com/es-es/learning/ssl/what-is-sni/,cloudfront,Check if CloudFront distributions are using SNI to serve HTTPS requests.,['encryption'],,Check if CloudFront distributions are using SNI to serve HTTPS requests.,,[],,[],cloudfront_distributions_https_sni_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-8', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/cloudfront-sni.html'}, 'Recommendation': {'Text': 'Ensure that your CloudFront distributions are configured to use Server Name Indication (SNI) when serving HTTPS requests with custom SSL/TLS certificates. This is the recommended approach for reducing costs and optimizing IP address usage.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/cnames-https-dedicated-ip-or-sni.html#cnames-https-sni'}}",low,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,"If SNI is not used, CloudFront will allocate a dedicated IP address for each SSL certificate, leading to higher costs and inefficient IP address utilization. This could also complicate scaling and managing multiple distributions, especially if your domain requires multiple SSL certificates."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_s3_origin_non_existent_bucket/cloudfront_distributions_s3_origin_non_existent_bucket.metadata.json,,https://docs.aws.amazon.com/whitepapers/latest/secure-content-delivery-amazon-cloudfront/s3-origin-with-cloudfront.html,cloudfront,This control checks whether Amazon CloudFront distributions are pointing to non-existent Amazon S3 origins without static website hosting. The control fails if the origin is configured to point to a non-existent bucket.,['trustboundaries'],,CloudFront distributions should not point to non-existent S3 origins without static website hosting.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],cloudfront_distributions_s3_origin_non_existent_bucket,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-12', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/cloudfront-existing-s3-bucket.html'}, 'Recommendation': {'Text': 'Verify that all CloudFront distributions are configured to point to valid, existing S3 buckets. Update the origin settings as needed to ensure that your distributions are linked to appropriate and secure origins.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/HowToUpdateDistribution.html'}}",high,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,"Pointing a CloudFront distribution to a non-existent S3 bucket can allow malicious actors to create the bucket and potentially serve unauthorized content through your distribution, leading to security and integrity issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_geo_restrictions_enabled/cloudfront_distributions_geo_restrictions_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/georestrictions.html,cloudfront,Check if Geo restrictions are enabled in CloudFront distributions.,[],Infrastructure Security,Check if Geo restrictions are enabled in CloudFront distributions.,,[],,[],cloudfront_distributions_geo_restrictions_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/geo-restriction.html', 'Terraform': ''}, 'Recommendation': {'Text': 'If possible, define and enable Geo restrictions for this service.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/georestrictions.html'}}",low,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,"Consider countries where service should not be accessed, by legal or compliance requirements. Additionally if not restricted the attack vector is increased."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_multiple_origin_failover_configured/cloudfront_distributions_multiple_origin_failover_configured.metadata.json,,https://docs.aws.amazon.com/cloudfront/latest/APIReference/API_OriginGroup.html,cloudfront,Check if CloudFront distributions have origin failover enabled.,['redundancy'],,Check if CloudFront distributions have origin failover enabled.,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'NIST 800-53 Controls']",cloudfront_distributions_multiple_origin_failover_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-4', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/origin-failover-enabled.html'}, 'Recommendation': {'Text': 'Configure origin failover in your CloudFront distribution by setting up an origin group with at least two origins to enhance availability and ensure traffic is redirected if the primary origin fails.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/high_availability_origin_failover.html#concept_origin_groups.creating'}}",low,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AWSCloudFrontDistribution,"Without origin failover, if the primary origin becomes unavailable, your CloudFront distribution may experience downtime, leading to potential service interruptions and a poor user experience."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_s3_origin_access_control/cloudfront_distributions_s3_origin_access_control.metadata.json,,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#migrate-from-oai-to-oac,cloudfront,Check if CloudFront distributions use origin access control.,[],,Check if CloudFront distributions with S3 origin use OAC.,,[],,['Data Exposure'],cloudfront_distributions_s3_origin_access_control,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/iam-policies/ensure-aws-cloudfromt-distribution-with-s3-have-origin-access-set-to-enabled/', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-13', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/s3-origin.html'}, 'Recommendation': {'Text': 'Configure Origin Access Control (OAC) for CloudFront distributions that use an Amazon S3 origin. This will ensure that the content in your S3 bucket is accessible only through the specified CloudFront distribution, enhancing security by preventing direct access to the bucket.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html'}}",medium,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AWSCloudFrontDistribution,"Without OAC, your S3 bucket could be accessed directly, bypassing CloudFront, which could expose your content to unauthorized access. Additionally, relying on Origin Access Identity (OAI) may limit functionality and security features, making your distribution less secure and more difficult to manage."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_field_level_encryption_enabled/cloudfront_distributions_field_level_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/field-level-encryption.html,cloudfront,Check if CloudFront distributions have Field Level Encryption enabled.,['encryption'],Data Protection,Check if CloudFront distributions have Field Level Encryption enabled.,,[],,[],cloudfront_distributions_field_level_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/field-level-encryption-enabled.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Check if applicable to any sensitive data. This encryption ensures that only applications that need the dataâ€”and have the credentials to decrypt it - are able to do so.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/field-level-encryption.html'}}",low,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,Allows you protect specific data throughout system processing so that only certain applications can see it.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_logging_enabled/cloudfront_distributions_logging_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html,cloudfront,Check if CloudFront distributions have logging enabled.,"['forensics-ready', 'logging']",Logging and Monitoring,Check if CloudFront distributions have logging enabled.,,[],,[],cloudfront_distributions_logging_enabled,"{'Code': {'CLI': 'aws cloudfront update-distribution --id <DISTRIBUTION_ID> --distribution-config logging.json --if-match <ETAG>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/logging_20#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_20', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/logging_20#terraform'}, 'Recommendation': {'Text': 'Real-time monitoring can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Enable logging for services with defined log rotation. These logs are useful for Incident Response and forensics investigation among other use cases.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html'}}",medium,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,If not enabled monitoring of service use is not possible.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_using_deprecated_ssl_protocols/cloudfront_distributions_using_deprecated_ssl_protocols.metadata.json,,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html,cloudfront,Check if CloudFront distributions are using deprecated SSL protocols.,['encryption'],,Check if CloudFront distributions are using deprecated SSL protocols.,,[],,[],cloudfront_distributions_using_deprecated_ssl_protocols,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_33', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Security policy with ciphers that are as strong as possible. Drop legacy and insecure ciphers.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html'}}",low,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,Using insecure ciphers could affect privacy of in transit information.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_origin_traffic_encrypted/cloudfront_distributions_origin_traffic_encrypted.metadata.json,,https://docs.aws.amazon.com/whitepapers/latest/secure-content-delivery-amazon-cloudfront/custom-origin-with-cloudfront.html,cloudfront,Check if CloudFront distributions encrypt traffic to custom origins.,[],,Check if CloudFront distributions encrypt traffic to custom origins.,,[],,[],cloudfront_distributions_origin_traffic_encrypted,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-9', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/cloudfront-traffic-to-origin-unencrypted.html'}, 'Recommendation': {'Text': 'Configure your CloudFront distributions to require HTTPS (TLS) for traffic to custom origins, ensuring all data transmitted between CloudFront and the origin is encrypted and protected from unauthorized access.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https-cloudfront-to-custom-origin.html'}}",medium,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AWSCloudFrontDistribution,"Allowing unencrypted HTTP traffic between CloudFront and custom origins can expose data to potential eavesdropping and manipulation, compromising data security and integrity."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_default_root_object/cloudfront_distributions_default_root_object.metadata.json,,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/DefaultRootObject.html#DefaultRootObjectHow,cloudfront,Check if CloudFront distributions have a default root object.,[],,Check if CloudFront distributions have a default root object.,,[],,[],cloudfront_distributions_default_root_object,"{'Code': {'CLI': 'aws cloudfront update-distribution --id <distribution-id> --default-root-object <new-root-object>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-1', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/cloudfront-default-object.html'}, 'Recommendation': {'Text': ""Configure a default root object for your CloudFront distribution to ensure that a specific file (such as index.html) is returned when users access the root URL. This improves user experience and ensures that sensitive content isn't accidentally exposed."", 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/DefaultRootObject.html#DefaultRootObjectHowToDefine'}}",high,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,"Without a default root object, requests to the root URL may result in an error or expose unintended content, leading to potential security risks and a poor user experience."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_using_waf/cloudfront_distributions_using_waf.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html,cloudfront,Check if CloudFront distributions are using WAF.,[],,Check if CloudFront distributions are using WAF.,,[],,['IAM'],cloudfront_distributions_using_waf,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_27#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_27', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_27#terraform'}, 'Recommendation': {'Text': 'Use AWS WAF to protect your service from common web exploits. These could affect availability and performance, compromise security, or consume excessive resources.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/cloudfront-integrated-with-waf.html'}}",medium,[],arn:partition:cloudfront:region:account-id:distribution/resource-id,AwsCloudFrontDistribution,"Potential attacks and / or abuse of service, more even for even for internet reachable services."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudfront/cloudfront_distributions_custom_ssl_certificate/cloudfront_distributions_custom_ssl_certificate.metadata.json,,https://aws.amazon.com/what-is/ssl-certificate/,cloudfront,Ensure that your Amazon CloudFront distributions are configured to use a custom SSL/TLS certificate instead of the default one.,['encryption'],,CloudFront distributions should use custom SSL/TLS certificates.,,[],,[],cloudfront_distributions_custom_ssl_certificate,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-cloudfront-distribution-uses-custom-ssl-certificate/', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/cloudfront-controls.html#cloudfront-7', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudFront/cloudfront-distro-custom-tls.html'}, 'Recommendation': {'Text': 'Configure your CloudFront distributions to use a custom SSL/TLS certificate to enable secure access via your own domain names and meet specific security and branding needs. This allows for more control over encryption and authentication settings.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/CNAMEs.html#CreatingCNAME'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCloudFrontDistribution,Using the default SSL/TLS certificate provided by CloudFront can limit your ability to use custom domain names and may not align with your organization's security policies or branding requirements.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/wafv2/wafv2_webacl_with_rules/wafv2_webacl_with_rules.metadata.json,,https://docs.aws.amazon.com/waf/latest/APIReference/API_Rule.html,wafv2,Check if AWS WAFv2 WebACL has at least one rule or rule group associated with it.,[],,Check if AWS WAFv2 WebACL has at least one rule or rule group.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],wafv2_webacl_with_rules,"{'Code': {'CLI': 'aws wafv2 update-web-acl --id <web-acl-id> --scope <scope> --default-action <default-action> --rules <rules>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/networking-policies/bc_aws_networking_64/', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-10', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that each AWS WAF web ACL contains at least one rule or rule group to effectively manage and inspect incoming HTTP(S) web requests.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-editing.html'}}",medium,[],arn:partition:wafv2:region:account-id:webacl/webacl-id,AwsWafv2WebAcl,"An empty AWS WAF web ACL allows all web traffic to pass without inspection or control, exposing resources to potential security threats and attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/wafv2/wafv2_webacl_logging_enabled/wafv2_webacl_logging_enabled.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/logging.html,wafv2,Check if AWS WAFv2 logging is enabled,['logging'],,Check if AWS WAFv2 WebACL logging is enabled,,[],,['Logging and Monitoring'],wafv2_webacl_logging_enabled,"{'Code': {'CLI': 'aws wafv2 update-web-acl-logging-configuration --scope REGIONAL --web-acl-arn arn:partition:wafv2:region:account-id:webacl/webacl-id --logging-configuration \'{""LogDestinationConfigs"": [""arn:partition:logs:region:account-id:log-group:log-group-name""]}\'', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_33#terraform', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-11', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/WAF/enable-web-acls-logging.html'}, 'Recommendation': {'Text': 'Enable AWS WAFv2 logging for your Web ACLs to monitor and analyze traffic patterns effectively.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/logging.html'}}",medium,[],arn:partition:wafv2:region:account-id:webacl/webacl-id,AwsWafv2WebAcl,Enabling AWS WAFv2 logging helps monitor and analyze traffic patterns for enhanced security.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/wafv2/wafv2_webacl_rule_logging_enabled/wafv2_webacl_rule_logging_enabled.metadata.json,,https://docs.aws.amazon.com/waf/latest/APIReference/API_UpdateRuleGroup.html,wafv2,This control checks whether an AWS WAF rule or rule group has Amazon CloudWatch metrics enabled. The control fails if the rule or rule group doesn't have CloudWatch metrics enabled.,['logging'],,Check if AWS WAFv2 WebACL rule or rule group has Amazon CloudWatch metrics enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],wafv2_webacl_rule_logging_enabled,"{'Code': {'CLI': 'aws wafv2 update-rule-group --id <rule-group-id> --scope <scope> --name <rule-group-name> --cloudwatch-metrics-enabled true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-12', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that CloudWatch Metrics are enabled for AWS WAF rules and rule groups. This provides detailed insights into traffic, enabling timely identification of security risks.', 'Url': 'https://docs.aws.amazon.com/waf/latest/APIReference/API_UpdateWebACL.html'}}",medium,[],arn:partition:wafv2:region:account-id:webacl/webacl-id,AwsWafv2RuleGroup,"Without CloudWatch Metrics enabled on AWS WAF rules or rule groups, it's challenging to monitor traffic flow effectively. This reduces visibility into potential security threats, such as malicious activities or unusual traffic patterns."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_internal_user_database_enabled/opensearch_service_domains_internal_user_database_enabled.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have internal user database enabled,[],,Check if Amazon Elasticsearch/Opensearch Service domains have internal user database enabled,,[],,"['Protect', 'Data protection']",opensearch_service_domains_internal_user_database_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Remove users from internal user database and uso Cognito instead.', 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/fgac.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,"Internal User Database is convenient for demos, for production environment use Federated authentication."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_audit_logging_enabled/opensearch_service_domains_audit_logging_enabled.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have audit logging enabled,"['forensics-ready', 'logging']",,Check if Amazon Elasticsearch/Opensearch Service domains have audit logging enabled,,[],,"['Identify', 'Logging']",opensearch_service_domains_audit_logging_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Make sure you are logging information about Amazon Elasticsearch Service operations.', 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/audit-logs.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_encryption_at_rest_enabled/opensearch_service_domains_encryption_at_rest_enabled.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have encryption at-rest enabled,['encryption'],,Check if Amazon Elasticsearch/Opensearch Service domains have encryption at-rest enabled,,[],,"['Protect', 'Data protection', 'Encryption of data at rest']",opensearch_service_domains_encryption_at_rest_enabled,"{'Code': {'CLI': 'aws es update-elasticsearch-domain-config --domain-name <DOMAIN_NAME> --encryption-at-rest-options Enabled=true,KmsKeyId=<KMS_KEY_ID>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_3-enable-encryptionatrest#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/encryption-at-rest.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable encryption at rest using AWS KMS to store and manage your encryption keys and the Advanced Encryption Standard algorithm with 256-bit keys (AES-256) to perform the encryption.', 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,If not enable unauthorized access to your data could risk increases.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_cloudwatch_logging_enabled/opensearch_service_domains_cloudwatch_logging_enabled.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have logging enabled,"['forensics-ready', 'logging']",,Check if Amazon Elasticsearch/Opensearch Service domains have logging enabled,,[],,"['Identify', 'Logging']",opensearch_service_domains_cloudwatch_logging_enabled,"{'Code': {'CLI': 'aws logs put-resource-policy --policy-name <POLICY_NAME> --policy-document <POLICY_DOC_JSON>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_7#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_7', 'Terraform': 'https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_7#terraform'}, 'Recommendation': {'Text': 'Enable Elasticsearch/Opensearch log. Create use cases for them. Using audit logs check for access denied events.', 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createdomain-configure-slow-logs.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,"Amazon ES exposes four Elasticsearch/Opensearch logs through Amazon CloudWatch Logs: error logs, search slow logs, index slow logs, and audit logs."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_access_control_enabled/opensearch_service_domains_access_control_enabled.metadata.json,,https://docs.aws.amazon.com/opensearch-service/latest/developerguide/fgac.html,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have fine grained access control enabled,[],,Check if Amazon Elasticsearch/Opensearch Service domains have fine grained access control enabled,,[],,[],opensearch_service_domains_access_control_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-7', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable fine grained access control for your OpenSearch domains', 'Url': 'https://docs.aws.amazon.com/opensearch-service/latest/developerguide/fgac.html#fgac-enabling'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,"Amazon ES's fine graine access control enhances security by verifying that access to OpenSearch domains is controlled at a granular level, allowing for more precise permissions management and reducing the risk of unauthorised access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_use_cognito_authentication_for_kibana/opensearch_service_domains_use_cognito_authentication_for_kibana.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains has Amazon Cognito or SAML authentication for Kibana enabled,[],,Check if Amazon Elasticsearch/Opensearch Service domains has either Amazon Cognito or SAML authentication for Kibana enabled,,[],,"['Identify', 'Logging']",opensearch_service_domains_use_cognito_authentication_for_kibana,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'If you do not configure Amazon Cognito or SAML authentication, you can still protect Kibana using an IP-based access policy and a proxy server or HTTP basic authentication.', 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-ac.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,"Not enabling Amazon Cognito or SAML authentication for Kibana in AWS Elasticsearch/OpenSearch Service domains increases the likelihood of unauthorized access to sensitive data, potentially compromising system integrity."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_fault_tolerant_master_nodes/opensearch_service_domains_fault_tolerant_master_nodes.metadata.json,,https://docs.aws.amazon.com/opensearch-service/latest/developerguide/managedomains-dedicatedmasternodes.html#dedicatedmasternodes-number,opensearch,OpenSearch Service uses dedicated master nodes to increase cluster stability. A minimum of three dedicated master nodes is recommended to ensure high availability.,['redundancy'],,OpenSearch Service Domain should have at least three dedicated master nodes,,[],,[],opensearch_service_domains_fault_tolerant_master_nodes,"{'Code': {'CLI': ""aws es update-elasticsearch-domain-config --region <region> --domain-name <name> --elasticsearch-cluster-config DedicatedMasterEnabled=true,DedicatedMasterType='<instance_type>',DedicatedMasterCount=3"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/opensearch-controls.html#opensearch-11', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that your OpenSearch Service domain has at least three dedicated master nodes', 'Url': 'https://docs.aws.amazon.com/opensearch-service/latest/developerguide/managedomains-dedicatedmasternodes.html#dedicatedmasternodes-number'}}",medium,[],arn:partition:es:region:account-id:domain/resource-id,AwsOpenSearchServiceDomain,"If a master node fails, the cluster may become unavailable."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_https_communications_enforced/opensearch_service_domains_https_communications_enforced.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have enforce HTTPS enabled,['encryption'],,Check if Amazon Elasticsearch/Opensearch Service domains have enforce HTTPS enabled,,[],,"['Protect', 'Data protection', 'Encryption of data in transit']",opensearch_service_domains_https_communications_enforced,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_6#fix---builtime', 'Other': 'https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_6#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': ""When creating ES Domains, enable 'Require HTTPS fo all traffic to the domain'"", 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createupdatedomains.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,If not enable unauthorized access to your data could risk increases.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_updated_to_the_latest_service_software_version/opensearch_service_domains_updated_to_the_latest_service_software_version.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have updates available,[],,Check if Amazon Elasticsearch/Opensearch Service domains have updates available,,[],,"['Detect', 'Vulnerability, patch, and version management']",opensearch_service_domains_updated_to_the_latest_service_software_version,"{'Code': {'CLI': 'aws es upgrade-elasticsearch-domain --domain-name <DOMAIN_NAME> --target-version <TARGET_VERSION> --perform-check-only', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/version.html', 'Terraform': ''}, 'Recommendation': {'Text': 'The Notifications panel in the console is the easiest way to see if an update is available or check the status of an update. You can also receive these notifications through Amazon EventBridge. If you take no action on required updates, Amazon ES still updates your domain service software automatically after a certain timeframe (typically two weeks). In this situation, Amazon ES sends notifications when it starts the update and when the update is complete.', 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-service-software.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,Amazon ES regularly releases system software updates that add features or otherwise improve your domains.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_not_publicly_accessible/opensearch_service_domains_not_publicly_accessible.metadata.json,,,opensearch,Check if Amazon Opensearch/Elasticsearch domains are publicly accessible via their access policies.,['internet-exposed'],,Check if Amazon Opensearch/Elasticsearch domains are publicly accessible,,[],,['Effects/Data Exposure'],opensearch_service_domains_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/domain-exposed.html', 'Terraform': ''}, 'Recommendation': {'Text': ""Modify the access policy attached to your Amazon OpenSearch domain and replace the 'Principal' element value (i.e. '*') with the ARN of the trusted AWS account. You can also add a Condition clause to the policy statement to limit the domain access to a specific (trusted) IP address/IP range only."", 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-vpc.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,Publicly accessible services could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_fault_tolerant_data_nodes/opensearch_service_domains_fault_tolerant_data_nodes.metadata.json,,https://docs.aws.amazon.com/opensearch-service/latest/developerguide/what-is.html,opensearch,This control checks whether Elasticsearch/Opensearch domains are fault-tolerant with at least three data nodes and cross-zone replication (Zone Awareness) enabled.,['redundancy'],,Ensure Elasticsearch/Opensearch domains have fault-tolerant data nodes.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],opensearch_service_domains_fault_tolerant_data_nodes,"{'Code': {'CLI': 'aws opensearch update-domain-config --domain-name <domain-name> --cluster-config InstanceCount=3,ZoneAwarenessEnabled=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/es-controls.html#es-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the Elasticsearch/Opensearch domain to ensure at least three data nodes and enable cross-zone replication (Zone Awareness) for high availability and fault tolerance.', 'Url': 'https://docs.aws.amazon.com/opensearch-service/latest/developerguide/managedomains-multiaz.html'}}",medium,[],arn:partition:es:{region}:{account-id}:domain/{domain-name},AwsElasticsearchDomain,"Without at least three data nodes and without cross-zone replication (Zone Awareness), the Elasticsearch/Opensearch domain may not be fault-tolerant, leading to a higher risk of data loss or unavailability in case of node failure."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/opensearch/opensearch_service_domains_node_to_node_encryption_enabled/opensearch_service_domains_node_to_node_encryption_enabled.metadata.json,,,opensearch,Check if Amazon Elasticsearch/Opensearch Service domains have node-to-node encryption enabled,['encryption'],,Check if Amazon Elasticsearch/Opensearch Service domains have node-to-node encryption enabled,,[],,"['Protect', 'Data protection', 'Encryption of data in transit']",opensearch_service_domains_node_to_node_encryption_enabled,"{'Code': {'CLI': 'aws es update-elasticsearch-domain-config --domain-name <DOMAIN_NAME> --node-to-node-encryption-options Enabled=true', 'NativeIaC': 'https://docs.prowler.com/checks/aws/elasticsearch-policies/elasticsearch_5#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/node-to-node-encryption.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Node-to-node encryption on new domains requires Elasticsearch 6.0 or later. Enabling the feature on existing domains requires Elasticsearch 6.7 or later. Choose the existing domain in the AWS console, Actions, and Modify encryption.', 'Url': 'https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/ntn.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsOpenSearchServiceDomain,Node-to-node encryption provides an additional layer of security on top of the default features of Amazon ES. This architecture prevents potential attackers from intercepting traffic between Elasticsearch nodes and keeps the cluster secure.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/accessanalyzer/accessanalyzer_enabled_without_findings/accessanalyzer_enabled_without_findings.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html,accessanalyzer,Check if IAM Access Analyzer is enabled without findings,[],,Check if IAM Access Analyzer is enabled without findings,,[],,['IAM'],accessanalyzer_enabled_without_findings,"{'Code': {'CLI': 'aws accessanalyzer create-analyzer --analyzer-name <NAME> --type <ACCOUNT|ORGANIZATION>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable IAM Access Analyzer for all accounts, create analyzer and take action over it is recommendations (IAM Access Analyzer is available at no additional cost).', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html'}}",low,[],arn:partition:access-analyzer:region:account-id:analyzer/resource-id,Other,"AWS IAM Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, that are shared with an external entity. This lets you identify unintended access to your resources and data, which is a security risk. IAM Access Analyzer uses a form of mathematical analysis called automated reasoning, which applies logic and mathematical inference to determine all possible access paths allowed by a resource policy."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/accessanalyzer/accessanalyzer_enabled/accessanalyzer_enabled.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html,accessanalyzer,Check if IAM Access Analyzer is enabled,[],,Check if IAM Access Analyzer is enabled,,[],,['IAM'],accessanalyzer_enabled,"{'Code': {'CLI': 'aws accessanalyzer create-analyzer --analyzer-name <NAME> --type <ACCOUNT|ORGANIZATION>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable IAM Access Analyzer for all accounts, create analyzer and take action over it is recommendations (IAM Access Analyzer is available at no additional cost).', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html'}}",low,[],arn:partition:access-analyzer:region:account-id:analyzer/resource-id,Other,"AWS IAM Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, that are shared with an external entity. This lets you identify unintended access to your resources and data, which is a security risk. IAM Access Analyzer uses a form of mathematical analysis called automated reasoning, which applies logic and mathematical inference to determine all possible access paths allowed by a resource policy."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/glacier/glacier_vaults_policy_public_access/glacier_vaults_policy_public_access.metadata.json,,https://docs.aws.amazon.com/amazonglacier/latest/dev/access-control-overview.html,glacier,Ensure CodeArtifact internal packages do not allow external public source publishing.,['internet-exposed'],,Check if S3 Glacier vaults have policies which allow access to everyone.,,[],,[],glacier_vaults_policy_public_access,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-glacier-vault-access-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it#terraform'}, 'Recommendation': {'Text': 'Ensure vault policy does not have principle as *.', 'Url': 'https://docs.aws.amazon.com/amazonglacier/latest/dev/access-control-overview.html'}}",critical,[],arn:aws:glacier:region:account-id:vaults/vault-name,Other,Vaults accessible to everyone could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/lightsail/lightsail_instance_automated_snapshots/lightsail_instance_automated_snapshots.metadata.json,,https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-configuring-automatic-snapshots.html,lightsail,Amazon Lightsail automatically creates daily snapshots of your instances. These snapshots are used for automatic backups and are stored at no additional cost. It is recommended to enable automatic snapshots for your Lightsail instances.,[],,Check if instances have automated snapshots enabled,,[],,['Infrastructure Security'],lightsail_instance_automated_snapshots,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'The automatic snapshot is a best practice to protect your data. It is recommended to enable automatic snapshots for your Lightsail instances.', 'Url': 'https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-changing-automatic-snapshot-time.html'}}",medium,[],arn:partition:lightsail:region:account:Instance/instance-id,Other,"If automatic snapshots are not enabled, you may lose data in case of accidental deletion or corruption."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/lightsail/lightsail_instance_public/lightsail_instance_public.metadata.json,,https://docs.aws.amazon.com/lightsail/latest/userguide/understanding-public-ip-and-private-ip-addresses-in-amazon-lightsail.html#ipv4-addresses,lightsail,Ensure that Lightsail instances are not publicly accessible,['internet-exposed'],,Ensure that Lightsail instances are not publicly accessible,,[],instance,[],lightsail_instance_public,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'We recommend that you disable public access to the instance and use a VPN or a bastion host to access the instance securely.', 'Url': ''}}",high,[],arn:partition:lightsail:region:account:Instance/instance-id,Other,"If an instance is publicly accessible, it can be accessed by anyone on the internet. This can lead to unauthorized access to the instance and its data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/lightsail/lightsail_database_public/lightsail_database_public.metadata.json,,https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-databases.html,lightsail,"The database is in public mode, which means it is exposed to the internet.",['internet-exposed'],,Check if the database has the public mode.,,[],database,['Infrastructure Security'],lightsail_database_public,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Change the database to private mode.', 'Url': ''}}",high,[],arn:partition:lightsail:region:account:RelationalDatabase/database-id,Other,This can lead to unauthorized access to the database.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/lightsail/lightsail_static_ip_unused/lightsail_static_ip_unused.metadata.json,,https://docs.aws.amazon.com/lightsail/latest/userguide/understanding-public-ip-and-private-ip-addresses-in-amazon-lightsail.html,lightsail,Static IPs that are allocated but not attached to any instance are wasting resources and may pose a security risk if left unused for extended periods.,[],,Static IP are allocated but not attached to any instance,,[],static_ip,[],lightsail_static_ip_unused,"{'Code': {'CLI': 'aws lightsail release-static-ip --static-ip-name static-ip-name', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Release or attach any unused static IPs to ensure efficient resource utilization and minimize potential security risks.', 'Url': ''}}",low,[],arn:partition:lightsail:region:account:static-ip/static-ip-id,Other,Unattached static IPs can be potential entry points for unauthorized access or DDoS attacks if not properly secured.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticbeanstalk/elasticbeanstalk_environment_managed_updates_enabled/elasticbeanstalk_environment_managed_updates_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/elastic-beanstalk-managed-updates-enabled.html,elasticbeanstalk,This control checks whether managed platform updates are enabled for an Elastic Beanstalk environment. The control fails if no managed platform updates are enabled.,['vulnerabilities'],,Elastic Beanstalk managed platform updates should be enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices'],elasticbeanstalk_environment_managed_updates_enabled,"{'Code': {'CLI': 'aws elasticbeanstalk update-environment --environment-id <environment-id> --option-settings Namespace=aws:elasticbeanstalk:environment:ManagedActions,OptionName=ManagedActionsEnabled,Value=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elasticbeanstalk-controls.html#elasticbeanstalk-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable managed platform updates for your Elastic Beanstalk environment to ensure the latest security patches and updates are applied.', 'Url': 'https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/environment-platform-update-managed.html'}}",high,[],arn:aws:elasticbeanstalk:{region}:{account-id}:environment/{environment-id},AwsElasticBeanstalkEnvironment,"If managed platform updates are not enabled, the environment might miss critical security patches and updates, which can expose it to vulnerabilities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticbeanstalk/elasticbeanstalk_environment_enhanced_health_reporting/elasticbeanstalk_environment_enhanced_health_reporting.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/beanstalk-enhanced-health-reporting-enabled.html,elasticbeanstalk,This control checks whether enhanced health reporting is enabled for your AWS Elastic Beanstalk environments.,['logging'],,Elastic Beanstalk environments should have enhanced health reporting enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices'],elasticbeanstalk_environment_enhanced_health_reporting,"{'Code': {'CLI': 'aws elasticbeanstalk update-environment --environment-id <environment-id> --option-settings Namespace=aws:elasticbeanstalk:healthreporting:system,OptionName=EnhancedHealthReporting,Value=enabled', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elasticbeanstalk-controls.html#elasticbeanstalk-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable enhanced health reporting in your Elastic Beanstalk environments for better monitoring and faster issue detection.', 'Url': 'https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/health-enhanced-enable.html#health-enhanced-enable-console'}}",low,[],arn:aws:elasticbeanstalk:{region}:{account-id}:environment/{environment-id},AwsElasticBeanstalkEnvironment,"Without enhanced health reporting, you may face delays in detecting and responding to issues in your Elastic Beanstalk environment, affecting application availability and performance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticbeanstalk/elasticbeanstalk_environment_cloudwatch_logging_enabled/elasticbeanstalk_environment_cloudwatch_logging_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/elastic-beanstalk-logs-to-cloudwatch.html,elasticbeanstalk,This control checks whether an Elastic Beanstalk environment is configured to send logs to CloudWatch Logs. The control fails if an Elastic Beanstalk environment isn't configured to send logs to CloudWatch Logs.,['logging'],,Elastic Beanstalk environment should stream logs to CloudWatch,,[],,['Software and Configuration Checks/AWS Security Best Practices'],elasticbeanstalk_environment_cloudwatch_logging_enabled,"{'Code': {'CLI': 'aws elasticbeanstalk update-environment --environment-id <environment-id> --option-settings Namespace=aws:elasticbeanstalk:environment:proxy:logging,OptionName=StreamLogs,Value=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elasticbeanstalk-controls.html#elasticbeanstalk-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable log streaming to CloudWatch for your Elastic Beanstalk environment to monitor and retain logs.', 'Url': 'https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.cloudwatchlogs.html#AWSHowTo.cloudwatchlogs.streaming'}}",high,[],arn:aws:elasticbeanstalk:{region}:{account-id}:environment/{environment-id},AwsElasticBeanstalkEnvironment,"Without log streaming to CloudWatch, it becomes difficult to monitor and troubleshoot your Elastic Beanstalk environments, which can lead to missed events or security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_integration_cloudwatch_logs/neptune_cluster_integration_cloudwatch_logs.metadata.json,,https://docs.aws.amazon.com/neptune/latest/userguide/auditing.html,neptune,Check if Neptune Clusters have audit cloudwatch logs enabled.,['logging'],,Check if Neptune Clusters have audit cloudwatch logs enabled.,,[],,"['Software and Configuration Checks, AWS Security Best Practices']",neptune_cluster_integration_cloudwatch_logs,"{'Code': {'CLI': 'aws neptune modify-db-cluster --db-cluster-identifier <value> --cloudwatch-logs-export-configuration \'{""EnableLogTypes"":[""audit""]}\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable audit logs for Neptune Clusters.', 'Url': 'https://docs.aws.amazon.com/neptune/latest/userguide/cloudwatch-logs.html'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"If audit logs are not enabled, it is difficult to determine the root cause of security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_storage_encrypted/neptune_cluster_storage_encrypted.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-1,neptune,Check if Neptune Clusters storage is encrypted at rest.,[],,Check if Neptune Clusters storage is encrypted at rest.,,[],,[],neptune_cluster_storage_encrypted,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_18#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/general_18/', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_18#terraform'}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-1'}}",high,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"Ensure that the data available on your Amazon Neptune database instances is encrypted in order to meet regulatory requirements and prevent unauthorized users from accessing sensitive information. Encryption provides an additional layer of protection by securing your Neptune databases from unauthorized access to the underlying storage. Neptune is a fast, scalable, highly secure and fully-managed graph database service that makes it easy to build and run applications that work with deeply connected datasets."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_copy_tags_to_snapshots/neptune_cluster_copy_tags_to_snapshots.metadata.json,,https://docs.aws.amazon.com/neptune/latest/userguide/tagging.html#tagging-overview,neptune,This check ensures that Neptune DB clusters are configured to copy all tags to snapshots when the snapshots are created.,['trustboundaries'],,Check if Neptune DB clusters are configured to copy tags to snapshots.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],neptune_cluster_copy_tags_to_snapshots,"{'Code': {'CLI': 'aws neptune modify-db-cluster --db-cluster-identifier <db-cluster-identifier> --copy-tags-to-snapshot --apply-immediately', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-8', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure your Neptune DB clusters to copy tags to snapshots when the snapshots are created.', 'Url': 'https://docs.aws.amazon.com/neptune/latest/userguide/tagging.html#tagging-overview'}}",low,[],arn:aws:rds:region:account-id:cluster:db-cluster-identifier,AwsRdsDbCluster,"If tags are not copied to snapshots, the snapshots may lack necessary metadata for identification, governance, and access control, leading to potential mismanagement and security risks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_snapshot_encrypted/neptune_cluster_snapshot_encrypted.metadata.json,,https://docs.aws.amazon.com/neptune/latest/userguide/backup-restore-create-snapshot.html,neptune,This check ensures that Neptune DB cluster snapshots are encrypted at rest to protect sensitive data from unauthorized access.,['encryption'],,Check if Neptune DB cluster snapshots are encrypted at rest.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],neptune_cluster_snapshot_encrypted,"{'Code': {'CLI': 'aws rds copy-db-cluster-snapshot --source-db-cluster-snapshot-identifier <source-snapshot> --target-db-cluster-snapshot-identifier <encrypted-snapshot> --kms-key-id <kms-key-id>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that all Neptune DB cluster snapshots are encrypted at rest by enabling encryption on the cluster before creating snapshots or by copying unencrypted snapshots to encrypted ones.', 'Url': 'https://docs.aws.amazon.com/neptune/latest/userguide/backup-restore-create-snapshot.html'}}",medium,[],arn:aws:rds:region:account-id:cluster-snapshot:db-cluster-snapshot-identifier,AwsRdsDbClusterSnapshot,"If Neptune DB cluster snapshots are not encrypted, sensitive data might be exposed in case of unauthorized access, leading to potential data breaches and non-compliance with data protection regulations."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_backup_enabled/neptune_cluster_backup_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-5,neptune,Check if Neptune Clusters have backup enabled.,[],,Check for Neptune Clusters Backup Retention Period.,,[],,[],neptune_cluster_backup_enabled,"{'Code': {'CLI': 'aws neptune modify-db-cluster --db-cluster-identifier <DB_CLUSTER_ID> --backup-retention-period 7', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/sufficient-backup-retention-period.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/sufficient-backup-retention-period.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/sufficient-backup-retention-period.html#'}, 'Recommendation': {'Text': 'Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-5'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbCluster,Ensure that your Amazon Neptune graph database clusters have set a minimum backup retention period of 7 days or greater in order to achieve your organization compliance requirements. The retention period represents the number of days to retain automated snapshots.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_iam_authentication_enabled/neptune_cluster_iam_authentication_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-7,neptune,Check if Neptune Clusters have IAM authentication enabled.,[],,Check if Neptune Clusters have IAM authentication enabled.,,[],,[],neptune_cluster_iam_authentication_enabled,"{'Code': {'CLI': 'aws neptune modify-db-cluster --db-cluster-identifier <DB_CLUSTER_ID> --enable-iam-database-authentication', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/iam-db-authentication.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/iam-db-authentication.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/iam-db-authentication.html#'}, 'Recommendation': {'Text': 'Enable IAM authentication for Neptune Clusters.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-7'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,Ensure that IAM Database Authentication feature is enabled for your Amazon Neptune database clusters in order to make use of AWS Identity and Access Management (IAM) service to manage database access.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_uses_public_subnet/neptune_cluster_uses_public_subnet.metadata.json,,https://docs.aws.amazon.com/neptune/latest/userguide/get-started-vpc.html,neptune,Ensure Neptune Cluster is not using a public subnet,['internet-exposed'],,Ensure Neptune Cluster is not using a public subnet,,[],,[],neptune_cluster_uses_public_subnet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To ensure your Neptune cluster is not using a public subnet, follow the recommended remediation steps based on your preferred method.', 'Url': 'https://docs.aws.amazon.com/neptune/latest/userguide/get-started-vpc.html'}}",medium,[],arn:aws:rds:<region>:<account>:cluster:<resource_name>,AwsRdsDbCluster,There is a risk of exposing sensitive data if Neptune Cluster uses a public subnet.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_public_snapshot/neptune_cluster_public_snapshot.metadata.json,,https://docs.aws.amazon.com/neptune/latest/userguide/security-considerations.html,neptune,Check if NeptuneDB manual cluster snapshot is public.,['internet-exposed'],,Check if NeptuneDB manual cluster snapshot is public.,,[],,[],neptune_cluster_public_snapshot,"{'Code': {'CLI': 'aws neptune modify-db-cluster-snapshot-attribute --db-cluster-snapshot-identifier <snapshot_id> --attribute-name restore --values-to-remove all', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-3', 'Terraform': ''}, 'Recommendation': {'Text': 'To remove public access from a manual snapshot, follow the AWS documentation on NeptuneDB snapshots.', 'Url': 'https://docs.aws.amazon.com/neptune/latest/userguide/security-considerations.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsRdsDbClusterSnapshot,"If you share an unencrypted manual snapshot as public, the snapshot is available to all AWS accounts. Public snapshots may result in unintended data exposure."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_multi_az/neptune_cluster_multi_az.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-9,neptune,Check if Neptune Clusters have multi-AZ enabled.,['redundancy'],,Check if Neptune Clusters have multi-AZ enabled.,,[],,[],neptune_cluster_multi_az,"{'Code': {'CLI': '', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/multi-az.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/multi-az.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Neptune/multi-az.html#'}, 'Recommendation': {'Text': 'Enable multi-AZ deployment for production Neptune Clusters.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-9'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"Ensure that your Amazon Neptune graph database clusters are using Multi-AZ deployment configurations to enhance High Availability (HA) through automatic failover to read replicas in the event of a failure such as an Availability Zone (AZ) outage, an internal hardware or network outage, a software failure or in case of planned system maintenance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/neptune/neptune_cluster_deletion_protection/neptune_cluster_deletion_protection.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-4,neptune,Check if Neptune Clusters storage has deletion protection enabled.,[],,Check if Neptune Clusters storage has deletion protection enabled.,,[],,[],neptune_cluster_deletion_protection,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable deletion protection for production Neptune Clusters.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/neptune-controls.html#neptune-4'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,Enabling cluster deletion protection offers an additional layer of protection against accidental database deletion or deletion by an unauthorized user. A Neptune DB cluster can't be deleted while deletion protection is enabled. You must first disable deletion protection before a delete request can succeed.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/transfer/transfer_server_in_transit_encryption_enabled/transfer_server_in_transit_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/transfer-family-server-no-ftp.html,transfer,Ensure that your Transfer Family servers have encryption in transit enabled.,[],,Transfer Family Servers should have encryption in transit enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],transfer_server_in_transit_encryption_enabled,"{'Code': {'CLI': 'aws transfer update-server --server-id <server-id> --protocols SFTP FTPS AS2', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/transfer-controls.html#transfer-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure AWS Transfer Family servers to use secure protocols, such as SFTP, FTPS, or AS2, instead of FTP to protect data in transit. These protocols offer encryption, reducing exposure to interception and manipulation attacks.', 'Url': 'https://docs.aws.amazon.com/transfer/latest/userguide/edit-server-config.html#edit-protocols'}}",medium,[],arn:partition:transfer:region:account-id:server/server-id,AwsTransferServer,"Using FTP for endpoint connections leaves data in transit unencrypted, making it susceptible to interception by attackers. FTP lacks encryption, which exposes your data to person-in-the-middle and other interception risks. Adopting encrypted protocols such as SFTP, FTPS, or AS2 provides a layer of protection that helps secure sensitive data during transfer."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecr/ecr_repositories_tag_immutability/ecr_repositories_tag_immutability.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecr-private-tag-immutability-enabled.html,ecr,This control checks whether a ECR repository has tag immutability enabled. The control fails if a ECR repository has tag immutability disabled and passes if tag immutability is set to IMMUTABLE.,[],,ECR repositories should have tag immutability configured,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecr_repositories_tag_immutability,"{'Code': {'CLI': 'aws ecr put-image-tag-mutability --repository-name <repository-name> --image-tag-mutability IMMUTABLE', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecr-controls.html#ecr-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable tag immutability on your ECR repositories to prevent image tags from being overwritten.', 'Url': 'https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-tag-mutability.html'}}",medium,[],arn:aws:ecr:{region}:{account-id}:repository/{repository-name},AwsEcrRepository,"Disabling tag immutability in an ECR repository increases the risk of image tampering by allowing tags to be overridden, which can lead to deploying unintended images and security vulnerabilities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecr/ecr_registry_scan_images_on_push_enabled/ecr_registry_scan_images_on_push_enabled.metadata.json,,,ecr,Check if ECR Registry has scan on push enabled,[],,Check if ECR Registry has scan on push enabled,,[],,"['Identify', 'Vulnerability, patch, and version management']",ecr_registry_scan_images_on_push_enabled,"{'Code': {'CLI': ""aws ecr put-registry-scanning-configuration --rules 'scanFrequency=SCAN_ON_PUSH,repositoryFilters=[{filter=string,filterType=WILDCARD}]'"", 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable ECR image scanning and review the scan findings for information about the security of the container images that are being deployed.', 'Url': 'https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html'}}",medium,[],arn:partition:ecr:region:account-id:resource-id,Other,Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings. 
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecr/ecr_repositories_scan_images_on_push_enabled/ecr_repositories_scan_images_on_push_enabled.metadata.json,,,ecr,[DEPRECATED] Check if ECR image scan on push is enabled,[],,[DEPRECATED] Check if ECR image scan on push is enabled,,[],,"['Identify', 'Vulnerability, patch, and version management']",ecr_repositories_scan_images_on_push_enabled,"{'Code': {'CLI': 'aws ecr create-repository --repository-name <repo_name> --image-scanning-configuration scanOnPush=true--region <region_name>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_8#cli-command', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_8#fix---buildtime'}, 'Recommendation': {'Text': 'Enable ECR image scanning and review the scan findings for information about the security of the container images that are being deployed.', 'Url': 'https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEcrRepository,Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings. 
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecr/ecr_repositories_lifecycle_policy_enabled/ecr_repositories_lifecycle_policy_enabled.metadata.json,,,ecr,Check if ECR repositories have lifecycle policies enabled,[],,Check if ECR repositories have lifecycle policies enabled,,[],,"['Identify', 'Resource configuration']",ecr_repositories_lifecycle_policy_enabled,"{'Code': {'CLI': 'aws ecr put-lifecycle-policy --repository-name <REPOSITORY_NAME> --lifecycle-policy-text <LIFECYCLE_POLICY> [--registry-id <REGISTRY_ID>]', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ECR/lifecycle-policy-in-use.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Open the Amazon ECR console. Create an ECR lifecycle policy.', 'Url': 'https://docs.aws.amazon.com/AmazonECR/latest/userguide/LifecyclePolicies.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsEcrRepository,"Amazon ECR repositories run the risk of retaining huge volumes of images, increasing unnecessary cost."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecr/ecr_repositories_not_publicly_accessible/ecr_repositories_not_publicly_accessible.metadata.json,,,ecr,Ensure there are no ECR repositories set as Public,['internet-exposed'],,Ensure there are no ECR repositories set as Public,,[],,"['Protect', 'Secure Access Management']",ecr_repositories_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/public-policies/public_1-ecr-repositories-not-public#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/public-policies/public_1-ecr-repositories-not-public#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure the repository and its contents are not publicly accessible', 'Url': 'https://docs.aws.amazon.com/AmazonECR/latest/public/security_iam_service-with-iam.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEcrRepository,A repository policy that allows anonymous access may allow anonymous users to perform actions.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecr/ecr_repositories_scan_vulnerabilities_in_latest_image/ecr_repositories_scan_vulnerabilities_in_latest_image.metadata.json,,,ecr,Check if ECR image scan found vulnerabilities in the newest image version,[],,Check if ECR image scan found vulnerabilities in the newest image version,,[],,"['Identify', 'Vulnerability, patch, and version management']",ecr_repositories_scan_vulnerabilities_in_latest_image,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Open the Amazon ECR console. Then look for vulnerabilities and fix them.', 'Url': 'https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html#describe-scan-findings'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEcrRepository,Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_accelerator_cluster_in_transit_encryption_enabled/dynamodb_accelerator_cluster_in_transit_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionInTransit.html,dynamodb,"This control checks whether an Amazon DynamoDB Accelerator (DAX) cluster is encrypted in transit, with the endpoint encryption type set to TLS. The control fails if the DAX cluster isn't encrypted in transit.",['encryption'],,Check if DynamoDB Accelerator (DAX) clusters are encrypted in transit.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dynamodb_accelerator_cluster_in_transit_encryption_enabled,"{'Code': {'CLI': 'aws dax create-cluster --cluster-name <cluster-name> --node-type <node-type> --replication-factor <replication-factor> --cluster-endpoint-encryption-type TLS', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-7', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that DynamoDB Accelerator (DAX) clusters are encrypted in transit by enabling TLS during cluster creation.', 'Url': 'https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionInTransit.html'}}",medium,[],arn:aws:dynamodb:region:account-id:table/table-name,Other,"Without encryption in transit, DAX clusters are vulnerable to person-in-the-middle attacks or eavesdropping on network traffic, which could lead to unauthorized access or manipulation of sensitive data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_tables_pitr_enabled/dynamodb_tables_pitr_enabled.metadata.json,,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery_Howitworks.html,dynamodb,Check if DynamoDB tables point-in-time recovery (PITR) is enabled.,[],Data Protection,Check if DynamoDB tables point-in-time recovery (PITR) is enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],dynamodb_tables_pitr_enabled,"{'Code': {'CLI': 'aws dynamodb update-continuous-backups --table-name <table_name> --point-in-time-recovery-specification PointInTimeRecoveryEnabled=true', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_6#cloudformation--serverless', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_6#terraform'}, 'Recommendation': {'Text': 'Enable point-in-time recovery, this is not enabled by default.', 'Url': 'https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery_Howitworks.html'}}",medium,[],arn:partition:dynamodb:region:account-id:table/resource-id,AwsDynamoDbTable,"If the DynamoDB Table does not have point-in-time recovery enabled, it is vulnerable to accidental write or delete operations."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_table_deletion_protection_enabled/dynamodb_table_deletion_protection_enabled.metadata.json,,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/WorkingWithTables.Basics.html#WorkingWithTables.Basics.DeletionProtection,dynamodb,This control checks whether an Amazon DynamoDB table has deletion protection enabled to prevent accidental deletion during regular table management operations.,[],,Check if DynamoDB tables have deletion protection enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dynamodb_table_deletion_protection_enabled,"{'Code': {'CLI': 'aws dynamodb update-table --table-name <table-name> --deletion-protection-enabled', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable deletion protection for your DynamoDB tables to prevent accidental deletion.', 'Url': 'https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/WorkingWithTables.Basics.html#WorkingWithTables.Basics.DeletionProtection'}}",medium,[],arn:aws:dynamodb:region:account-id:table/table-name,AwsDynamoDbTable,"If deletion protection is not enabled, a DynamoDB table could be accidentally deleted, leading to data loss and potential disruption of business operations."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_accelerator_cluster_encryption_enabled/dynamodb_accelerator_cluster_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html,dynamodb,Check if DynamoDB DAX Clusters are encrypted at rest.,['encryption'],Data Protection,Check if DynamoDB DAX Clusters are encrypted at rest.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],dynamodb_accelerator_cluster_encryption_enabled,"{'Code': {'CLI': 'aws dax create-cluster --cluster-name <cluster_name> --node-type <node_type> --replication-factor <nodes_number> --iam-role-arn <role_arn> --sse-specification Enabled=true', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_23#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_23#terraform'}, 'Recommendation': {'Text': 'Re-create the cluster to enable encryption at rest if it was not enabled at creation.', 'Url': 'https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html'}}",medium,[],arn:partition:dax:region:account-id:cache/resource-id,Other,Encryption at rest provides an additional layer of data protection by securing your data from unauthorized access to the underlying storage.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_accelerator_cluster_multi_az/dynamodb_accelerator_cluster_multi_az.metadata.json,,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAX.concepts.cluster.html#DAX.concepts.regions-and-azs,dynamodb,This control checks whether an Amazon DynamoDB Accelerator (DAX) cluster has nodes in multiple availability zones.,['redundancy'],,Check if DynamoDB Accelerator (DAX) clusters have nodes in multiple availability zones.,,[],,[],dynamodb_accelerator_cluster_multi_az,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Create a DAX cluster with nodes in multiple availability zones.', 'Url': 'https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAX.concepts.cluster.html#DAX.concepts.regions-and-azs'}}",medium,[],arn:aws:dax:region:account-id:cache/table-name,Other,Without DAX nodes in multiple availability zones (AZ) the nodes are at risk of interruption if an AZ disruption occurs.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_table_protected_by_backup_plan/dynamodb_table_protected_by_backup_plan.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html,dynamodb,This control checks whether an Amazon DynamoDB table is covered by a backup plan. The control fails if the DynamoDB table isn't included in a backup plan.,['redundancy'],,Check if DynamoDB tables are included in a backup plan.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dynamodb_table_protected_by_backup_plan,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that all active DynamoDB tables are included in a backup plan to safeguard against data loss.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html'}}",medium,[],arn:aws:dynamodb:region:account-id:table/table-name,AwsDynamoDbTable,"If a DynamoDB table is not covered by a backup plan, data loss may occur due to accidental deletion, corruption, or unexpected failure, compromising the resilience of your application."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_table_cross_account_access/dynamodb_table_cross_account_access.metadata.json,,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/access-control-resource-based.html,dynamodb,This check determines if the DynamoDB table is accessible from other AWS accounts.,['trustboundaries'],,DynamoDB tables should not be accessible from other AWS accounts,,[],,['Infrastructure Security'],dynamodb_table_cross_account_access,"{'Code': {'CLI': 'aws dynamodb delete-resource-policy --resource-arn <resource-arn>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that the DynamoDB table is not accessible from other AWS accounts.', 'Url': 'https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/rbac-bpa-rbp.html'}}",medium,[],arn:partition:dynamodb:region:account-id:table/resource-id,AwsDynamoDbTable,"If the DynamoDB table is accessible from other AWS accounts, it may lead to unauthorized access to the data stored in the table."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_table_autoscaling_enabled/dynamodb_table_autoscaling_enabled.metadata.json,,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/AutoScaling.Console.html#AutoScaling.Console.ExistingTable,dynamodb,"This check ensures that DynamoDB tables can scale their read and write capacity as needed, either using on-demand capacity mode or provisioned mode with auto scaling configured.",[],,Check if DynamoDB tables automatically scale capacity with demand.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dynamodb_table_autoscaling_enabled,"{'Code': {'CLI': 'aws dynamodb update-table --table-name <table-name> --billing-mode PAY_PER_REQUEST', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dynamodb-controls.html#dynamodb-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable DynamoDB automatic scaling on existing tables by configuring on-demand capacity mode or provisioned mode with auto scaling.', 'Url': 'https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/AutoScaling.Console.html#AutoScaling.Console.ExistingTable'}}",medium,[],arn:aws:dynamodb:region:account-id:table/table-name,AwsDynamoDbTable,"If DynamoDB tables do not automatically scale capacity with demand, they may experience throttling exceptions, leading to reduced availability and performance of applications."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dynamodb/dynamodb_tables_kms_cmk_encryption_enabled/dynamodb_tables_kms_cmk_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/amazondynamodbdb/latest/developerguide/EncryptionAtRest.html,dynamodb,Check if DynamoDB table has encryption at rest enabled using CMK KMS.,['encryption'],Data Protection,Check if DynamoDB table has encryption at rest enabled using CMK KMS.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],dynamodb_tables_kms_cmk_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-dynamodb-tables-are-encrypted#terraform'}, 'Recommendation': {'Text': 'Specify an encryption key when you create a new table or switch the encryption keys on an existing table by using the AWS Management Console.', 'Url': 'https://docs.aws.amazon.com/amazondynamodbdb/latest/developerguide/EncryptionAtRest.html'}}",medium,[],arn:partition:dynamodb:region:account-id:table/resource-id,AwsDynamoDbTable,All user data stored in Amazon DynamoDB is fully encrypted at rest. This functionality helps reduce the operational burden and complexity involved in protecting sensitive data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/storagegateway/storagegateway_fileshare_encryption_enabled/storagegateway_fileshare_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/filegateway/latest/files3/encrypt-objects-stored-by-file-gateway-in-amazon-s3.html,storagegateway,"Ensure that Amazon Storage Gateway service is using AWS KMS Customer Master Keys (CMKs) instead of AWS managed-keys (i.e. default keys) for file share data encryption, in order to have a fine-grained control over data-at-rest encryption/decryption process and meet compliance requirements. An AWS Storage Gateway file share is a file system mount point backed by Amazon S3 cloud storage.",[],,Check if AWS StorageGateway File Shares are encrypted with KMS CMK.,,[],filegateway,['Security'],storagegateway_fileshare_encryption_enabled,"{'Code': {'CLI': 'aws storagegateway update-nfs-file-share --region us-east-1 --file-share-arn arn:aws:storagegateway:us-east-1:123456789012:share/share-abcd1234 --kms-encrypted --kms-key arn:aws:kms:us-east-1:123456789012:key/abcdabcd-1234-1234-1234-abcdabcdabcd', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/StorageGateway/file-shares-encrypted-with-cmk.html#', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that Amazon Storage Gateway service is using AWS KMS Customer Master Keys (CMKs).', 'Url': 'https://docs.aws.amazon.com/filegateway/latest/files3/encrypt-objects-stored-by-file-gateway-in-amazon-s3.html'}}",low,[],arn:aws:storagegateway:region:account-id:share,Other,This could provide an avenue for unauthorized access to your data by not having fine-grained control over data-at-rest encryption/decryption process and meet compliance requirements.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/storagegateway/storagegateway_gateway_fault_tolerant/storagegateway_gateway_fault_tolerant.metadata.json,,https://docs.aws.amazon.com/filegateway/latest/files3/disaster-recovery-resiliency.html,storagegateway,"Storage Gateway, when hosted on an EC2 environment, runs on a single EC2 instance. This is a single-point of failure for any applications expecting highly available access to application storage.",[],,Check if AWS StorageGateway Gateways are hosted in a fault-tolerant environment.,,[],,['Resilience'],storagegateway_gateway_fault_tolerant,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Migrating workloads to Amazon EFS, FSx, or other storage services can provide higher availability architectures if required.', 'Url': 'https://docs.aws.amazon.com/filegateway/latest/files3/resource-vm-setup.html'}}",low,[],arn:aws:storagegateway:region:account-id:share,Other,Running Storage Gateway as a mechanism for providing file-based application storage that require high-availability increases the risk of application outages if any AZ outages occur.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_set_no_assign_public_ip/ecs_task_set_no_assign_public_ip.metadata.json,,https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_TaskSet.html,ecs,This control checks whether an Amazon ECS task set is configured to automatically assign public IP addresses. The control fails if AssignPublicIP is set to ENABLED.,['internet-exposed'],,ECS task sets should not automatically assign public IP addresses,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecs_task_set_no_assign_public_ip,"{'Code': {'CLI': 'aws ecs update-service --cluster <cluster-name> --service <service-name> --network-configuration \'awsvpcConfiguration={assignPublicIp=""DISABLED""}\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-16', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure ECS task sets to not assign public IP addresses to prevent unintended public access to your containerized applications.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/update-task-definition-console-v2.html'}}",high,[],arn:aws:ecs:{region}:{account-id}:task-set/{cluster-name}/{service-name}/{task-set-id},AwsEcsTaskSet,"A public IP address is reachable from the internet, potentially exposing resources associated with the ECS task set. ECS task sets shouldn't be publicly accessible, as this may allow unintended access to container application servers."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_definitions_no_environment_secrets/ecs_task_definitions_no_environment_secrets.metadata.json,,,ecs,Check if secrets exists in ECS task definitions environment variables.,['secrets'],,Check if secrets exists in ECS task definitions environment variables,,[],,"['Protect', 'Secure development', 'Credentials not hard-coded']",ecs_task_definitions_no_environment_secrets,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use Secrets Manager or Parameter Store to securely provide credentials to containers without hardcoding the secrets in code or passing them through environment variables. It is currently not possible to delete task definition revisions which contain plaintext secrets. AWS is looking into implementing this feature in 2023, and it is therefore recommended that all plaintext secrets are rotated at the same time as moving the secrets to Secrets Manager or Parameter Store.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/specifying-sensitive-data.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEcsTaskDefinition,"The use of a hard-coded password increases the possibility of password guessing. If hard-coded passwords are used, it is possible that malicious users gain access through the account in question."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_definitions_host_networking_mode_users/ecs_task_definitions_host_networking_mode_users.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-task-definition-user-for-host-mode-check.html,ecs,"This control checks whether an active Amazon ECS task definition with host networking mode has privileged or user container definitions. The control fails for task definitions that have host network mode and container definitions of privileged=false or empty, and user=root or empty.",['trustboundaries'],,Amazon ECS task definitions should have secure networking modes and user definitions,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecs_task_definitions_host_networking_mode_users,"{'Code': {'CLI': 'aws ecs update-task-definition --task-definition <task-definition-name> --network-mode awsvpc --requires-compatibilities FARGATE --user <user-name>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure your ECS task definitions use the awsvpc networking mode and have secure user configurations when using host networking mode.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/update-task-definition-console-v2.html'}}",high,[],arn:aws:ecs:region:account-id:task-definition/resource-id,AwsEcsTaskDefinition,"If ECS tasks are configured with host networking and either lack a defined user or run with elevated privileges, this can lead to privilege escalation, unauthorized access to resources, and increased exposure to vulnerabilities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_service_no_assign_public_ip/ecs_service_no_assign_public_ip.metadata.json,,https://docs.aws.amazon.com/AmazonECS/latest/developerguide/Welcome.html,ecs,This control checks whether Amazon ECS services are configured to automatically assign public IP addresses. The control fails if AssignPublicIP is ENABLED and passes if it is DISABLED.,['internet-exposed'],,ECS services should not assign public IPs automatically,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecs_service_no_assign_public_ip,"{'Code': {'CLI': ""aws ecs update-service --cluster <cluster-name> --service <service-name> --network-configuration 'awsvpcConfiguration={assignPublicIp=DISABLED}'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Disable automatic public IP address assignment for your ECS services to ensure they are not publicly accessible.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/security.html'}}",high,[],arn:aws:ecs:{region}:{account-id}:service/{service-name},AwsEcsService,"Having public IP addresses assigned to ECS services automatically can expose services to the internet, increasing the risk of unauthorized access, data breaches, and cyberattacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_definitions_no_privileged_containers/ecs_task_definitions_no_privileged_containers.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-containers-nonprivileged.html,ecs,This control checks if the privileged parameter in the container definition of Amazon ECS Task Definitions is set to true. The control fails if this parameter is equal to true.,['vulnerabilities'],,ECS task definitions shouldn't have privileged containers,,[],taskDefinition,['Software and Configuration Checks/AWS Security Best Practices'],ecs_task_definitions_no_privileged_containers,"{'Code': {'CLI': 'aws ecs register-task-definition --family <task-family> --container-definitions \'[{""name"":""<container-name>"",""image"":""<image>"",""privileged"":false}]\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that containers are running without elevated privileges to minimize the risk of privilege escalation.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definition_parameters.html#container_definition_security'}}",high,[],arn:aws:ecs:{region}:{account-id}:task-definition/{task-definition-name},AwsEcsTaskDefinition,"Running containers with elevated privileges increases the risk of privilege escalation attacks, potentially allowing unauthorized access to the host and other containers."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_cluster_container_insights_enabled/ecs_cluster_container_insights_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-container-insights-enabled.html,ecs,This control checks if ECS clusters use Container Insights. This control fails if Container Insights are not set up for a cluster.,['logging'],,ECS clusters should use Container Insights,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecs_cluster_container_insights_enabled,"{'Code': {'CLI': 'aws ecs update-cluster-settings --cluster <cluster-name> --settings name=containerInsights,value=enabled', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-12', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Container Insights for your ECS clusters to collect and monitor key performance metrics and diagnostic data from your containers.', 'Url': 'https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/deploy-container-insights-ECS-cluster.html'}}",medium,[],arn:aws:ecs:{region}:{account-id}:cluster/{cluster-name},AwsEcsCluster,"Without Container Insights, important performance metrics and diagnostic information from containerized applications may not be captured, which can hinder monitoring and troubleshooting."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_definitions_containers_readonly_access/ecs_task_definitions_containers_readonly_access.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-containers-readonly-access.html,ecs,This control checks if Amazon ECS containers are limited to read-only access to mounted root filesystems. The control fails if the readonlyRootFilesystem parameter is set to false or if the parameter doesn't exist in the container definition.,['vulnerabilities'],,ECS containers should be limited to read-only access to root filesystems,,[],taskDefinition,['Software and Configuration Checks/AWS Security Best Practices'],ecs_task_definitions_containers_readonly_access,"{'Code': {'CLI': 'aws ecs register-task-definition --family <task-family> --container-definitions \'[{""name"":""<container-name>"",""image"":""<image>"",""readonlyRootFilesystem"":true}]\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-5', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that containers have read-only access to their root filesystems to limit write access and reduce the attack surface.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/userguide/task_definition_parameters.html#container_definition_readonly'}}",high,[],arn:aws:ecs:{region}:{account-id}:task-definition/{task-definition-name},AwsEcsTaskDefinition,"If ECS containers have write access to root filesystems, it increases the risk of filesystem tampering and exploitation of vulnerabilities, violating the principle of least privilege."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_definitions_host_namespace_not_shared/ecs_task_definitions_host_namespace_not_shared.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-task-definition-pid-mode-check.html,ecs,This control checks if Amazon ECS task definitions are configured to share a host's process namespace with its containers. The control fails if the task definition shares the host's process namespace.,['vulnerabilities'],,ECS task definitions should not share the host's process namespace,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecs_task_definitions_host_namespace_not_shared,"{'Code': {'CLI': 'aws ecs register-task-definition --family <task-family> --container-definitions \'[{""name"":""<container-name>"",""image"":""<image>"",""pidMode"":""task""}]\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-3', 'Terraform': ''}, 'Recommendation': {'Text': ""Avoid sharing the host's process namespace with containers to maintain process isolation and enhance security."", 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/userguide/task_definition_parameters.html#container_definition_pid_mode'}}",high,[],arn:aws:ecs:{region}:{account-id}:task-definition/{task-definition-name},AwsEcsTaskDefinition,"Sharing the host's process namespace with containers exposes host processes, potentially allowing unauthorized access or manipulation of host-level processes, undermining container isolation."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_definitions_logging_block_mode/ecs_task_definitions_logging_block_mode.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-task-definition-log-configuration.html,ecs,This control checks if the latest active Amazon ECS task definition has a logging configuration set to non blocking mode.,['logging'],,ECS task definitions containers should have a logging configured with non blocking mode,,[],,['Resilience'],ecs_task_definitions_logging_block_mode,"{'Code': {'CLI': 'aws ecs register-task-definition --family <task-family> --container-definitions \'[{""name"":""<container-name>"",""image"":""<image>"",""logConfiguration"":{""logDriver"":""awslogs"",""options"":{""awslogs-group"":""<log-group>"",""awslogs-region"":""<region>"",""awslogs-stream-prefix"":""ecs"",""mode"":""non-blocking""}}}]\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/awssupport/latest/user/fault-tolerance-checks.html#amazon-ec2-awslogs-driver-blockingmode', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure logging in ECS task definition to non blocking mode to ensure any issues writing logs will not block or halt the container execution.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/using_awslogs.html#specify-log-config'}}",low,[],arn:aws:ecs:{region}:{account-id}:task-definition/{task-definition-name},AwsEcsTaskDefinition,"When logs cannot be immediately sent to Amazon CloudWatch, calls from container code to write to stdout or stderr will block and halt execution of the code. The logging thread in the application will block, which may prevent the application from functioning and lead to health check failures and task termination. Container startup fails if the required log group or log stream cannot be created."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_task_definitions_logging_enabled/ecs_task_definitions_logging_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-task-definition-log-configuration.html,ecs,This control checks if the latest active Amazon ECS task definition has a logging configuration specified. The control fails if the task definition doesn't have the logConfiguration property defined or if the value for logDriver is null in at least one container definition.,['logging'],,ECS task definitions containers should have a logging configuration,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecs_task_definitions_logging_enabled,"{'Code': {'CLI': 'aws ecs register-task-definition --family <task-family> --container-definitions \'[{""name"":""<container-name>"",""image"":""<image>"",""logConfiguration"":{""logDriver"":""awslogs"",""options"":{""awslogs-group"":""<log-group>"",""awslogs-region"":""<region>"",""awslogs-stream-prefix"":""ecs""}}}]\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-9', 'Terraform': ''}, 'Recommendation': {'Text': 'Define a logging configuration in the ECS task definition to ensure important data is captured and available for debugging, monitoring, and auditing purposes.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/using_awslogs.html#specify-log-config'}}",high,[],arn:aws:ecs:{region}:{account-id}:task-definition/{task-definition-name},AwsEcsTaskDefinition,"Without a logging configuration, important data may be lost, making it difficult to troubleshoot issues, monitor performance, and ensure compliance with auditing requirements."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ecs/ecs_service_fargate_latest_platform_version/ecs_service_fargate_latest_platform_version.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ecs-fargate-latest-platform-version.html,ecs,This control checks if Amazon ECS Fargate services are running the latest Fargate platform version. The control fails if the platform version is not the latest.,['vulnerabilities'],,ECS Fargate services should run on the latest Fargate platform version,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ecs_service_fargate_latest_platform_version,"{'Code': {'CLI': 'aws ecs update-service --cluster <cluster-name> --service <service-name> --platform-version LATEST', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ecs-controls.html#ecs-10', 'Terraform': ''}, 'Recommendation': {'Text': 'Update your ECS Fargate services to the latest platform version to ensure they are running in a secure and optimized environment.', 'Url': 'https://docs.aws.amazon.com/AmazonECS/latest/developerguide/Welcome.html'}}",medium,[],arn:aws:ecs:{region}:{account-id}:service/{service-name},AwsEcsService,Not running the latest Fargate platform version may expose your services to security vulnerabilities and bugs that are resolved in newer versions.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directoryservice/directoryservice_directory_log_forwarding_enabled/directoryservice_directory_log_forwarding_enabled.metadata.json,,https://docs.aws.amazon.com/directoryservice/latest/admin-guide/incident-response.html,directoryservice,Directory Service monitoring with CloudWatch logs.,['logging'],,Directory Service monitoring with CloudWatch logs.,,[],,[],directoryservice_directory_log_forwarding_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'It is recommended that that the export of logs is enabled.', 'Url': 'https://docs.aws.amazon.com/directoryservice/latest/admin-guide/incident-response.html'}}",medium,[],arn:partition:codeartifact:region:account-id:directory/directory-id,Other,"As a best practice, monitor your organization to ensure that changes are logged. This helps you to ensure that any unexpected change can be investigated and unwanted changes can be rolled back."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directoryservice/directoryservice_supported_mfa_radius_enabled/directoryservice_supported_mfa_radius_enabled.metadata.json,,https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_mfa.html,directoryservice,Ensure Multi-Factor Authentication (MFA) using Radius Server is enabled in DS.,[],,Ensure Multi-Factor Authentication (MFA) using Radius Server is enabled in DS.,,[],,[],directoryservice_supported_mfa_radius_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enabling MFA provides increased security to a user name and password as it requires the user to possess a solution that displays a time-sensitive authentication code.', 'Url': 'https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_mfa.html'}}",medium,[],arn:partition:codeartifact:region:account-id:directory/directory-id,Other,Multi-Factor Authentication (MFA) adds an extra layer of authentication assurance beyond traditional username and password.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directoryservice/directoryservice_directory_monitor_notifications/directoryservice_directory_monitor_notifications.metadata.json,,https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_enable_notifications.html,directoryservice,Directory Service has SNS Notifications enabled.,[],,Directory Service has SNS Notifications enabled.,,[],,[],directoryservice_directory_monitor_notifications,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'It is recommended set up SNS messaging to send email or text messages when the status of your directory changes.', 'Url': 'https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_enable_notifications.html'}}",medium,[],arn:partition:codeartifact:region:account-id:directory/directory-id,Other,"As a best practice, monitor status of Directory Service. This helps to avoid late actions to fix Directory Service issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directoryservice/directoryservice_radius_server_security_protocol/directoryservice_radius_server_security_protocol.metadata.json,,https://aws.amazon.com/blogs/security/how-to-enable-multi-factor-authentication-for-amazon-workspaces-and-amazon-quicksight-by-using-microsoft-ad-and-on-premises-credentials/,directoryservice,Ensure Radius server in DS is using the recommended security protocol.,[],,Ensure Radius server in DS is using the recommended security protocol.,,[],,[],directoryservice_radius_server_security_protocol,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'MS-CHAPv2 provides the strongest security of the options supported, and is therefore recommended.', 'Url': 'https://aws.amazon.com/blogs/security/how-to-enable-multi-factor-authentication-for-amazon-workspaces-and-amazon-quicksight-by-using-microsoft-ad-and-on-premises-credentials/'}}",medium,[],arn:partition:codeartifact:region:account-id:directory/directory-id,Other,"As a best practice, you might need to configure the authentication protocol between the Microsoft AD DCs and the RADIUS/MFA server. Supported protocols are PAP, CHAP MS-CHAPv1, and MS-CHAPv2. MS-CHAPv2 is recommended because it provides the strongest security of the three options."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directoryservice/directoryservice_directory_snapshots_limit/directoryservice_directory_snapshots_limit.metadata.json,,https://docs.aws.amazon.com/general/latest/gr/ds_region.html,directoryservice,Directory Service Manual Snapshots limit reached.,[],,Directory Service Manual Snapshots limit reached.,,[],,[],directoryservice_directory_snapshots_limit,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Monitor manual snapshots limit to ensure capacity when you need it.', 'Url': 'https://docs.aws.amazon.com/general/latest/gr/ds_region.html'}}",low,[],arn:partition:codeartifact:region:account-id:directory/directory-id,Other,A limit reached can bring unwanted results. The maximum number of manual snapshots is a hard limit.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directoryservice/directoryservice_ldap_certificate_expiration/directoryservice_ldap_certificate_expiration.metadata.json,,https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_ldap.html,directoryservice,Directory Service Manual Snapshots limit reached.,[],,Directory Service LDAP Certificates expiration.,,[],,[],directoryservice_ldap_certificate_expiration,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Monitor certificate expiration and take automated action to alarm responsible team for taking care of the replacement or remove.', 'Url': 'https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_ldap.html'}}",medium,[],arn:partition:codeartifact:region:account-id:directory/directory-id,Other,Expired certificates can impact service availability.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/workspaces/workspaces_vpc_2private_1public_subnets_nat/workspaces_vpc_2private_1public_subnets_nat.metadata.json,,https://docs.aws.amazon.com/workspaces/latest/adminguide/amazon-workspaces-vpc.html,workspaces,Ensure that the Workspaces VPC are deployed following the best practices using 1 public subnet and 2 private subnets with a NAT Gateway attached,[],,Ensure that the Workspaces VPC are deployed following the best practices using 1 public subnet and 2 private subnets with a NAT Gateway attached,,[],,[],workspaces_vpc_2private_1public_subnets_nat,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Follow the documentation and deploy Workspaces VPC using 1 public subnet and 2 private subnets with a NAT Gateway attached', 'Url': 'https://docs.aws.amazon.com/workspaces/latest/adminguide/amazon-workspaces-vpc.html'}}",medium,[],arn:aws:workspaces:region:account-id:workspace,AwsWorkSpacesWorkspace,Proper network segmentation is a key security best practice. Workspaces VPC should be deployed using 1 public subnet and 2 private subnets with a NAT Gateway attached
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/workspaces/workspaces_volume_encryption_enabled/workspaces_volume_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/workspaces/latest/adminguide/encrypt-workspaces.html,workspaces,Ensure that your Amazon WorkSpaces storage volumes are encrypted in order to meet security and compliance requirements,['encryption'],,Ensure that your Amazon WorkSpaces storage volumes are encrypted in order to meet security and compliance requirements,,[],,[],workspaces_volume_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-workspace-root-volumes-are-encrypted#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/WorkSpaces/storage-encryption.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-workspace-root-volumes-are-encrypted#terraform'}, 'Recommendation': {'Text': 'WorkSpaces is integrated with the AWS Key Management Service (AWS KMS). This enables you to encrypt storage volumes of WorkSpaces using AWS KMS Key. When you launch a WorkSpace you can encrypt the root volume (for Microsoft Windows - the C drive, for Linux - /) and the user volume (for Windows - the D drive, for Linux - /home). Doing so ensures that the data stored at rest - disk I/O to the volume - and snapshots created from the volumes are all encrypted', 'Url': 'https://docs.aws.amazon.com/workspaces/latest/adminguide/encrypt-workspaces.html'}}",high,[],arn:aws:workspaces:region:account-id:workspace,AwsWorkSpacesWorkspace,If the value listed in the Volume Encryption column is Disabled the selected AWS WorkSpaces instance volumes (root and user volumes) are not encrypted. Therefore your data-at-rest is not protected from unauthorized access and does not meet the compliance requirements regarding data encryption.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/fsx/fsx_file_system_copy_tags_to_backups_enabled/fsx_file_system_copy_tags_to_backups_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/fsx-lustre-copy-tags-to-backups.html,fsx,Check if an Amazon FSx file system is configured to copy tags to backups. The control fails if this configuration isn't enabled.,[],,Check if FSx file systems are configured to copy tags to backups.,,[],,['Software and Configuration Checks/Vulnerabilities'],fsx_file_system_copy_tags_to_backups_enabled,"{'Code': {'CLI': 'aws fsx update-file-system --file-system-id <file-system-id> --open-zfs-configuration CopyTagsToBackups=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/fsx-controls.html#fsx-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure your FSx file system to copy tags to backups to improve resource management and tracking.', 'Url': 'https://docs.aws.amazon.com/fsx/latest/OpenZFSGuide/updating-file-system.html'}}",low,[],arn:aws:fsx:{region}:{account-id}:file-system/{file-system-id},AwsFSxFileSystem,"Without tag copying, managing and tracking your resources could be more difficult, impacting your governance and inventory management processes."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/fsx/fsx_file_system_copy_tags_to_volumes_enabled/fsx_file_system_copy_tags_to_volumes_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/fsx-openzfs-copy-tags-enabled.html,fsx,Check if an Amazon FSx file system is configured to copy tags to volumes. The control fails if this configuration isn't enabled.,[],,Check if FSx file systems are configured to copy tags to volumes.,,[],,['Software and Configuration Checks/Vulnerabilities'],fsx_file_system_copy_tags_to_volumes_enabled,"{'Code': {'CLI': 'aws fsx update-file-system --file-system-id <file-system-id> --open-zfs-configuration CopyTagsToVolumes=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/fsx-controls.html#fsx-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure your FSx file system to copy tags to volumes to improve resource management and tracking.', 'Url': 'https://docs.aws.amazon.com/fsx/latest/OpenZFSGuide/updating-file-system.html'}}",low,[],arn:aws:fsx:{region}:{account-id}:file-system/{file-system-id},AwsFSxFileSystem,"Without tag copying, managing and tracking your resources could be more difficult, impacting your governance and inventory management processes."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/fsx/fsx_windows_file_system_multi_az_enabled/fsx_windows_file_system_multi_az_enabled.metadata.json,,https://docs.aws.amazon.com/fsx/latest/WindowsGuide/high-availability-multiAZ.html,fsx,Check if FSx Windows file systems are configured with Multi-AZ. The control fails if this configuration isn't enabled.,['redundancy'],,Check if FSx Windows file systems are configured with Multi-AZ.,,[],,[],fsx_windows_file_system_multi_az_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure your FSx Windows file system to be highly available with ENIs in Multiple AZs.', 'Url': 'https://docs.aws.amazon.com/fsx/latest/WindowsGuide/high-availability-multiAZ.html'}}",low,[],arn:aws:fsx:{region}:{account-id}:file-system/{file-system-id},AwsFSxFileSystem,"Relative to Single-AZ deployment, Multi-AZ deployments provide enhanced durability by further replicating data across AZs, and enhanced availability during planned system maintenance and unplanned service disruption by failing over automatically to the standby AZ. This allows you to continue accessing your data, and helps to protect your data against instance failure and AZ disruption."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_logging_enabled/elb_logging_enabled.metadata.json,,,elb,Check if Elastic Load Balancers have logging enabled.,"['forensics-ready', 'logging']",,Check if Elastic Load Balancers have logging enabled.,,[],,['Logging and Monitoring'],elb_logging_enabled,"{'Code': {'CLI': ""aws elb modify-load-balancer-attributes --load-balancer-name <lb_name> --load-balancer-attributes '{AccessLog:{Enabled:true,EmitInterval:60,S3BucketName:<bucket_name>}}'"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_23#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-access-log.html', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_23#terraform'}, 'Recommendation': {'Text': 'Enable ELB logging, create a log lifecycle and define use cases.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/access-log-collection.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbLoadBalancer,If logs are not enabled monitoring of service use and threat analysis is not possible.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_insecure_ssl_ciphers/elb_insecure_ssl_ciphers.metadata.json,,,elb,Check if Elastic Load Balancers have insecure SSL ciphers.,['encryption'],,Check if Elastic Load Balancers have insecure SSL ciphers.,,[],,['Data Protection'],elb_insecure_ssl_ciphers,"{'Code': {'CLI': 'aws elb set-load-balancer-policies-of-listener --load-balancer-name <lb_name> --load-balancer-port 443 --policy-names ELBSecurityPolicy-TLS-1-2-2017-01', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-security-policy.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_43#terraform'}, 'Recommendation': {'Text': 'Use a Security policy with ciphers that are as strong as possible. Drop legacy and insecure ciphers.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html#describe-ssl-policies'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbLoadBalancer,Using insecure ciphers could affect privacy of in transit information.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_ssl_listeners/elb_ssl_listeners.metadata.json,,,elb,Check if Elastic Load Balancers have SSL listeners.,['encryption'],,Check if Elastic Load Balancers have SSL listeners.,,[],,['Data Protection'],elb_ssl_listeners,"{'Code': {'CLI': 'aws elb create-load-balancer-listeners --load-balancer-name <lb_name> --listeners Protocol=HTTPS, LoadBalancerPort=443, InstanceProtocol=HTTP, InstancePort=80, SSLCertificateId=<certificate_arn>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-listener-security.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Scan for Load Balancers with HTTP or TCP listeners and understand the reason for each of them. Check if the listener can be implemented as TLS instead..', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbLoadBalancer,Clear text communication could affect privacy of information in transit.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_is_in_multiple_az/elb_is_in_multiple_az.metadata.json,,https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/introduction.html#classic-load-balancer-overview,elb,"This check ensures that a Classic Load Balancer is configured to span at least the specified number of Availability Zones (AZs). The control fails if the Load Balancer does not span multiple AZs, which can lead to decreased availability and reliability in case of an AZ failure.",['redundancy'],,Ensure Classic Load Balancer is Configured Across Multiple Availability Zones,,[],,[],elb_is_in_multiple_az,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-10', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/ec2-instances-distribution-across-availability-zones.html'}, 'Recommendation': {'Text': 'Distribute your Classic Load Balancer across multiple Availability Zones to improve redundancy and fault tolerance.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-disable-crosszone-lb.html'}}",medium,[],arn:<partition>:elasticloadbalancing:<region>:<account-id>:loadbalancer/<load-balancer-name>,AwsElbLoadBalancer,"A Classic Load Balancer configured in a single Availability Zone risks becoming a single point of failure. If the AZ fails, the load balancer will not be able to redirect traffic to other healthy targets, leading to potential service outages."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_ssl_listeners_use_acm_certificate/elb_ssl_listeners_use_acm_certificate.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/elb-acm-certificate-required.html,elb,This control checks whether the Classic Load Balancer uses HTTPS/SSL certificates provided by AWS Certificate Manager (ACM). The control fails if the Classic Load Balancer does not use a certificate provided by ACM.,['encryption'],,Check if Classic Load Balancers with SSL/HTTPS listeners use a certificate provided by AWS Certificate Manager (ACM).,,[],,['Software and Configuration Checks/Vulnerabilities/NIST 800-53 Controls (USA)'],elb_ssl_listeners_use_acm_certificate,"{'Code': {'CLI': 'aws elb set-load-balancer-listener-ssl-certificate --load-balancer-name <load-balancer-name> --load-balancer-port <port> --ssl-certificate-id <certificate-id>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Use AWS Certificate Manager (ACM) to manage SSL/TLS certificates for your Classic Load Balancer to ensure secure encryption of data in transit.', 'Url': 'https://repost.aws/es/knowledge-center/associate-acm-certificate-alb-nlb'}}",medium,[],arn:aws:elasticloadbalancing:{region}:{account-id}:loadbalancer/{loadbalancer-name},AwsElbLoadBalancer,"If Classic Load Balancers are not using ACM certificates, it increases the risk of using self-signed or expired certificates, which can impact secure communication and lead to compliance issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_connection_draining_enabled/elb_connection_draining_enabled.metadata.json,,https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-conn-drain.html,elb,"Checks if connection draining is enabled for Classic Load Balancers. Connection draining ensures that the load balancer stops sending requests to instances that are de-registering or unhealthy, while keeping existing connections open. This is particularly useful for instances in Auto Scaling groups, to ensure that connections aren't severed abruptly.",[],,Classic Load Balancer Connection Draining Enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices/Network Reachability'],elb_connection_draining_enabled,"{'Code': {'CLI': ""aws elb modify-load-balancer-attributes --load-balancer-name <my_load_balancer_name> --load-balancer-attributes '{'ConnectionDraining':{'Enabled':true,'Timeout':300}}'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-7', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-connection-draining-enabled.html#'}, 'Recommendation': {'Text': 'Enable connection draining for all Classic Load Balancers. This ensures that existing connections are not abruptly terminated when instances are removed from the load balancer.', 'Url': ''}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbLoadBalancer,"Disabling connection draining can lead to abrupt connection termination for users, impacting the user experience and potentially causing application errors."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_cross_zone_load_balancing_enabled/elb_cross_zone_load_balancing_enabled.metadata.json,,https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-disable-crosszone-lb.html,elb,"Checks whether cross-zone load balancing is enabled for Classic Load Balancers (CLBs). Cross-zone load balancing ensures even distribution of traffic across all registered targets in all Availability Zones, improving fault tolerance and load distribution.",[],,Ensure Cross-Zone Load Balancing is Enabled for Classic Load Balancers (CLBs),,[],,[],elb_cross_zone_load_balancing_enabled,"{'Code': {'CLI': 'aws elb modify-load-balancer-attributes --load-balancer-name <load-balancer-name> --load-balancer-attributes ""CrossZoneLoadBalancing={Enabled=true}""', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-9', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/elb-cross-zone-load-balancing-enabled.html'}, 'Recommendation': {'Text': 'Enable cross-zone load balancing for Classic Load Balancers to ensure even traffic distribution and enhance fault tolerance across Availability Zones.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-disable-crosszone-lb.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbLoadBalancer,"If cross-zone load balancing is not enabled, traffic may not be evenly distributed across Availability Zones, leading to over-utilization of resources in certain zones and potential application performance degradation or outages."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_internet_facing/elb_internet_facing.metadata.json,,,elb,Check for internet facing Elastic Load Balancers.,[],,Check for internet facing Elastic Load Balancers.,,[],,['Data Protection'],elb_internet_facing,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELB/internet-facing-load-balancers.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure the load balancer should be publicly accessible. If publicly exposed ensure a WAF ACL is implemented.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbLoadBalancer,Publicly accessible load balancers could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elb/elb_desync_mitigation_mode/elb_desync_mitigation_mode.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/clb-desync-mode-check.html,elb,This control checks whether a Classic Load Balancer is configured with defensive or strictest desync mitigation mode. The control fails if the Classic Load Balancer isn't configured with defensive or strictest desync mitigation mode.,[],,Classic Load Balancer should be configured with defensive or strictest desync mitigation mode,,[],,['Software and Configuration Checks/AWS Security Best Practices'],elb_desync_mitigation_mode,"{'Code': {'CLI': 'aws elb modify-load-balancer-attributes --load-balancer-name <load-balancer-name> --load-balancer-attributes \'{""DesyncMitigationMode"":""defensive""}\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-14', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure the Classic Load Balancer with defensive or strictest desync mitigation mode to prevent security issues caused by HTTP desync.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-desync-mitigation-mode.html#update-desync-mitigation-mode'}}",medium,[],arn:aws:elasticloadbalancing:{region}:{account-id}:loadbalancer/{load-balancer-name},AwsElbLoadBalancer,"HTTP Desync issues can lead to request smuggling, making applications vulnerable to attacks such as request queue or cache poisoning, which could result in credential hijacking or unauthorized command execution."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sqs/sqs_queues_not_publicly_accessible/sqs_queues_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-basic-examples-of-sqs-policies.html,sqs,Check if SQS queues have policy set as Public,['internet-exposed'],,Check if SQS queues have policy set as Public,,[],,[],sqs_queues_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SQS/sqs-queue-exposed.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it#terraform'}, 'Recommendation': {'Text': 'Review service with overly permissive policies. Adhere to Principle of Least Privilege.', 'Url': 'https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-basic-examples-of-sqs-policies.html'}}",critical,[],arn:aws:sqs:region:account-id:queue,AwsSqsQueue,Sensitive information could be disclosed
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sqs/sqs_queues_server_side_encryption_enabled/sqs_queues_server_side_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-configure-sse-existing-queue.html,sqs,Check if SQS queues have Server Side Encryption enabled,['encryption'],,Check if SQS queues have Server Side Encryption enabled,,[],,[],sqs_queues_server_side_encryption_enabled,"{'Code': {'CLI': 'aws sqs set-queue-attributes --queue-url <QUEUE_URL> --attributes KmsMasterKeyId=<KEY>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_16-encrypt-sqs-queue#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SQS/queue-encrypted-with-kms-customer-master-keys.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_16-encrypt-sqs-queue#terraform'}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits', 'Url': 'https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-configure-sse-existing-queue.html'}}",medium,[],arn:aws:sqs:region:account-id:queue,AwsSqsQueue,If not enabled sensitive information in transit is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/wellarchitected/wellarchitected_workload_no_high_or_medium_risks/wellarchitected_workload_no_high_or_medium_risks.metadata.json,,https://aws.amazon.com/architecture/well-architected/,wellarchitected,"The Well-Architected Tool uses the AWS Well-Architected Framework to compare your cloud workloads against best practices across five architectural pillars: security, reliability, performance efficiency, operational excellence, and cost optimization",[],,Check for medium and high risks identified in workloads defined in the AWS Well-Architected Tool.,,[],,[],wellarchitected_workload_no_high_or_medium_risks,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/WellArchitected/findings.html', 'Terraform': ''}, 'Recommendation': {'Text': 'With the AWS Well-Architected Tool tool, you can analyze your workloads using a consistent process, pinpoint any medium or high-risk issues, and identify the next steps that must be taken for improvement', 'Url': 'https://aws.amazon.com/architecture/well-architected/'}}",medium,[],arn:aws:wellarchitected:region:account-id:workload/workload-id,Other,A given workload can have medium and/or high risks that have been identified based on answers provided to the questions in the Well-Architected Tool. These issues are architectural and operational choices that are not aligned with the best practices from the Well-Architected Framework
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/bedrock/bedrock_model_invocation_logs_encryption_enabled/bedrock_model_invocation_logs_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/bedrock/latest/userguide/data-protection.html,bedrock,Ensure that Amazon Bedrock model invocation logs are encrypted using AWS KMS to protect sensitive data in the request and response logs for all model invocations.,"['encryption', 'logging', 'gen-ai']",,Ensure that Amazon Bedrock model invocation logs are encrypted with KMS.,,[],,[],bedrock_model_invocation_logs_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that model invocation logs for Amazon Bedrock are encrypted using AWS KMS to prevent unauthorized access to sensitive log data.', 'Url': 'hhttps://docs.aws.amazon.com/bedrock/latest/userguide/data-protection.html'}}",high,[],arn:partition:bedrock:region:account-id:model/resource-id,Other,"If Amazon Bedrock model invocation logs are not encrypted, sensitive data such as prompts, responses, and token usage could be exposed to unauthorized parties. This may lead to data breaches, security vulnerabilities, or unintended use of sensitive information."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/bedrock/bedrock_guardrail_prompt_attack_filter_enabled/bedrock_guardrail_prompt_attack_filter_enabled.metadata.json,,https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails.html,bedrock,Ensure that prompt attack filter strength is set to HIGH for Amazon Bedrock guardrails to mitigate prompt injection and bypass techniques.,['gen-ai'],Ensure that prompt attack protection is set to the highest strength to minimize the risk of prompt injection attacks.,Configure Prompt Attack Filter with the highest strength for Amazon Bedrock Guardrails.,,[],,[],bedrock_guardrail_prompt_attack_filter_enabled,"{'Code': {'CLI': ""aws bedrock put-guardrails-configuration --guardrails-config 'promptAttackStrength=HIGH'"", 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Bedrock/prompt-attack-strength.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Set the prompt attack filter strength to HIGH for Amazon Bedrock guardrails to prevent prompt injection attacks and ensure robust protection against content manipulation.', 'Url': 'https://docs.aws.amazon.com/bedrock/latest/userguide/prompt-injection.html'}}",high,[],arn:partition:bedrock:region:account-id:guardrails/resource-id,Other,"If prompt attack filter strength is not set to HIGH, Bedrock models may be more vulnerable to prompt injection attacks or jailbreak attempts, which could allow harmful or sensitive content to bypass filters and reach end users."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/bedrock/bedrock_agent_guardrail_enabled/bedrock_agent_guardrail_enabled.metadata.json,,https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails.html,bedrock,This check ensures that Guardrails are enabled to protect Amazon Bedrock agent sessions. Guardrails help mitigate security risks by filtering and blocking harmful or sensitive content during interactions with AI models.,['gen-ai'],,Ensure that Guardrails are enabled for Amazon Bedrock agent sessions.,,[],,[],bedrock_agent_guardrail_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Bedrock/protect-agent-sessions-with-guardrails.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Guardrails for Amazon Bedrock agent sessions to protect against harmful inputs and outputs during interactions.', 'Url': 'https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-create.html'}}",high,[],arn:partition:bedrock:region:account-id:agent/resource-id,Other,"Without guardrails enabled, Amazon Bedrock agent sessions are vulnerable to harmful prompts or inputs that could expose sensitive information or generate inappropriate content. This could lead to privacy violations, data leaks, or other security risks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/bedrock/bedrock_model_invocation_logging_enabled/bedrock_model_invocation_logging_enabled.metadata.json,,https://docs.aws.amazon.com/bedrock/latest/userguide/model-invocation-logging.html,bedrock,"Ensure that model invocation logging is enabled for Amazon Bedrock service in order to collect metadata, requests, and responses for all model invocations in your AWS cloud account.","['logging', 'forensics-ready', 'gen-ai']",,Ensure that model invocation logging is enabled for Amazon Bedrock.,,[],,[],bedrock_model_invocation_logging_enabled,"{'Code': {'CLI': ""aws bedrock put-model-invocation-logging-configuration --logging-config 's3Config={bucketName='tm-bedrock-logging-data',keyPrefix='invocation-logs'},textDataDeliveryEnabled=true,imageDataDeliveryEnabled=true,embeddingDataDeliveryEnabled=true'"", 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Bedrock/enable-model-invocation-logging.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable model invocation logging for Amazon Bedrock service in order to collect metadata, requests, and responses for all model invocations in your AWS cloud account.', 'Url': 'https://docs.aws.amazon.com/bedrock/latest/userguide/model-invocation-logging.html#model-invocation-logging-console'}}",medium,[],arn:partition:bedrock:region:account-id:model/resource-id,Other,"In Amazon Bedrock, model invocation logging enables you to collect the invocation request and response data, along with metadata, for all 'Converse', 'ConverseStream', 'InvokeModel', and 'InvokeModelWithResponseStream' API calls in your AWS account. Each log entry includes important details such as the timestamp, request ID, model ID, and token usage. Invocation logs can be utilized for troubleshooting, performance enhancements, abuse detection, and security auditing. By default, model invocation logging is disabled."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/bedrock/bedrock_guardrail_sensitive_information_filter_enabled/bedrock_guardrail_sensitive_information_filter_enabled.metadata.json,,https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails.html,bedrock,"Ensure that sensitive information filters are enabled for Amazon Bedrock guardrails to prevent the leakage of sensitive data such as personally identifiable information (PII), financial data, or confidential corporate information.",['gen-ai'],,Configure Sensitive Information Filters for Amazon Bedrock Guardrails.,,[],,[],bedrock_guardrail_sensitive_information_filter_enabled,"{'Code': {'CLI': ""aws bedrock put-guardrails-configuration --guardrails-config 'sensitiveInformationFilter=true'"", 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Bedrock/guardrails-with-pii-mask-block.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable sensitive information filters for Amazon Bedrock guardrails to prevent the exposure of sensitive or confidential information.', 'Url': 'https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html'}}",high,[],arn:partition:bedrock:region:account-id:guardrails/resource-id,Other,"If sensitive information filters are not enabled, Bedrock models may inadvertently generate or expose confidential or sensitive information in responses, leading to data breaches, regulatory violations, or reputational damage."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_non_default_username/redshift_cluster_non_default_username.metadata.json,,https://docs.aws.amazon.com/redshift/latest/gsg/rs-gsg-prereq.html,redshift,This control checks whether an Amazon Redshift cluster has changed the admin username from its default value. The control fails if the admin username is set to 'awsuser'.,[],,Check if Amazon Redshift clusters are using the default Admin username.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],redshift_cluster_non_default_username,"{'Code': {'CLI': 'aws redshift create-cluster --cluster-identifier <cluster-id> --master-username <new-username> --master-user-password <password>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-8', 'Terraform': ''}, 'Recommendation': {'Text': 'Change the default admin username by creating a new Redshift cluster with a unique admin username.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Redshift/master-username.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster/cluster-name,AwsRedshiftCluster,"Using the default admin username increases the risk of unauthorized access, as default credentials are publicly known and often targeted by attackers."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_audit_logging/redshift_cluster_audit_logging.metadata.json,,https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html,redshift,Check if Redshift cluster has audit logging enabled,"['forensics-ready', 'logging']",,Check if Redshift cluster has audit logging enabled,,[],,[],redshift_cluster_audit_logging,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_12#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_12', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_12#terraform'}, 'Recommendation': {'Text': 'Enable logs. Create an S3 lifecycle policy. Define use cases, metrics and automated responses where applicable.', 'Url': 'https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster:cluster-name,AwsRedshiftCluster,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_encrypted_at_rest/redshift_cluster_encrypted_at_rest.metadata.json,,https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-db-encryption.html,redshift,This control checks whether Amazon Redshift clusters are encrypted at rest. The control fails if a Redshift cluster isn't encrypted at rest.,['encryption'],,Check if Redshift clusters are encrypted at rest.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],redshift_cluster_encrypted_at_rest,"{'Code': {'CLI': 'aws redshift modify-cluster --cluster-identifier <cluster-id> --encrypted --kms-key-id <key-id>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-10', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable encryption at rest for your Redshift clusters using KMS to protect sensitive data from unauthorized access.', 'Url': 'https://docs.aws.amazon.com/redshift/latest/mgmt/changing-cluster-encryption.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster/cluster-name,AwsRedshiftCluster,"Without encryption at rest, sensitive data stored in Redshift clusters is vulnerable to unauthorized access, which could lead to data breaches and regulatory non-compliance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_enhanced_vpc_routing/redshift_cluster_enhanced_vpc_routing.metadata.json,,https://docs.aws.amazon.com/redshift/latest/mgmt/enhanced-vpc-enabling-cluster.html,redshift,"This control checks whether an Amazon Redshift cluster has EnhancedVpcRouting enabled. Enhanced VPC routing forces all COPY and UNLOAD traffic between the cluster and data repositories to go through your VPC, allowing you to use VPC security features such as security groups and network access control lists.",['trustboundaries'],,Check if Redshift clusters are using enhanced VPC routing.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],redshift_cluster_enhanced_vpc_routing,"{'Code': {'CLI': 'aws redshift modify-cluster --cluster-identifier <cluster-id> --enhanced-vpc-routing', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-7', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable enhanced VPC routing for your Redshift clusters to enforce network traffic through your VPC and apply additional security controls.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Redshift/enable-enhanced-vpc-routing.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster/cluster-name,AwsRedshiftCluster,"Without enhanced VPC routing, network traffic between the Redshift cluster and data repositories might bypass VPC-level security controls, increasing the risk of unauthorized access or data exfiltration."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_public_access/redshift_cluster_public_access.metadata.json,,https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html,redshift,Check for Publicly Accessible Redshift Clusters,['internet-exposed'],,Check for Publicly Accessible Redshift Clusters,,[],,[],redshift_cluster_public_access,"{'Code': {'CLI': 'aws redshift modify-cluster --cluster-identifier <CLUSTER_ID> --no-publicly-accessible', 'NativeIaC': 'https://docs.prowler.com/checks/aws/public-policies/public_9#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/public-policies/public_9', 'Terraform': 'https://docs.prowler.com/checks/aws/public-policies/public_9#terraform'}, 'Recommendation': {'Text': 'List all shared Redshift clusters and make sure there is a business reason for them.', 'Url': 'https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html'}}",high,[],arn:aws:redshift:region:account-id:cluster:cluster-name,AwsRedshiftCluster,Publicly accessible services could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_automatic_upgrades/redshift_cluster_automatic_upgrades.metadata.json,,https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-operations.html,redshift,Check for Redshift Automatic Version Upgrade,[],,Check for Redshift Automatic Version Upgrade,,[],,[],redshift_cluster_automatic_upgrades,"{'Code': {'CLI': 'aws redshift modify-cluster --cluster-identifier <cluster_id> --allow-version-upgrade', 'NativeIaC': 'https://docs.prowler.com/checks/aws/public-policies/public_9#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-redshift-clusters-allow-version-upgrade-by-default#terraform'}, 'Recommendation': {'Text': 'Enabled AutomaticVersionUpgrade on Redshift Cluster', 'Url': 'https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-operations.html'}}",high,[],arn:aws:redshift:region:account-id:cluster:cluster-name,AwsRedshiftCluster,"Without automatic version upgrade enabled, a critical Redshift Cluster version can become severly out of date"
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_multi_az_enabled/redshift_cluster_multi_az_enabled.metadata.json,,https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-multi-az.html,redshift,This control checks whether Amazon Redshift clusters have Multi-AZ enabled.,['redundancy'],,Check if Redshift clusters have Multi-AZ enabled.,,[],,[],redshift_cluster_multi_az_enabled,"{'Code': {'CLI': 'aws redshift modify-cluster --cluster-identifier <cluster-id> --multi-az', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure Amazon Redshift with Multi-AZ deployments.', 'Url': 'https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-multi-az.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster/cluster-name,AwsRedshiftCluster,"Amazon Redshift supports multiple Availability Zones (Multi-AZ) deployments for provisioned RA3 clusters. By using Multi-AZ deployments, your Amazon Redshift data warehouse can continue operating in failure scenarios when an unexpected event happens in an Availability Zone."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_in_transit_encryption_enabled/redshift_cluster_in_transit_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/redshift/latest/mgmt/security-encryption-in-transit.html,redshift,This control checks whether connections to Amazon Redshift clusters are required to use encryption in transit. The control fails if the Redshift cluster parameter 'require_SSL' isn't set to True.,['encryption'],,Check if connections to Amazon Redshift clusters are encrypted in transit.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],redshift_cluster_in_transit_encryption_enabled,"{'Code': {'CLI': 'aws redshift modify-cluster-parameter-group --parameter-group-name <group-name> --parameters ParameterName=require_ssl,ParameterValue=true,ApplyType=static', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-2', 'Terraform': ''}, 'Recommendation': {'Text': ""Ensure that connections to Amazon Redshift clusters use encryption in transit by setting the 'require_ssl' parameter to True."", 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Redshift/redshift-parameter-groups-require-ssl.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster/cluster-name,AwsRedshiftCluster,"Without encryption in transit, connections to the Redshift cluster are vulnerable to eavesdropping or person-in-the-middle attacks, exposing sensitive data to unauthorized access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_automated_snapshot/redshift_cluster_automated_snapshot.metadata.json,,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Redshift.html,redshift,Check if Redshift Clusters have automated snapshots enabled,[],,Check if Redshift Clusters have automated snapshots enabled,,[],,[],redshift_cluster_automated_snapshot,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach', 'Url': 'https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Redshift.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster:cluster-name,AwsRedshiftCluster,"If backup is not enabled, data is vulnerable. Human error or bad actors could erase or modify data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/redshift/redshift_cluster_non_default_database_name/redshift_cluster_non_default_database_name.metadata.json,,https://docs.aws.amazon.com/redshift/latest/gsg/getting-started.html,redshift,This control checks whether an Amazon Redshift cluster has changed the database name from its default value. The control fails if the database name is set to 'dev'.,[],,Check if Redshift clusters are using the default database name.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],redshift_cluster_non_default_database_name,"{'Code': {'CLI': 'aws redshift create-cluster --cluster-identifier <cluster-id> --db-name <new-db-name>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/redshift-controls.html#redshift-9', 'Terraform': ''}, 'Recommendation': {'Text': ""Create a new Redshift cluster with a unique database name to replace the default 'dev' database name."", 'Url': 'https://docs.aws.amazon.com/redshift/latest/gsg/getting-started.html'}}",medium,[],arn:aws:redshift:region:account-id:cluster/cluster-name,AwsRedshiftCluster,"Using the default database name 'dev' increases the risk of unintended access, as it is publicly known and could be used in IAM policy conditions to inadvertently allow access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_insights_exist/cloudtrail_insights_exist.metadata.json,,,cloudtrail,Ensure CloudTrail Insight is enabled,['forensics-ready'],,Ensure CloudTrail Insight is enabled,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_insights_exist,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable CloudTrail Insight', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-insights-events-with-cloudtrail.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"CloudTrail Insights provides a powerful way to search and analyze CloudTrail log data using pre-built queries and machine learning algorithms. This can help you to identify potential security threats and suspicious activity in near real-time, such as unauthorized access attempts, policy changes, or resource modifications."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_bucket_requires_mfa_delete/cloudtrail_bucket_requires_mfa_delete.metadata.json,,,cloudtrail,Ensure the S3 bucket CloudTrail bucket requires MFA,['forensics-ready'],,Ensure the S3 bucket CloudTrail bucket requires MFA delete,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_bucket_requires_mfa_delete,"{'Code': {'CLI': 'aws s3api put-bucket-versioning --bucket DOC-EXAMPLE-BUCKET1 --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""SERIAL 123456""', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure MFA Delete for the S3 bucket CloudTrail bucket', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"If the S3 bucket CloudTrail bucket does not require MFA, it can be deleted by an attacker."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_logs_s3_bucket_access_logging_enabled/cloudtrail_logs_s3_bucket_access_logging_enabled.metadata.json,,,cloudtrail,Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket,['forensics-ready'],,Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_logs_s3_bucket_access_logging_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_6#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that S3 buckets have Logging enabled. CloudTrail data events can be used in place of S3 bucket logging. If that is the case, this finding can be considered a false positive.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"Server access logs can assist you in security and access audits, help you learn about your customer base, and understand your Amazon S3 bill."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_logs_s3_bucket_is_not_publicly_accessible/cloudtrail_logs_s3_bucket_is_not_publicly_accessible.metadata.json,,,cloudtrail,Ensure the S3 bucket CloudTrail logs to is not publicly accessible,"['forensics-ready', 'internet-exposed']",,Ensure the S3 bucket CloudTrail logs is not publicly accessible,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_logs_s3_bucket_is_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_3#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Analyze Bucket policy to validate appropriate permissions. Ensure the AllUsers principal is not granted privileges. Ensure the AuthenticatedUsers principal is not granted privileges.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,Allowing public access to CloudTrail log content may aid an adversary in identifying weaknesses in the affected accounts use or configuration.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_multi_region_enabled_logging_management_events/cloudtrail_multi_region_enabled_logging_management_events.metadata.json,,https://docs.prowler.com/checks/aws/logging-policies/logging_14,cloudtrail,Ensure CloudTrail logging management events in All Regions,['forensics-ready'],,Ensure CloudTrail logging management events in All Regions,,[],,['CIS AWS Foundations Benchmark'],cloudtrail_multi_region_enabled_logging_management_events,"{'Code': {'CLI': 'aws cloudtrail update-trail --name <trail_name> --is-multi-region-trail', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_14', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/logging_14#terraform'}, 'Recommendation': {'Text': 'Enable CloudTrail logging management events in All Regions', 'Url': 'https://docs.prowler.com/checks/aws/logging-policies/logging_14'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"AWS CloudTrail enables governance, compliance, operational auditing, and risk auditing of your AWS account. To meet FTR requirements, you must have management events enabled for all AWS accounts and in all regions and aggregate these logs into an Amazon Simple Storage Service (Amazon S3) bucket owned by a separate AWS account."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_s3_dataevents_read_enabled/cloudtrail_s3_dataevents_read_enabled.metadata.json,,,cloudtrail,"Ensure that all your AWS CloudTrail trails are configured to log Data events in order to record S3 object-level API operations, such as GetObject, DeleteObject and PutObject, for individual S3 buckets or for all current and future S3 buckets provisioned in your AWS account.",[],,Check if S3 buckets have Object-level logging for read events is enabled in CloudTrail.,,[],,['Logging and Monitoring'],cloudtrail_s3_dataevents_read_enabled,"{'Code': {'CLI': ""aws cloudtrail put-event-selectors --trail-name <YOUR_TRAIL_NAME_HERE> --event-selectors '[{ 'ReadWriteType': 'ReadOnly', 'IncludeManagementEvents':true, 'DataResources': [{ 'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3'] }] }]'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-23', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logs. Create an S3 lifecycle policy. Define use cases, metrics and automated responses where applicable.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-cloudtrail-logging-for-s3.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_log_file_validation_enabled/cloudtrail_log_file_validation_enabled.metadata.json,,,cloudtrail,Ensure CloudTrail log file validation is enabled,['forensics-ready'],,Ensure CloudTrail log file validation is enabled,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_log_file_validation_enabled,"{'Code': {'CLI': 'aws cloudtrail update-trail --name <trail_name>  --enable-log-file-validation', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/logging_2#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/logging_2#terraform'}, 'Recommendation': {'Text': 'Ensure LogFileValidationEnabled is set to true for each trail.', 'Url': 'http://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-filevalidation-enabling.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,Enabling log file validation will provide additional integrity checking of CloudTrail logs. 
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_threat_detection_llm_jacking/cloudtrail_threat_detection_llm_jacking.metadata.json,,https://sysdig.com/blog/llmjacking-stolen-cloud-credentials-used-in-new-ai-attack/,cloudtrail,"This check ensures that there are no potential LLM Jacking threats in CloudTrail. LLM Jacking attacks involve unauthorized access to cloud-hosted large language model (LLM) services, such as AWS Bedrock, by exploiting exposed credentials or vulnerabilities. These attacks can lead to resource hijacking, unauthorized model invocations, and high operational costs for the victim organization.",['threat-detection'],,Ensure there are no potential LLM Jacking threats in CloudTrail.,,[],,[],cloudtrail_threat_detection_llm_jacking,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To remediate this issue, enable detailed CloudTrail logging for Bedrock API calls, monitor suspicious activities, and secure sensitive credentials. Enable logging of model invocation inputs and outputs, and restrict access using IAM policies. Review CloudTrail logs regularly for suspicious `InvokeModel` actions or unauthorized access to models.', 'Url': 'https://permiso.io/blog/exploiting-hosted-models'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"Potential LLM Jacking threats in CloudTrail can lead to unauthorized access to sensitive AI models, stolen credentials, resource hijacking, or running costly workloads. Attackers may use reverse proxies or malicious credentials to sell access to models, exfiltrate sensitive data, or disrupt business operations."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_s3_dataevents_write_enabled/cloudtrail_s3_dataevents_write_enabled.metadata.json,,,cloudtrail,"Ensure that all your AWS CloudTrail trails are configured to log Data events in order to record S3 object-level API operations, such as GetObject, DeleteObject and PutObject, for individual S3 buckets or for all current and future S3 buckets provisioned in your AWS account.",['forensics-ready'],,Check if S3 buckets have Object-level logging for write events is enabled in CloudTrail.,,[],,['Logging and Monitoring'],cloudtrail_s3_dataevents_write_enabled,"{'Code': {'CLI': ""aws cloudtrail put-event-selectors --trail-name <YOUR_TRAIL_NAME_HERE> --event-selectors '[{ 'ReadWriteType': 'WriteOnly', 'IncludeManagementEvents':true, 'DataResources': [{ 'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3'] }] }]'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/s3-controls.html#s3-22', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logs. Create an S3 lifecycle policy. Define use cases, metrics and automated responses where applicable.', 'Url': 'https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-cloudtrail-logging-for-s3.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_threat_detection_enumeration/cloudtrail_threat_detection_enumeration.metadata.json,,,cloudtrail,This check ensures that there are no potential enumeration threats in CloudTrail.,['threat-detection'],,Ensure there are no potential enumeration threats in CloudTrail,,[],,[],cloudtrail_threat_detection_enumeration,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To remediate this issue, ensure that there are no potential enumeration threats in CloudTrail.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-concepts.html#cloudtrail-concepts-logging-data-events'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,Potential enumeration threats in CloudTrail can lead to unauthorized access to resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_cloudwatch_logging_enabled/cloudtrail_cloudwatch_logging_enabled.metadata.json,,,cloudtrail,Ensure CloudTrail trails are integrated with CloudWatch Logs,"['forensics-ready', 'logging']",,Ensure CloudTrail trails are integrated with CloudWatch Logs,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_cloudwatch_logging_enabled,"{'Code': {'CLI': 'aws cloudtrail update-trail --name <trail_name> --cloudwatch-logs-log-group- arn <cloudtrail_log_group_arn> --cloudwatch-logs-role-arn <cloudtrail_cloudwatchLogs_role_arn>', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_4#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Validate that the trails in CloudTrail have an arn set in the CloudWatchLogsLogGroupArn property.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"Sending CloudTrail logs to CloudWatch Logs will facilitate real-time and historic activity logging based on user, API, resource, and IP address, and provides opportunity to establish alarms and notifications for anomalous or sensitivity account activity."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_kms_encryption_enabled/cloudtrail_kms_encryption_enabled.metadata.json,,,cloudtrail,Ensure CloudTrail logs are encrypted at rest using KMS CMKs,"['forensics-ready', 'encryption']",,Ensure CloudTrail logs are encrypted at rest using KMS CMKs,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_kms_encryption_enabled,"{'Code': {'CLI': 'aws cloudtrail update-trail --name <trail_name> --kms-id <cloudtrail_kms_key> aws kms put-key-policy --key-id <cloudtrail_kms_key> --policy <cloudtrail_kms_key_policy>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/logging_7#fix---buildtime', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'This approach has the following advantages: You can create and manage the CMK encryption keys yourself. You can use a single CMK to encrypt and decrypt log files for multiple accounts across all regions. You have control over who can use your key for encrypting and decrypting CloudTrail log files. You can assign permissions for the key to the users. You have enhanced security.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"By default, the log files delivered by CloudTrail to your bucket are encrypted by Amazon server-side encryption with Amazon S3-managed encryption keys (SSE-S3). To provide a security layer that is directly manageable, you can instead use server-side encryption with AWS KMSâ€“managed keys (SSE-KMS) for your CloudTrail log files."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_threat_detection_privilege_escalation/cloudtrail_threat_detection_privilege_escalation.metadata.json,,,cloudtrail,This check ensures that there are no potential privilege escalation threats in CloudTrail.,['threat-detection'],,Ensure there are no potential privilege escalation threats in CloudTrail,,[],,[],cloudtrail_threat_detection_privilege_escalation,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To remediate this issue, ensure that there are no potential privilege escalation threats in CloudTrail.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-concepts.html#cloudtrail-concepts-logging-data-events'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,Potential privilege escalation threats in CloudTrail can lead to unauthorized access to resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudtrail/cloudtrail_multi_region_enabled/cloudtrail_multi_region_enabled.metadata.json,,,cloudtrail,Ensure CloudTrail is enabled in all regions,['forensics-ready'],,Ensure CloudTrail is enabled in all regions,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",cloudtrail_multi_region_enabled,"{'Code': {'CLI': 'aws cloudtrail create-trail --name <trail_name> --bucket-name <s3_bucket_for_cloudtrail> --is-multi-region-trail aws cloudtrail update-trail --name <trail_name> --is-multi-region-trail ', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/logging_1#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_1#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/logging_1#terraform'}, 'Recommendation': {'Text': 'Ensure Logging is set to ON on all regions (even if they are not being used at the moment.', 'Url': 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrailconcepts.html#cloudtrail-concepts-management-events'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsCloudTrailTrail,"AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_no_secrets_in_code/awslambda_function_no_secrets_in_code.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,awslambda,Find secrets in Lambda functions code.,['secrets'],,Find secrets in Lambda functions code.,,[],,[],awslambda_function_no_secrets_in_code,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use Secrets Manager to securely provide database credentials to Lambda functions and secure the databases as well as use the credentials to connect and query them without hardcoding the secrets in code or passing them through environmental variables.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html'}}",critical,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,"The use of a hard-coded password increases the possibility of password guessing.  If hard-coded passwords are used, it is possible that malicious users gain access through the account in question."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_no_secrets_in_variables/awslambda_function_no_secrets_in_variables.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,awslambda,Find secrets in Lambda functions variables.,['secrets'],,Find secrets in Lambda functions variables.,,[],,[],awslambda_function_no_secrets_in_variables,"{'Code': {'CLI': 'aws lambda get-function-configuration --region <REGION> --function-name <FUNCTION_NAME> --query Environment.Variables', 'NativeIaC': 'https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_3#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_3', 'Terraform': 'https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_3#terraform'}, 'Recommendation': {'Text': 'Use Secrets Manager to securely provide database credentials to Lambda functions and secure the databases as well as use the credentials to connect and query them without hardcoding the secrets in code or passing them through environmental variables.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html'}}",critical,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,"The use of a hard-coded password increases the possibility of password guessing. If hard-coded passwords are used, it is possible that malicious users gain access through the account in question."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_invoke_api_operations_cloudtrail_logging_enabled/awslambda_function_invoke_api_operations_cloudtrail_logging_enabled.metadata.json,,https://docs.aws.amazon.com/lambda/latest/dg/logging-using-cloudtrail.html,awslambda,Check if Lambda functions invoke API operations are being recorded by CloudTrail.,"['forensics-ready', 'logging']",,Check if Lambda functions invoke API operations are being recorded by CloudTrail.,,[],,[],awslambda_function_invoke_api_operations_cloudtrail_logging_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Make sure you are logging information about Lambda operations. Create a lifecycle and use cases for each trail.', 'Url': 'https://docs.aws.amazon.com/lambda/latest/dg/logging-using-cloudtrail.html'}}",low,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_url_public/awslambda_function_url_public.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,awslambda,Check Public Lambda Function URL.,['internet-exposed'],,Check Public Lambda Function URL.,,[],,[],awslambda_function_url_public,"{'Code': {'CLI': 'aws lambda update-function-url-config --region AWS_REGION --function-name FUNCTION-NAME --auth-type AWS_IAM', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Grant usage permission on a per-resource basis and applying least privilege principle.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html'}}",high,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,Publicly accessible services could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_url_cors_policy/awslambda_function_url_cors_policy.metadata.json,,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,awslambda,Check Lambda Function URL CORS configuration.,[],,Check Lambda Function URL CORS configuration.,,[],,[],awslambda_function_url_cors_policy,"{'Code': {'CLI': ""aws lambda update-function-url-config --region AWS_REGION --function-name FUNCTION-NAME --auth-type AWS_IAM --cors 'AllowOrigins=https://www.example.com,AllowMethods=*,ExposeHeaders=keep-alive,MaxAge=3600,AllowCredentials=false'"", 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Grant usage permission on a per-resource basis and applying least privilege principle.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html'}}",medium,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,Publicly accessible services could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_using_supported_runtimes/awslambda_function_using_supported_runtimes.metadata.json,,https://docs.aws.amazon.com/lambda/latest/dg/runtime-support-policy.html,awslambda,Find obsolete Lambda runtimes.,[],,Find obsolete Lambda runtimes.,,[],,[],awslambda_function_using_supported_runtimes,"{'Code': {'CLI': ""aws lambda update-function-configuration --region AWS-REGION --function-name FUNCTION-NAME --runtime 'RUNTIME'"", 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Test new runtimes as they are made available. Implement them in production as soon as possible.', 'Url': 'https://docs.aws.amazon.com/lambda/latest/dg/runtime-support-policy.html'}}",medium,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,"If you have functions running on a runtime that will be deprecated in the next 60 days, Lambda notifies you by email that you should prepare by migrating your function to a supported runtime. In some cases, such as security issues that require a backwards-incompatible update, or software that does not support a long-term support (LTS) schedule, advance notice might not be possible. After a runtime is deprecated, Lambda might retire it completely at any time by disabling invocation. Deprecated runtimes are not eligible for security updates or technical support."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_vpc_multi_az/awslambda_function_vpc_multi_az.metadata.json,,https://docs.aws.amazon.com/lambda/latest/operatorguide/networking-vpc.html,awslambda,"This control checks whether an AWS Lambda function connected to a VPC operates in at least the specified number of Availability Zones (AZs). A failure occurs if the function does not operate in the required number of AZs, which by default is two.",[],,Check if AWS Lambda Function VPC is deployed Across Multiple Availability Zones,,[],,[],awslambda_function_vpc_multi_az,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html#lambda-5', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that your AWS Lambda functions connected to a VPC are distributed across multiple Availability Zones (AZs) to enhance availability and resilience.', 'Url': 'https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html'}}",medium,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,"A Lambda function not deployed across multiple AZs increases the risk of a single point of failure, which can result in a complete disruption of the function's operations if an AZ becomes unavailable."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_inside_vpc/awslambda_function_inside_vpc.metadata.json,,https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html,awslambda,"This check verifies whether an AWS Lambda function is deployed within a Virtual Private Cloud (VPC). Deploying Lambda functions inside a VPC improves security by allowing control over the network environment, reducing the exposure to public internet threats.",[],,Ensure AWS Lambda Functions Are Deployed Inside a VPC,,[],,[],awslambda_function_inside_vpc,"{'Code': {'CLI': 'aws lambda update-function-configuration --region <region-name> --function-name <function-name> --vpc-config SubnetIds=<subnet-id-1>,<subnet-id-2>,SecurityGroupIds=<security-group-id>', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Lambda/function-in-vpc.html', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/lambda-controls.html#lambda-3', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1/'}, 'Recommendation': {'Text': 'Configure your AWS Lambda functions to operate within a Virtual Private Cloud (VPC) to enhance security and control network access.', 'Url': ''}}",low,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,"Lambda functions not deployed in a VPC may expose your application to increased security risks, including unauthorized access and data breaches. Without the network isolation provided by a VPC, your Lambda functions are more vulnerable to attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/awslambda/awslambda_function_not_publicly_accessible/awslambda_function_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/lambda/latest/dg/access-control-resource-based.html,awslambda,Check if Lambda functions have resource-based policy set as Public.,['internet-exposed'],It gives a false positive if the function is exposed publicly by an other public resource like an ALB or API Gateway in an AWS Account when an AWS account ID is set as the principal of the policy.,Check if Lambda functions have resource-based policy set as Public.,,[],,[],awslambda_function_not_publicly_accessible,"{'Code': {'CLI': 'aws lambda remove-permission --region <REGION> --function-name <QUEUE_NAME> --statement-id FullAccess', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Lambda/function-exposed.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Grant usage permission on a per-resource basis and applying least privilege principle.', 'Url': 'https://docs.aws.amazon.com/lambda/latest/dg/access-control-resource-based.html'}}",critical,[],arn:partition:lambda:region:account-id:function/function-name,AwsLambdaFunction,Publicly accessible services could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/resourceexplorer2/resourceexplorer2_indexes_found/resourceexplorer2_indexes_found.metadata.json,,,resourceexplorer2,Resource Explorer Indexes Found,[],,Resource Explorer Indexes Found,,[],,[],resourceexplorer2_indexes_found,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Create indexes', 'Url': 'https://docs.aws.amazon.com/resource-explorer/latest/userguide/manage-service-turn-on-region.html'}}",low,[],arn:aws:resource-explorer-2:region:account-id:index/index-id,Other,"Not having Resource Explorer indexes can result in increased complexity and overhead in managing your resources, as well as increased risk of security and compliance issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_administrator_access_policy/iam_user_administrator_access_policy.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users.html,iam,"This check ensures that no IAM users in your AWS account have the 'AdministratorAccess' policy attached. IAM users with this policy have unrestricted access to all AWS services and resources, which poses a significant security risk if misused.",[],,Ensure No IAM Users Have Administrator Access Policy,,[],,[],iam_user_administrator_access_policy,"{'Code': {'CLI': 'aws iam detach-user-policy --user-name <username> --policy-arn arn:aws:iam::aws:policy/AdministratorAccess', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/IAM/admin-permissions.html', 'Terraform': ''}, 'Recommendation': {'Text': ""Replace the 'AdministratorAccess' policy with more specific permissions that follow the Principle of Least Privilege. Consider implementing IAM roles such as 'IAM Master' and 'IAM Manager' to manage permissions more securely."", 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,"IAM users with administrator-level permissions can perform any action on any resource in your AWS environment. If these permissions are granted to users unnecessarily or to individuals without sufficient knowledge, it can lead to security vulnerabilities, data leaks, data loss, or unexpected charges."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_rotate_access_key_90_days/iam_rotate_access_key_90_days.metadata.json,,,iam,Ensure access keys are rotated every 90 days or less,[],,Ensure access keys are rotated every 90 days or less,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_rotate_access_key_90_days,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use the credential report to  ensure  access_key_X_last_rotated  is less than 90 days ago.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamAccessKey,Access keys consist of an access key ID and secret access key which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI)- Tools for Windows PowerShell- the AWS SDKs- or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_customer_unattached_policy_no_administrative_privileges/iam_customer_unattached_policy_no_administrative_privileges.metadata.json,,,iam,"Ensure IAM policies that allow full ""*:*"" administrative privileges are not created, may be eventual consistent if an ephemeral resource is using it",[],CAF Security Epic: IAM,"Ensure IAM policies that allow full ""*:*"" administrative privileges are not created",,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_customer_unattached_policy_no_administrative_privileges,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47', 'Terraform': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform'}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,"IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilegeâ€”that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_root_hardware_mfa_enabled/iam_root_hardware_mfa_enabled.metadata.json,,,iam,Ensure only hardware MFA is enabled for the root account,[],,Ensure only hardware MFA is enabled for the root account,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_root_hardware_mfa_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Using IAM console navigate to Dashboard and expand Activate MFA on your root account.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html#id_root-user_manage_mfa'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled when a user signs in to an AWS website they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2 it is recommended that the root account be protected with only a hardware MFA.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_no_setup_initial_access_key/iam_user_no_setup_initial_access_key.metadata.json,,,iam,Do not setup access keys during initial user setup for all IAM users that have a console password,[],CAF Security Epic: IAM,Do not setup access keys during initial user setup for all IAM users that have a console password,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_user_no_setup_initial_access_key,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'From the IAM console: generate credential report and disable not required keys.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamAccessKey,"AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. Requiring that additional steps be taken by the user after their profile has been created will give a stronger indication of intent that access keys are (a) necessary for their work and (b) once the access key is established on an account that the keys may be in use somewhere in the organization."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_no_expired_server_certificates_stored/iam_no_expired_server_certificates_stored.metadata.json,,,iam,Ensure that all the expired SSL/TLS certificates stored in AWS IAM are removed.,['encryption'],Data Protection,Ensure that all the expired SSL/TLS certificates stored in AWS IAM are removed.,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_no_expired_server_certificates_stored,"{'Code': {'CLI': 'aws iam delete-server-certificate --server-certificate-name <CERTIFICATE_NAME', 'NativeIaC': '', 'Other': 'Removing expired certificates via AWS Management Console is not currently supported.', 'Terraform': ''}, 'Recommendation': {'Text': 'Deleting the certificate could have implications for your application if you are using an expired server certificate with Elastic Load Balancing, CloudFront, etc. One has to make configurations at respective services to ensure there is no interruption in application functionality.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_server-certs.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,Other,"Removing expired SSL/TLS certificates eliminates the risk that an invalid certificate will be deployed accidentally to a resource such as AWS Elastic Load Balancer (ELB), which can damage the credibility of the application/website behind the ELB."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_root_mfa_enabled/iam_root_mfa_enabled.metadata.json,,,iam,Ensure MFA is enabled for the root account,[],,Ensure MFA is enabled for the root account,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_root_mfa_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Using IAM console navigate to Dashboard and expand Activate MFA on your root account.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html#id_root-user_manage_mfa'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled when a user signs in to an AWS website they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. When virtual MFA is used for root accounts it is recommended that the device used is NOT a personal device but rather a dedicated mobile device (tablet or phone) that is managed to be kept charged and secured independent of any individual personal devices. (non-personal virtual MFA) This lessens the risks of losing access to the MFA due to device loss / trade-in or if the individual owning the device is no longer employed at the company.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_with_temporary_credentials/iam_user_with_temporary_credentials.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html,iam,Ensure users make use of temporary credentials assuming IAM roles,[],,Ensure users make use of temporary credentials assuming IAM roles,,[],,['Infrastructure Security'],iam_user_with_temporary_credentials,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': ""As a best practice, use temporary security credentials (IAM roles) instead of creating long-term credentials like access keys, and don't create AWS account root user access keys."", 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html'}}",medium,[],arn:partition:iam::account-id:user/user-name,AwsIamUser,"As a best practice, use temporary security credentials (IAM roles) instead of creating long-term credentials like access keys, and don't create AWS account root user access keys."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_support_role_created/iam_support_role_created.metadata.json,,,iam,Ensure a support role has been created to manage incidents with AWS Support,[],CAF Security Epic: IAM,Ensure a support role has been created to manage incidents with AWS Support,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_support_role_created,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Create an IAM role for managing incidents with AWS.', 'Url': 'https://docs.aws.amazon.com/awssupport/latest/user/using-service-linked-roles-sup.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamRole,"AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_hardware_mfa_enabled/iam_user_hardware_mfa_enabled.metadata.json,,,iam,Check if IAM users have Hardware MFA enabled.,[],,Check if IAM users have Hardware MFA enabled.,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_user_hardware_mfa_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable hardware MFA device for an IAM user from the AWS Management Console, the command line, or the IAM API.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_physical.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,Hardware MFA is preferred over virtual MFA.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_inline_policy_allows_privilege_escalation/iam_inline_policy_allows_privilege_escalation.metadata.json,,,iam,Ensure no Inline IAM policies allow actions that may lead into Privilege Escalation,[],,Ensure no IAM Inline policies allow actions that may lead into Privilege Escalation,,[],inline_policy,"['Software and Configuration Checks', 'Industry and Regulatory Standards']",iam_inline_policy_allows_privilege_escalation,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Grant usage permission on a per-resource basis and applying least privilege principle.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,Users with some IAM permissions are allowed to elevate their privileges up to administrator rights.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_inline_policy_no_administrative_privileges/iam_inline_policy_no_administrative_privileges.metadata.json,,,iam,"Ensure inline policies that allow full ""*:*"" administrative privileges are not associated to IAM identities",[],CAF Security Epic: IAM,"Ensure IAM inline policies that allow full ""*:*"" administrative privileges are not associated to IAM identities",,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_inline_policy_no_administrative_privileges,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47', 'Terraform': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform'}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,"IAM policies are the means by which privileges are granted to users, groups or roles. It is recommended and considered a standard security advice to grant least privilegeâ€”that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_aws_attached_policy_no_administrative_privileges/iam_aws_attached_policy_no_administrative_privileges.metadata.json,,,iam,"Ensure IAM AWS-Managed policies that allow full ""*:*"" administrative privileges are not attached",[],CAF Security Epic: IAM,"Ensure IAM AWS-Managed policies that allow full ""*:*"" administrative privileges are not attached",,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_aws_attached_policy_no_administrative_privileges,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47', 'Terraform': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform'}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,"IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilegeâ€”that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_policy_allows_privilege_escalation/iam_policy_allows_privilege_escalation.metadata.json,,,iam,Ensure no Customer Managed IAM policies allow actions that may lead into Privilege Escalation,[],CAF Security Epic: IAM,Ensure no Customer Managed IAM policies allow actions that may lead into Privilege Escalation,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_policy_allows_privilege_escalation,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Grant usage permission on a per-resource basis and applying least privilege principle.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,Users with some IAM permissions are allowed to elevate their privileges up to administrator rights.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_check_saml_providers_sts/iam_check_saml_providers_sts.metadata.json,,,iam,Check if there are SAML Providers then STS can be used,[],,Check if there are SAML Providers then STS can be used,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_check_saml_providers_sts,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable SAML provider and use temporary credentials. You can use temporary security credentials to make programmatic requests for AWS resources using the AWS CLI or AWS API (using the AWS SDKs ). The temporary credentials provide the same permissions that you have with use long-term security credentials such as IAM user credentials. In case of not having SAML provider capabilities prevent usage of long-lived credentials.', 'Url': 'https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html'}}",low,[],arn:partition:service:region:account-id:resource-id,Other,Without SAML provider users with AWS CLI or AWS API access can use IAM static credentials. SAML helps users to assume role by default each time they authenticate.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_policy_no_full_access_to_kms/iam_policy_no_full_access_to_kms.metadata.json,,,iam,"Ensure IAM policies that allow full ""kms:*"" privileges are not created",[],,"Ensure IAM policies that allow full ""kms:*"" privileges are not created",,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_policy_no_full_access_to_kms,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,KMS is a critical service and IAM policies should follow least privilege model for this service in particular
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_password_policy_number/iam_password_policy_number.metadata.json,,,iam,Ensure IAM password policy require at least one number,[],,Ensure IAM password policy require at least one number,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_password_policy_number,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure ""Require at least one number"" is checked under ""Password Policy"".', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_role_cross_service_confused_deputy_prevention/iam_role_cross_service_confused_deputy_prevention.metadata.json,,,iam,Ensure IAM Service Roles prevents against a cross-service confused deputy attack,['trustboundaries'],,Ensure IAM Service Roles prevents against a cross-service confused deputy attack,,[],,[],iam_role_cross_service_confused_deputy_prevention,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': ""To mitigate cross-service confused deputy attacks, it's recommended to use the aws:SourceArn and aws:SourceAccount global condition context keys in your IAM role trust policies. If the role doesn't support these fields, consider implementing alternative security measures, such as defining more restrictive resource-based policies or using service-specific trust policies, to limit the role's permissions and exposure. For detailed guidance, refer to AWS's documentation on preventing cross-service confused deputy issues."", 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html#cross-service-confused-deputy-prevention'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamRole,Allow attackers to gain unauthorized access to resources
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_inline_policy_no_full_access_to_cloudtrail/iam_inline_policy_no_full_access_to_cloudtrail.metadata.json,,,iam,"Ensure IAM inline policies that allow full ""cloudtrail:*"" privileges are not created",[],,"Ensure IAM inline policies that allow full ""cloudtrail:*"" privileges are not created",,[],inline_policies,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_inline_policy_no_full_access_to_cloudtrail,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,CloudTrail is a critical service and IAM policies should follow least privilege model for this service in particular
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_password_policy_minimum_length_14/iam_password_policy_minimum_length_14.metadata.json,,,iam,Ensure IAM password policy requires minimum length of 14 or greater,[],,Ensure IAM password policy requires minimum length of 14 or greater,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_password_policy_minimum_length_14,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure ""Minimum password length"" is checked under ""Password Policy"".', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require minimum length of 14 or greater.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_avoid_root_usage/iam_avoid_root_usage.metadata.json,,,iam,Avoid the use of the root account,[],,Avoid the use of the root accounts,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_avoid_root_usage,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Follow the remediation instructions of the Ensure IAM policies are attached only to groups or roles recommendation.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,The root account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_root_credentials_management_enabled/iam_root_credentials_management_enabled.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html#id_root-user-access-management,iam,"Checks if centralized management of root credentials for member accounts in AWS Organizations is enabled. This ensures that root credentials are managed centrally, reducing the risk of unauthorized access or mismanagement.",[],"This check skips findings for member accounts as they cannot execute the ListOrganizationsFeatures API call, which is restricted to the management account or delegated administrators.",Ensure centralized root credentials management is enabled,,[],,[],iam_root_credentials_management_enabled,"{'Code': {'CLI': 'aws iam enable-organizations-root-credentials-management', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable centralized management of root access for member accounts using the CLI or IAM console.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-enable-root-access.html'}}",high,"['iam_root_hardware_mfa_enabled', 'iam_root_mfa_enabled', 'iam_no_root_access_key']",arn:partition:service:region:account-id:resource-id,Other,"Without centralized root credentials management, member accounts retain full control over their root user credentials, increasing the risk of credential misuse, mismanagement, or compromise."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_role_cross_account_readonlyaccess_policy/iam_role_cross_account_readonlyaccess_policy.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#awsmp_readonlyaccess,iam,Ensure IAM Roles do not have ReadOnlyAccess access for external AWS accounts,['trustboundaries'],CAF Security Epic: IAM,Ensure IAM Roles do not have ReadOnlyAccess access for external AWS accounts,,[],,[],iam_role_cross_account_readonlyaccess_policy,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Remove the AWS-managed ReadOnlyAccess policy from all roles that have a trust policy, including third-party cloud accounts, or remove third-party cloud accounts from the trust policy of all roles that need the ReadOnlyAccess policy.', 'Url': 'https://docs.securestate.vmware.com/rule-docs/aws-iam-role-cross-account-readonlyaccess-policy'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamRole,"The AWS-managed ReadOnlyAccess policy is highly potent and exposes the customer to a significant data leakage threat. It should be granted very conservatively. For granting access to 3rd party vendors, consider using alternative managed policies, such as ViewOnlyAccess or SecurityAudit."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_password_policy_expires_passwords_within_90_days_or_less/iam_password_policy_expires_passwords_within_90_days_or_less.metadata.json,,,iam,Ensure IAM password policy expires passwords within 90 days or less,[],,Ensure IAM password policy expires passwords within 90 days or less,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_password_policy_expires_passwords_within_90_days_or_less,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure Password expiration period (in days): is set to 90 or less.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_two_active_access_key/iam_user_two_active_access_key.metadata.json,,,iam,Check if IAM users have two active access keys,[],,Check if IAM users have two active access keys,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_user_two_active_access_key,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Avoid using long lived access keys.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/APIReference/API_ListAccessKeys.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,Access Keys could be lost or stolen. It creates a critical risk.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_inline_policy_no_full_access_to_kms/iam_inline_policy_no_full_access_to_kms.metadata.json,,,iam,"Ensure IAM inline policies that allow full ""kms:*"" privileges are not created",[],,"Ensure IAM inline policies that allow full ""kms:*"" privileges are not created",,[],inline_policy,['Software and Configuration Checks'],iam_inline_policy_no_full_access_to_kms,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,KMS is a critical service and IAM policies should follow least privilege model for this service in particular
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_password_policy_symbol/iam_password_policy_symbol.metadata.json,,,iam,Ensure IAM password policy require at least one symbol,[],,Ensure IAM password policy require at least one symbol,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_password_policy_symbol,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure ""Require at least one non-alphanumeric character"" is checked under ""Password Policy"".', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one non-alphanumeric character.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_accesskey_unused/iam_user_accesskey_unused.metadata.json,,,iam,Ensure User Access Keys unused are disabled,[],,Ensure User Access Keys unused are disabled,,[],,['Software and Configuration Checks'],iam_user_accesskey_unused,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Find the credentials that they were using and ensure that they are no longer operational. Ideally, you delete credentials if they are no longer needed. You can always recreate them at a later date if the need arises. At the very least, you should change the password or deactivate the access keys so that the former users no longer have access.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,"To increase the security of your AWS account, remove IAM user credentials (that is, passwords and access keys) that are not needed. For example, when users leave your organization or no longer need AWS access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_securityaudit_role_created/iam_securityaudit_role_created.metadata.json,,,iam,Ensure a Security Audit role has been created to conduct security audits,[],,Ensure a Security Audit role has been created to conduct security audits,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_securityaudit_role_created,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Create an IAM role for conduct security audits with AWS.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_security-auditor'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsIamRole,Creating an IAM role with a security audit policy provides a clear separation of duties between the security team and other teams within the organization. This helps to ensure that security-related activities are performed by authorized individuals with the appropriate expertise and access permissions.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_no_custom_policy_permissive_role_assumption/iam_no_custom_policy_permissive_role_assumption.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_permissions-to-switch.html#roles-usingrole-createpolicy,iam,Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *),[],CAF Security Epic: IAM,Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *),,[],,['Software and Configuration Checks'],iam_no_custom_policy_permissive_role_assumption,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use the least privilege principle when granting permissions.', 'Url': 'https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,If not restricted unintended access could happen.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_password_policy_reuse_24/iam_password_policy_reuse_24.metadata.json,,,iam,Ensure IAM password policy prevents password reuse: 24 or greater,[],,Ensure IAM password policy prevents password reuse: 24 or greater,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_password_policy_reuse_24,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure ""Number of passwords to remember"" is set to 24.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy prevents at least password reuse of 24 or greater.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_policy_cloudshell_admin_not_attached/iam_policy_cloudshell_admin_not_attached.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/iam-policy-blacklisted-check.html,iam,"This control checks whether an IAM identity (user, role, or group) has the AWS managed policy AWSCloudShellFullAccess attached. The control fails if an IAM identity has the AWSCloudShellFullAccess policy attached.",['trustboundaries'],,"Check if IAM identities (users,groups,roles) have the AWSCloudShellFullAccess policy attached.",,[],,['Software and Configuration Checks/AWS Security Best Practices/CIS AWS Foundations Benchmark'],iam_policy_cloudshell_admin_not_attached,"{'Code': {'CLI': 'aws iam detach-user/role/group-policy --user/role/group-name <user/role/group-name> --policy-arn arn:aws:iam::aws:policy/AWSCloudShellFullAccess', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-27', 'Terraform': ''}, 'Recommendation': {'Text': 'Detach the AWSCloudShellFullAccess policy from the IAM identity to restrict excessive permissions and adhere to the principle of least privilege.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach-detach.html'}}",medium,[],arn:aws:iam::{account-id}:{resource-type}/{resource-id},AwsIamPolicy,"Attaching the AWSCloudShellFullAccess policy to IAM identities grants broad permissions, including internet access and file transfer capabilities, which can lead to security risks such as data exfiltration. The principle of least privilege should be followed to avoid excessive permissions."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_password_policy_lowercase/iam_password_policy_lowercase.metadata.json,,,iam,Ensure IAM password policy requires at least one uppercase letter,[],,Ensure IAM password policy require at least one lowercase letter,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_password_policy_lowercase,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure ""Requires at least one lowercase letter"" is checked under ""Password Policy"".', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_no_root_access_key/iam_no_root_access_key.metadata.json,,,iam,Ensure no root account access key exists,[],,Ensure no root account access key exists,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_no_root_access_key,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use the credential report to check the user and ensure the access_key_1_active and access_key_2_active fields are set to FALSE.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsIamAccessKey,The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed. Removing access keys associated with the root account limits vectors by which the account can be compromised. Removing the root access keys encourages the creation and use of role based accounts that are least privileged.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_customer_attached_policy_no_administrative_privileges/iam_customer_attached_policy_no_administrative_privileges.metadata.json,,,iam,"Ensure IAM Customer-Managed policies that allow full ""*:*"" administrative privileges are not attached",[],CAF Security Epic: IAM,"Ensure IAM Customer-Managed policies that allow full ""*:*"" administrative privileges are not attached",,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_customer_attached_policy_no_administrative_privileges,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47', 'Terraform': 'https://docs.prowler.com/checks/aws/iam-policies/iam_47#terraform'}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,"IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilegeâ€”that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_group_administrator_access_policy/iam_group_administrator_access_policy.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups_manage.html,iam,"This check ensures that no IAM groups in your AWS account have the 'AdministratorAccess' policy attached. IAM users with this policy have unrestricted access to all AWS services and resources, which poses a significant security risk if misused.",[],,Ensure No IAM Groups Have Administrator Access Policy,,[],,[],iam_group_administrator_access_policy,"{'Code': {'CLI': 'aws iam detach-group-policy --group-name <groupname> --policy-arn arn:aws:iam::aws:policy/AdministratorAccess', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/IAM/group-with-privileged-access.html', 'Terraform': ''}, 'Recommendation': {'Text': ""Replace the 'AdministratorAccess' policy with more specific permissions that follow the Principle of Least Privilege. Consider implementing IAM roles such as 'IAM Master' and 'IAM Manager' to manage permissions more securely."", 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamGroup,"IAM groups with administrator-level permissions can perform any action on any resource in your AWS environment. If these permissions are granted to users unnecessarily or to individuals without sufficient knowledge, it can lead to security vulnerabilities, data leaks, data loss, or unexpected charges."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_console_access_unused/iam_user_console_access_unused.metadata.json,,,iam,Ensure unused user console access are disabled,[],,Ensure unused user console access are disabled,,[],,['Software and Configuration Checks'],iam_user_console_access_unused,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Find the credentials that they were using and ensure that they are no longer operational. Ideally, you delete credentials if they are no longer needed. You can always recreate them at a later date if the need arises. At the very least, you should change the password or deactivate the access keys so that the former users no longer have access.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,"To increase the security of your AWS account, remove IAM user credentials (that is, passwords and access keys) that are not needed. For example, when users leave your organization or no longer need AWS access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_policy_attached_only_to_group_or_roles/iam_policy_attached_only_to_group_or_roles.metadata.json,,,iam,Ensure IAM policies are attached only to groups or roles,[],CAF Security Epic: IAM,Ensure IAM policies are attached only to groups or roles,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_policy_attached_only_to_group_or_roles,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Remove any policy attached directly to the user. Use groups or roles instead.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,"By default IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users. Assigning privileges at the group or role level reduces the complexity of access management as the number of users grow. Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_policy_no_full_access_to_cloudtrail/iam_policy_no_full_access_to_cloudtrail.metadata.json,,,iam,"Ensure IAM policies that allow full ""cloudtrail:*"" privileges are not created",[],,"Ensure IAM policies that allow full ""cloudtrail:*"" privileges are not created",,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_policy_no_full_access_to_cloudtrail,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'It is more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsIamPolicy,CloudTrail is a critical service and IAM policies should follow least privilege model for this service in particular
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_user_mfa_enabled_console_access/iam_user_mfa_enabled_console_access.metadata.json,,,iam,Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password.,[],,Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password.,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_user_mfa_enabled_console_access,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': ""Enable MFA for the user's account. MFA is a simple best practice that adds an extra layer of protection on top of your user name and password. Recommended to use hardware keys over virtual MFA."", 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,Unauthorized access to this critical account if password is not secure or it is disclosed in any way.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_password_policy_uppercase/iam_password_policy_uppercase.metadata.json,,,iam,Ensure IAM password policy requires at least one uppercase letter,[],,Ensure IAM password policy requires at least one uppercase letter,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",iam_password_policy_uppercase,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure ""Requires at least one uppercase letter"" is checked under ""Password Policy"".', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_role_administratoraccess_policy/iam_role_administratoraccess_policy.metadata.json,,https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_administrator,iam,Ensure IAM Roles do not have AdministratorAccess policy attached,['trustboundaries'],CAF Security Epic: IAM,Ensure IAM Roles do not have AdministratorAccess policy attached,,[],,[],iam_role_administratoraccess_policy,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Apply the principle of least privilege. Instead of AdministratorAccess, assign only the permissions necessary for specific roles and tasks. Create custom IAM policies with minimal permissions based on the principle of least privilege.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamRole,"The AWS-managed AdministratorAccess policy grants all actions for all AWS services and for all resources in the account and as such exposes the customer to a significant data leakage threat. It should be granted very conservatively. For granting access to 3rd party vendors, consider using alternative managed policies, such as ViewOnlyAccess or SecurityAudit."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/iam/iam_administrator_access_with_mfa/iam_administrator_access_with_mfa.metadata.json,,,iam,Ensure users of groups with AdministratorAccess policy have MFA tokens enabled,[],,Ensure users of groups with AdministratorAccess policy have MFA tokens enabled,,[],,['Infrastructure Security'],iam_administrator_access_with_mfa,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure this repository and its contents should be publicly accessible.', 'Url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsIamUser,Policy may allow Anonymous users to perform actions.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/networkfirewall/networkfirewall_deletion_protection/networkfirewall_deletion_protection.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-9,network-firewall,"Ensure that Deletion Protection safety feature is enabled for your Amazon VPC network firewalls in order to protect the firewalls from being accidentally deleted. By default, Deletion Protection is disabled for VPC network firewalls.",[],,Ensure that Deletion Protection safety feature is enabled for your Amazon VPC network firewalls.,,[],,[],networkfirewall_deletion_protection,"{'Code': {'CLI': 'aws network-firewall update-firewall-delete-protection --region <value> --firewall-name <value> --delete-protection', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that Deletion Protection safety feature is enabled for your Amazon VPC network firewalls.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-9'}}",medium,[],arn:partition:network-firewall::account-id:firewall/firewall-name,AwsNetworkFirewallFirewall,"Without a network firewall, it can be difficult to monitor and control traffic within the VPC. This can make it harder to detect and prevent attacks or unauthorized access to resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/networkfirewall/networkfirewall_in_all_vpc/networkfirewall_in_all_vpc.metadata.json,,https://docs.aws.amazon.com/network-firewall/latest/developerguide/setting-up.html,network-firewall,Ensure all VPCs have Network Firewall enabled,[],,Ensure all VPCs have Network Firewall enabled,,[],,[],networkfirewall_in_all_vpc,"{'Code': {'CLI': 'aws network-firewall create-firewall --firewall-name <value> --vpc-id <value>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/NetworkFirewall/network-firewall-in-use.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure all VPCs have Network Firewall enabled', 'Url': 'https://docs.aws.amazon.com/network-firewall/latest/developerguide/vpc-config.html'}}",medium,[],arn:partition:network-firewall::account-id:firewall/firewall-name,AwsEc2Vpc,"Without a network firewall, it can be difficult to monitor and control traffic within the VPC. This can make it harder to detect and prevent attacks or unauthorized access to resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/networkfirewall/networkfirewall_policy_rule_group_associated/networkfirewall_policy_rule_group_associated.metadata.json,,https://docs.aws.amazon.com/network-firewall/latest/developerguide/rule-groups.html,network-firewall,This control checks whether a Network Firewall policy has any stateful or stateless rule groups associated. The control fails if stateless or stateful rule groups are not assigned.,[],,Ensure Network Firewall Policies Have at Least One Rule Group Associated,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53'],networkfirewall_policy_rule_group_associated,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Regularly review your Network Firewall policies to ensure they have the necessary rule groups associated. Create and manage rule groups as needed to maintain effective traffic filtering and security.', 'Url': 'https://docs.aws.amazon.com/network-firewall/latest/developerguide/firewall-policy-updating.html'}}",medium,[],arn:partition:network-firewall::account-id:firewall-policy/policy-name,AwsNetworkFirewallFirewallPolicy,"If a Network Firewall policy does not have at least one rule group associated, it may fail to properly filter and handle traffic, leaving the network vulnerable to unauthorized access and attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/networkfirewall/networkfirewall_policy_default_action_full_packets/networkfirewall_policy_default_action_full_packets.metadata.json,,https://docs.aws.amazon.com/network-firewall/latest/developerguide/stateless-default-actions.html,network-firewall,Default stateless action for full packets must be set to drop or forward in AWS Network Firewall policy.,[],,NetworkFirewall firewall policy default action for full packets is set to drop or forward.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],networkfirewall_policy_default_action_full_packets,"{'Code': {'CLI': 'aws network-firewall update-firewall-policy --firewall-policy-arn <your-firewall-policy-arn> --stateless-default-actions aws:drop', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the firewall policy to ensure that full packets are either dropped or forwarded to stateful rule groups for further inspection, mitigating the risk of unauthorized traffic entering the network.', 'Url': 'https://docs.aws.amazon.com/network-firewall/latest/developerguide/firewall-policy-updating.html'}}",medium,[],arn:partition:network-firewall::account-id:firewall/firewall-name,AwsNetworkFirewallFirewall,"If the default stateless action for full packets is set to 'Pass', unintended traffic may bypass network filtering, leading to potential security vulnerabilities by allowing unauthorized or harmful packets."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/networkfirewall/networkfirewall_policy_default_action_fragmented_packets/networkfirewall_policy_default_action_fragmented_packets.metadata.json,,https://docs.aws.amazon.com/network-firewall/latest/developerguide/stateless-default-actions.html,network-firewall,NetorwFirewall firewall policy default action for fragmented packets is set to drop or forward.,[],,Default action for fragmented packets is set to drop or forward.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],networkfirewall_policy_default_action_fragmented_packets,"{'Code': {'CLI': 'aws network-firewall update-firewall-policy --firewall-policy-arn <your-firewall-policy-arn> --stateless-default-actions aws:drop', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-5', 'Terraform': ''}, 'Recommendation': {'Text': 'Update the firewall policy to ensure fragmented packets are either dropped or forwarded to stateful rule groups for additional filtering, reducing the risk of unwanted traffic entering the network.', 'Url': 'https://docs.aws.amazon.com/network-firewall/latest/developerguide/firewall-policy-updating.html'}}",medium,[],arn:partition:network-firewall::account-id:firewall/firewall-name,AwsNetworkFirewallFirewall,"If the default action for fragmented packets is set to 'Pass', unintended or potentially malicious traffic may bypass filtering, exposing the network to security threats."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/networkfirewall/networkfirewall_logging_enabled/networkfirewall_logging_enabled.metadata.json,,https://docs.aws.amazon.com/network-firewall/latest/developerguide/firewall-logging.html,network-firewall,This control checks whether logging is enabled for an AWS Network Firewall firewall. The control fails if logging isn't enabled for at least one log type or if the logging destination doesn't exist.,['logging'],,Ensure Network Firewall Logging is Enabled,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53'],networkfirewall_logging_enabled,"{'Code': {'CLI': 'aws network-firewall update-logging-configuration --firewall-arn <firewall-arn> --logging-configuration <configuration>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logging for your AWS Network Firewall by updating its logging configuration to ensure comprehensive tracking of network traffic and facilitate better incident response and auditing capabilities.', 'Url': 'https://docs.aws.amazon.com/network-firewall/latest/developerguide/firewall-update-logging-configuration.html'}}",medium,[],arn:partition:network-firewall::account-id:firewall/firewall-name,AwsNetworkFirewallFirewall,"Failing to enable logging on an AWS Network Firewall can lead to a lack of visibility into network traffic, making it difficult to monitor and respond to security incidents effectively, which could jeopardize the security and integrity of your infrastructure."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/networkfirewall/networkfirewall_multi_az/networkfirewall_multi_az.metadata.json,,https://docs.aws.amazon.com/network-firewall/latest/developerguide/arch-two-zone-igw.html,network-firewall,Ensure all Network Firewall Firewalls are deployed in at least 2 Availability Zones.,['redundancy'],,Ensure all Network Firewall Firewalls are deployed across multiple AZ.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],networkfirewall_multi_az,"{'Code': {'CLI': 'aws network-firewall update-firewall-delete-protection --firewall-arn <your-firewall-arn> --firewall-name <your-firewall-name> --subnet-mappings SubnetId=<subnet-id-1>,SubnetId=<subnet-id-2>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/networkfirewall-controls.html#networkfirewall-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Deploy your AWS Network Firewall across multiple Availability Zones to enhance availability, ensure traffic load balancing, and minimize the impact of any AZ-specific failures.', 'Url': 'https://aws.amazon.com/es/blogs/networking-and-content-delivery/deployment-models-for-aws-network-firewall/'}}",medium,[],arn:partition:network-firewall::account-id:firewall/firewall-name,AwsNetworkFirewallFirewall,"Deploying a Network Firewall in a single Availability Zone increases the risk of service disruption if that AZ experiences an outage, potentially leaving your network vulnerable to attacks or downtime."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eks/eks_cluster_network_policy_enabled/eks_cluster_network_policy_enabled.metadata.json,,https://docs.aws.amazon.com/eks/latest/userguide/eks-networking-add-ons.html,eks,"Ensure that Network Policy is enabled and set as appropriate in Amazon EKS clusters. Network Policy provides pod-level firewalling to restrict traffic between sources, enhancing network security within the cluster.",['internet-exposed'],Enabling Network Policy may cause a rolling update of all cluster nodes and consumes additional resources.,Ensure Network Policy is Enabled and Set as Appropriate,,[],,"['Security', 'Configuration']",eks_cluster_network_policy_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EKS/security-groups.html', 'Terraform': 'https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_1#terraform'}, 'Recommendation': {'Text': 'Enable and configure Network Policy to enhance network security within the EKS cluster.', 'Url': 'https://docs.aws.amazon.com/eks/latest/userguide/eks-networking-add-ons.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEksCluster,"Without proper Network Policy settings, pods within the cluster may be vulnerable to unauthorized access and communication."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eks/eks_cluster_kms_cmk_encryption_in_secrets_enabled/eks_cluster_kms_cmk_encryption_in_secrets_enabled.metadata.json,,,eks,Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs),['encryption'],,Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs),,[],,"['Protect', 'Data protection']",eks_cluster_kms_cmk_encryption_in_secrets_enabled,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_3#fix---builtime', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EKS/enable-envelope-encryption.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Setup your own Customer Master Key (CMK) in KMS and link this key by providing the CMK ARN when you create an EKS cluster.', 'Url': 'https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEksCluster,Implementing envelope encryption is considered a security best practice for applications that store sensitive data and is part of a defense in depth security strategy.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eks/eks_cluster_uses_a_supported_version/eks_cluster_uses_a_supported_version.metadata.json,,https://docs.aws.amazon.com/eks/latest/userguide/platform-versions.html,eks,Ensure Kubernetes cluster runs on a supported Kubernetes version,['vulnerabilities'],,Ensure Kubernetes cluster runs on a supported Kubernetes version,,[],,[],eks_cluster_uses_a_supported_version,"{'Code': {'CLI': 'aws eks update-cluster-version --region <region> --name <cluster_name> --kubernetes-version <latest_supported_version>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EKS/kubernetes-version.html', 'Terraform': ''}, 'Recommendation': {'Text': ""If your application doesn't require a specific version of Kubernetes, we recommend that you use the latest available Kubernetes version that is supported by EKS for your clusters."", 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-2'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEksCluster,Running an Amazon EKS cluster on an unsupported Kubernetes version exposes it to common security vulnerabilities
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eks/eks_cluster_not_publicly_accessible/eks_cluster_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/eks-controls.html#eks-1,eks,Ensure that your Amazon EKS cluster's Kubernetes API server endpoint is not publicly accessible from the Internet in order to avoid exposing private data and minimizing security risks.,['internet-exposed'],,Ensure EKS Clusters are not publicly accessible,"['eks_endpoints_not_publicly_accessible', 'eks_control_plane_endpoint_access_restricted']",[],,['Software and Configuration Checks/AWS Security Best Practices/Network Reachability'],eks_cluster_not_publicly_accessible,"{'Code': {'CLI': 'aws eks update-cluster-config --region <region_name> --name <cluster_name> --resources-vpc-config endpointPublicAccess=false,endpointPrivateAccess=true,publicAccessCidrs=[""123.123.123.123/32""]', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EKS/endpoint-access.html', 'Terraform': ''}, 'Recommendation': {'Text': ""Restricting public access to the Kubernetes API endpoint managed by the EKS cluster is a security best practice that helps protect your cluster from unauthorized access and potential security threats. By not allowing public access to the cluster's Kubernetes API endpoint, you ensure that only authorized entities can interact with your Amazon EKS cluster."", 'Url': 'https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEksCluster,"By default, this API server endpoint is publicly accessible, meaning any machine on the internet can potentially connect to your EKS cluster using its public endpoint. This exposes your cluster to a higher risk of malicious activities and attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eks/eks_cluster_private_nodes_enabled/eks_cluster_private_nodes_enabled.metadata.json,,https://docs.aws.amazon.com/eks/latest/userguide/private-clusters.html,eks,"Ensure that clusters are created with private nodes, disabling public IP addresses for cluster nodes. Private nodes have no public IP addresses, restricting access to internal networks and enhancing security.",['internet-exposed'],"Enabling private nodes restricts outbound access to the public internet. If outbound internet access is required, Cloud NAT or a NAT gateway can be used.",Ensure Clusters are created with Private Nodes,,[],,"['Security', 'Configuration']",eks_cluster_private_nodes_enabled,"{'Code': {'CLI': 'aws eks update-cluster-config --region region-code --name my-cluster --resources-vpc-config endpointPrivateAccess=true', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Update the cluster configuration to enable private nodes, disabling public IP addresses for cluster nodes.', 'Url': 'https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html'}}",high,[],,AwsEksCluster,"Without private nodes, cluster nodes may have public IP addresses, increasing the attack surface and exposing them to potential threats from the internet."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/eks/eks_control_plane_logging_all_types_enabled/eks_control_plane_logging_all_types_enabled.metadata.json,,,eks,Ensure EKS Control Plane Logging is enabled for all required log types,"['forensics-ready', 'logging']",,Ensure EKS Control Plane Logging is enabled for all required log types,,[],,['Logging and Monitoring'],eks_control_plane_logging_all_types_enabled,"{'Code': {'CLI': 'aws eks update-cluster-config --region <region_name> --name <cluster_name> --logging \'{""clusterLogging"":[{""types"":[""api"",""audit"",""authenticator"",""controllerManager"",""scheduler""],""enabled"":true}]}\'', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_4#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/kubernetes-policies-1/bc_aws_kubernetes_4#fix---buildtime'}, 'Recommendation': {'Text': 'Make sure logging for EKS control plane is enabled for all required log types.', 'Url': 'https://docs.aws.amazon.com/eks/latest/userguide/logging-monitoring.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEksCluster,"If logs are not enabled, monitoring of service use or threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigatewayv2/apigatewayv2_api_access_logging_enabled/apigatewayv2_api_access_logging_enabled.metadata.json,,,apigateway,Ensure API Gateway V2 has Access Logging enabled.,['logging'],,Ensure API Gateway V2 has Access Logging enabled.,['apigatewayv2_access_logging_enabled'],[],,['IAM'],apigatewayv2_api_access_logging_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_30#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_30#cloudformation'}, 'Recommendation': {'Text': 'Monitoring is an important part of maintaining the reliability, availability and performance of API Gateway and your AWS solutions. You should collect monitoring data from all of the parts of your AWS solution. CloudTrail provides a record of actions taken by a user, role, or an AWS service in API Gateway. Using the information collected by CloudTrail, you can determine the request that was made to API Gateway, the IP address from which the request was made, who made the request, etc.', 'Url': 'https://docs.aws.amazon.com/apigateway/latest/developerguide/security-monitoring.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayV2Api,If no authorizer is enabled anyone can use the service.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigatewayv2/apigatewayv2_api_authorizers_enabled/apigatewayv2_api_authorizers_enabled.metadata.json,,,apigateway,Checks if API Gateway V2 has configured authorizers.,[],,Checks if API Gateway V2 has configured authorizers.,['apigatewayv2_authorizers_enabled'],[],,['Logging and Monitoring'],apigatewayv2_api_authorizers_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Implement Amazon Cognito or a Lambda function to control access to your API', 'Url': 'https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayV2Api,If no authorizer is enabled anyone can use the service.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/drs/drs_job_exist/drs_job_exist.metadata.json,,https://docs.aws.amazon.com/drs/latest/userguide/what-is-drs.html,drs,Ensure DRS is enabled with jobs.,[],,Ensure DRS is enabled with jobs.,,[],,[],drs_job_exist,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure DRS is enabled with jobs.', 'Url': 'https://docs.aws.amazon.com/drs/latest/userguide/what-is-drs.html'}}",medium,[],arn:aws:drs:region:account-id:job/job-id,Other,"If DRS is not enabled with jobs, then it may not be able to recover from a disaster."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_cluster_is_public/kafka_cluster_is_public.metadata.json,,https://docs.aws.amazon.com/msk/latest/developerguide/client-access.html,kafka,"The Kafka cluster is publicly accessible, which can expose sensitive data and increase the attack surface.",['internet-exposed'],,Kafka Cluster Exposed to the Public,,[],cluster,[],kafka_cluster_is_public,"{'Code': {'CLI': 'aws kafka update-connectivity --cluster-arn cluster_arn --current-version kafka_version --connectivity-info \'{""PublicAccess"": {""Type"": ""DISABLED""}}\'', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/public-access-msk-cluster.html', 'Terraform': ''}, 'Recommendation': {'Text': 'It is recommended to restrict access to the Kafka cluster to only authorized entities. Enable encryption for data in transit and at rest to protect sensitive information.', 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/public-access.html'}}",high,[],arn:partition:kafka:region:account-id:cluster,AwsMskCluster,"Exposing the Kafka cluster to the public can lead to unauthorized access, data breaches, and potential security threats."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_cluster_mutual_tls_authentication_enabled/kafka_cluster_mutual_tls_authentication_enabled.metadata.json,,https://docs.aws.amazon.com/msk/latest/developerguide/msk-authentication.html,kafka,"Mutual TLS Authentication ensures that both the client and the server are authenticated, providing an additional layer of security for communication within the Kafka cluster.",[],,Ensure Mutual TLS Authentication is Enabled for Kafka Cluster,,[],cluster,[],kafka_cluster_mutual_tls_authentication_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/enable-mutual-tls-authentication-for-kafka-clients.html', 'Terraform': ''}, 'Recommendation': {'Text': 'It is recommended to enable Mutual TLS Authentication for your Kafka cluster to ensure secure communication between clients and brokers.', 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/msk-update-security.html'}}",medium,[],arn:partition:kafka:region:account-id:cluster,AwsMskCluster,"Without Mutual TLS Authentication, the cluster is vulnerable to man-in-the-middle attacks, and unauthorized clients may be able to access the cluster."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_cluster_unrestricted_access_disabled/kafka_cluster_unrestricted_access_disabled.metadata.json,,https://docs.aws.amazon.com/msk/latest/developerguide/msk-configure-security.html,kafka,Kafka Clusters should not have unrestricted access enabled. Unrestricted access allows anyone to access the Kafka Cluster without any authentication. It is recommended to disable unrestricted access to prevent unauthorized access to the Kafka Cluster.,[],,Ensure Kafka Cluster has unrestricted access disabled,,[],cluster,[],kafka_cluster_unrestricted_access_disabled,"{'Code': {'CLI': ""aws kafka update-security --region region_name --cluster-arn cluster_arn --current-version kafka_version_of_cluster --client-authentication 'Unauthenticated={Enabled=false}'"", 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/unrestricted-access-to-brokers.html', 'Terraform': ''}, 'Recommendation': {'Text': ""It is recommended to restrict access to Kafka Clusters to only authorized entities. Ensure that the Kafka Cluster's security settings are properly configured to prevent unauthorized access."", 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/security.html'}}",high,[],arn:partition:kafka:region:account-id:cluster,AwsMskCluster,Unrestricted access to Kafka Clusters can lead to unauthorized access to the cluster and its data. It is recommended to restrict access to Kafka Clusters to only authorized entities.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_cluster_enhanced_monitoring_enabled/kafka_cluster_enhanced_monitoring_enabled.metadata.json,,https://docs.aws.amazon.com/msk/latest/developerguide/monitoring.html,kafka,"Enhanced monitoring provides additional visibility into the performance and behavior of MSK (Kafka) brokers. By enabling enhanced monitoring, you can gain insights into potential issues and optimize the performance of your Kafka clusters.",[],,Ensure Enhanced Monitoring is Enabled for MSK (Kafka) Brokers,,[],cluster,[],kafka_cluster_enhanced_monitoring_enabled,"{'Code': {'CLI': 'aws kafka update-monitoring --region region_cluster --cluster-arn arn_cluster --current-version version_cluster --enhanced-monitoring PER_BROKER', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/enable-enhanced-monitoring-for-apache-kafka-brokers.html#', 'Terraform': ''}, 'Recommendation': {'Text': 'It is recommended to enable enhanced monitoring for MSK (Kafka) brokers to gain deeper insights into the performance and behavior of your clusters.', 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/metrics-details.html'}}",medium,[],arn:partition:kafka:region:account-id:cluster,AwsMskCluster,"Without enhanced monitoring, you may have limited visibility into the performance and health of your MSK brokers, which could lead to undetected issues and potential performance degradation."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_cluster_encryption_at_rest_uses_cmk/kafka_cluster_encryption_at_rest_uses_cmk.metadata.json,,https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html,kafka,Kafka Cluster data stored at rest should be encrypted using Customer Managed Keys (CMK) for enhanced security and control over the encryption process.,[],,Ensure Kafka Cluster Encryption at Rest Uses Customer Managed Keys (CMK),,[],Kafka Cluster,['Infrastructure Security'],kafka_cluster_encryption_at_rest_uses_cmk,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/msk-encryption-at-rest-with-cmk.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_32/#terraform'}, 'Recommendation': {'Text': 'It is recommended to use Customer Managed Keys (CMK) for Kafka Cluster encryption at rest to maintain control and flexibility over the encryption process.', 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/msk-working-with-encryption.html'}}",medium,[],arn:partition:kafka:region:account-id:cluster,AwsMskCluster,"Using default AWS-managed encryption keys might not meet certain compliance or regulatory requirements. With CMKs, you have more control over the encryption process and can rotate keys, define access policies, and enable key auditing."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_cluster_uses_latest_version/kafka_cluster_uses_latest_version.metadata.json,,https://docs.aws.amazon.com/lightsail/latest/userguide/amazon-lightsail-databases.html,kafka,"Ensure that your Amazon Managed Streaming for Apache Kafka (MSK) cluster is using the latest version to benefit from the latest security features, bug fixes, and performance improvements.",[],,MSK cluster should use the latest version.,,[],cluster,['Infrastructure Security'],kafka_cluster_uses_latest_version,"{'Code': {'CLI': 'aws kafka update-cluster-configuration --cluster-arn <arn_cluster> --current-version <current_version> --target-version <latest_version>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/enable-apache-kafka-latest-security-features.html', 'Terraform': ''}, 'Recommendation': {'Text': 'To upgrade your Amazon MSK cluster to the latest version, use the AWS Management Console, AWS CLI, or SDKs to update the cluster configuration. For more information, refer to the official Amazon MSK documentation.', 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/version-support.html#version-upgrades'}}",medium,[],arn:partition:kafka:region:account-id:cluster,AwsMskCluster,"Running an outdated version of Amazon MSK may expose your cluster to security vulnerabilities, bugs, and performance issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_cluster_in_transit_encryption_enabled/kafka_cluster_in_transit_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html,kafka,"Kafka clusters should have encryption in transit enabled to protect data as it travels across the network. This ensures that data is encrypted when transmitted between clients and brokers, preventing unauthorized access or data breaches.",[],,Ensure Kafka Cluster Encryption in Transit is Enabled,,[],cluster,['Infrastructure Security'],kafka_cluster_in_transit_encryption_enabled,"{'Code': {'CLI': 'aws kafka create-cluster --cluster-name <CLUSTER_NAME> --broker-node-group-info <NODE_JSON> --encryption-info <INFO_JSON> --kafka-version <VERSION> --number-of-broker-nodes <NUMBER>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MSK/encryption-in-transit-for-msk.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_32/#terraform'}, 'Recommendation': {'Text': 'It is recommended to enable encryption in transit for Kafka clusters to protect data confidentiality and integrity.', 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/msk-working-with-encryption.html'}}",medium,[],arn:partition:kafka:region:account-id:cluster,AwsMskCluster,"If encryption in transit is not enabled, data transmitted over the network could be vulnerable to eavesdropping or man-in-the-middle attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/kafka/kafka_connector_in_transit_encryption_enabled/kafka_connector_in_transit_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/msk/latest/developerguide/msk-connect.html,kafka,This control checks whether an Amazon MSK Connect connector is encrypted in transit. This control fails if the connector isn't encrypted in transit.,['encryption'],,MSK Connect connectors should be encrypted in transit,,[],,['Software and Configuration Checks/AWS Security Best Practices'],kafka_connector_in_transit_encryption_enabled,"{'Code': {'CLI': ""aws kafkaconnect create-connector --encryption-in-transit-config 'EncryptionInTransitType=TLS'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/msk-controls.html#msk-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable encryption in transit for MSK Connect connectors to secure data as it moves across networks.', 'Url': 'https://docs.aws.amazon.com/msk/latest/developerguide/mkc-create-connector-intro.html'}}",medium,[],arn:aws:kafkaconnect:{region}:{account-id}:connector/{connector-name}/{connector-id},Other,Data in transit can be intercepted or eavesdropped on by unauthorized users. Ensuring encryption in transit helps to protect sensitive data as it moves between nodes in a network or from your MSK cluster to connected applications.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/appsync/appsync_field_level_logging_enabled/appsync_field_level_logging_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/appsync-logging-enabled.html,appsync,This control checks whether an AWS AppSync API (only GraphQL APIs since boto3 doesnt have a method to return other APIs) field-level logging turned on. The control fails if the field resolver log level is set to None.,['logging'],,AWS AppSync should have field-level logging enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices'],appsync_field_level_logging_enabled,"{'Code': {'CLI': 'aws appsync update-graphql-api --api-id <api-id> --log-config fieldLogLevel=<fieldLoggingLevel>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable field-level logging for your AWS AppSync API to monitor and troubleshoot GraphQL queries effectively.', 'Url': 'https://docs.aws.amazon.com/appsync/latest/devguide/monitoring.html#setup-and-configuration'}}",medium,[],arn:aws:appsync:{region}:{account-id}:apis/{api-id},AwsAppSyncGraphQLApi,"Without field-level logging enabled, it's difficult to monitor, troubleshoot, and optimize GraphQL API queries effectively."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/appsync/appsync_graphql_api_no_api_key_authentication/appsync_graphql_api_no_api_key_authentication.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/appsync-authorization-check.html,appsync,This control checks whether your application uses an API key to interact with an AWS AppSync GraphQL API. The control fails if an AWS AppSync GraphQL API is authenticated with an API key.,['trustboundaries'],,AWS AppSync GraphQL APIs should not be authenticated with API keys,,[],,['Software and Configuration Checks/AWS Security Best Practices'],appsync_graphql_api_no_api_key_authentication,"{'Code': {'CLI': 'aws appsync update-graphql-api --api-id <api-id> --authentication-type <authentication-type>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-5', 'Terraform': ''}, 'Recommendation': {'Text': 'Use authentication methods other than API keys for AWS AppSync GraphQL APIs, such as AWS_IAM or Amazon Cognito.', 'Url': 'https://docs.aws.amazon.com/appsync/latest/devguide/security-authz.html'}}",high,[],arn:aws:appsync:{region}:{account-id}:apis/{api-id},AwsAppSyncGraphQLApi,API keys in AppSync can expose applications to unauthorized access if compromised. Avoiding API keys helps reduce the risk of unintended access.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dlm/dlm_ebs_snapshot_lifecycle_policy_exists/dlm_ebs_snapshot_lifecycle_policy_exists.metadata.json,,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/snapshot-lifecycle.html#dlm-elements,dlm,Ensure EBS Snapshot lifecycle policies are defined.,['forensics-ready'],,Ensure EBS Snapshot lifecycle policies are defined.,,[],ebs,['Data Protection'],dlm_ebs_snapshot_lifecycle_policy_exists,"{'Code': {'CLI': 'aws dlm create-lifecycle-policy --region <region> --execution-role-arn <execution-role-arn> --description <description> --state ENABLED --policy-details file://lifecycle-policy-config.json', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/DLM/ebs-snapshot-automation.html', 'Terraform': ''}, 'Recommendation': {'Text': 'To use Amazon Data Lifecycle Manager (DLM) service to manage the lifecycle of your EBS volume snapshots, you have to tag your AWS EBS volumes and create data lifecycle policies via Amazon DLM.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/snapshot-lifecycle.html#dlm-elements'}}",medium,[],arn:aws:iam::account-id:resource-id,Other,"With AWS DLM service, you can manage the lifecycle of your EBS volume snapshots. By automating the EBS volume backup management using lifecycle policies, you can protect your EBS data by enforcing a regular backup schedule, retain backups as required by auditors or internal compliance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/waf/waf_regional_rule_with_conditions/waf_regional_rule_with_conditions.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/waf-regional-rule-not-empty.html,waf,Ensure that every AWS WAF Classic Regional Rule contains at least one condition.,[],,AWS WAF Classic Regional Rules Should Have at Least One Condition.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],waf_regional_rule_with_conditions,"{'Code': {'CLI': 'aws waf-regional update-rule --rule-id <your-rule-id> --change-token <your-change-token> --updates \'[{""Action"":""INSERT"",""Predicate"":{""Negated"":false,""Type"":""IPMatch"",""DataId"":""<your-ipset-id>""}}]\' --region <your-region>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that every AWS WAF Classic Regional rule has at least one condition to properly inspect and manage web traffic.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/classic-web-acl-rules-editing.html'}}",medium,[],arn:aws:waf-regional:region:account-id:rule/rule-id,AwsWafRegionalRule,"An AWS WAF Classic Regional rule without any conditions cannot inspect or filter traffic, potentially allowing malicious requests to pass unchecked."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/waf/waf_global_rulegroup_not_empty/waf_global_rulegroup_not_empty.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-groups.html,waf,Ensure that every AWS WAF Classic Global rule group contains at least one rule.,[],,Check if AWS WAF Classic Global rule group has at least one rule.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],waf_global_rulegroup_not_empty,"{'Code': {'CLI': 'aws waf update-rule-group --rule-group-id <rule-group-id> --updates Action=INSERT,ActivatedRule={Priority=1,RuleId=<rule-id>,Action={Type=BLOCK}} --change-token <change-token> --region <region>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-7', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that every AWS WAF Classic Global rule group contains at least one rule to enforce traffic inspection and defined actions such as allow, block, or count.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/classic-rule-group-editing.html'}}",medium,[],arn:aws:waf::account-id:rulegroup/rule-group-name/rule-group-id,AwsWafRuleGroup,"A WAF Classic Global rule group without any rules allows all incoming traffic to bypass inspection, increasing the risk of unauthorized access and potential attacks on resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/waf/waf_global_webacl_with_rules/waf_global_webacl_with_rules.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/waf-rules.html,waf,Ensure that every AWS WAF Classic Global WebACL contains at least one rule or rule group.,[],,Check if AWS WAF Classic Global WebACL has at least one rule or rule group.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],waf_global_webacl_with_rules,"{'Code': {'CLI': 'aws waf update-web-acl --web-acl-id <your-web-acl-id> --change-token <your-change-token> --updates \'[{""Action"":""INSERT"",""ActivatedRule"":{""Priority"":1,""RuleId"":""<your-rule-id>"",""Action"":{""Type"":""BLOCK""}}}]\' --default-action Type=ALLOW --region <your-region>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-8', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that every AWS WAF Classic Global web ACL includes at least one rule or rule group to monitor and control web traffic effectively.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/classic-web-acl-editing.html'}}",medium,[],arn:aws:waf:account-id:webacl/web-acl-id,AwsWafWebAcl,"An empty AWS WAF Classic Global web ACL allows all web traffic to bypass inspection, potentially exposing resources to unauthorized access and attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/waf/waf_global_webacl_logging_enabled/waf_global_webacl_logging_enabled.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/classic-waf-incident-response.html,waf,Ensure that every AWS WAF Classic Global WebACL has logging enabled.,[],,Check if AWS WAF Classic Global WebACL has logging enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],waf_global_webacl_logging_enabled,"{'Code': {'CLI': 'aws waf put-logging-configuration --logging-configuration ResourceArn=<web-acl-arn>,LogDestinationConfigs=<log-destination-arn>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_31/', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure logging is enabled for AWS WAF Classic Global Web ACLs to capture traffic details and maintain compliance.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/classic-logging.html'}}",medium,[],arn:aws:waf:account-id:webacl/web-acl-id,AwsWafWebAcl,"Without logging enabled, there is no visibility into traffic patterns or potential security threats, which limits the ability to troubleshoot and monitor web traffic effectively."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/waf/waf_regional_rulegroup_not_empty/waf_regional_rulegroup_not_empty.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-groups.html,waf,Ensure that every AWS WAF Classic Regional rule group contains at least one rule.,[],,Check if AWS WAF Classic Regional rule group has at least one rule.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],waf_regional_rulegroup_not_empty,"{'Code': {'CLI': 'aws waf-regional update-rule-group --rule-group-id <rule-group-id> --updates Action=INSERT,ActivatedRule={Priority=1,RuleId=<rule-id>,Action={Type=BLOCK}} --change-token <change-token> --region <region>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that every AWS WAF Classic Regional rule group contains at least one rule to enforce traffic inspection and defined actions such as allow, block, or count.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/classic-rule-group-editing.html'}}",medium,[],arn:aws:waf::account-id:rulegroup/rule-group-name/rule-group-id,AwsWafRegionalRuleGroup,"A WAF Classic Regional rule group without any rules allows all incoming traffic to bypass inspection, increasing the risk of unauthorized access and potential attacks on resources."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/waf/waf_global_rule_with_conditions/waf_global_rule_with_conditions.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/waf-global-rule-not-empty.html,waf,Ensure that every AWS WAF Classic Global Rule contains at least one condition.,[],,AWS WAF Classic Global Rules Should Have at Least One Condition.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],waf_global_rule_with_conditions,"{'Code': {'CLI': 'aws waf update-rule --rule-id <your-rule-id> --change-token <your-change-token> --updates \'[{""Action"":""INSERT"",""Predicate"":{""Negated"":false,""Type"":""IPMatch"",""DataId"":""<your-ipset-id>""}}]\' --region <your-region>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that every AWS WAF Classic Global rule has at least one condition to properly inspect and manage web traffic.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/classic-web-acl-rules-editing.html'}}",medium,[],arn:aws:waf:account-id:rule/rule-id,AwsWafRule,"An AWS WAF Classic Global rule without any conditions cannot inspect or filter traffic, potentially allowing malicious requests to pass unchecked."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/waf/waf_regional_webacl_with_rules/waf_regional_webacl_with_rules.metadata.json,,https://docs.aws.amazon.com/waf/latest/developerguide/waf-rules.html,waf,Ensure that every AWS WAF Classic Regional WebACL contains at least one rule or rule group.,[],,Check if AWS WAF Classic Regional WebACL has at least one rule or rule group.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],waf_regional_webacl_with_rules,"{'Code': {'CLI': 'aws waf-regional update-web-acl --web-acl-id <your-web-acl-id> --change-token <your-change-token> --updates \'[{""Action"":""INSERT"",""ActivatedRule"":{""Priority"":1,""RuleId"":""<your-rule-id>"",""Action"":{""Type"":""BLOCK""}}}]\' --default-action Type=ALLOW --region <your-region>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/waf-controls.html#waf-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that every AWS WAF Classic Regional web ACL includes at least one rule or rule group to monitor and control web traffic effectively.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/classic-web-acl-editing.html'}}",medium,[],arn:aws:waf-regional:region:account-id:webacl/web-acl-id,AwsWafRegionalWebAcl,"An empty AWS WAF Classic Regional web ACL allows all web traffic to bypass inspection, potentially exposing resources to unauthorized access and attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directconnect/directconnect_connection_redundancy/directconnect_connection_redundancy.metadata.json,,https://docs.aws.amazon.com/awssupport/latest/user/fault-tolerance-checks.html#amazon-direct-connect-location-resiliency,directconnect,Checks the resilience of the AWS Direct Connect used to connect your on-premises.,['redundancy'],,Ensure Direct Connect connections are redundant,,[],,['Resilience'],directconnect_connection_redundancy,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To build Direct Connect location resiliency, you should have at least two connections from at least two distinct Direct Connect locations.', 'Url': 'https://aws.amazon.com/directconnect/resiliency-recommendation/'}}",medium,[],arn:partition:directconnect:region:account-id:directconnect/resource-id,,"This check alerts you if any Direct Connect connections are not redundant and the connections are coming from two distinct Direct Connect locations. Lack of location resiliency can result in unexpected downtime during maintenance, a fiber cut, a device failure, or a complete location failure."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/directconnect/directconnect_virtual_interface_redundancy/directconnect_virtual_interface_redundancy.metadata.json,,https://docs.aws.amazon.com/awssupport/latest/user/fault-tolerance-checks.html#amazon-direct-connect-location-resiliency,directconnect,Checks the resilience of the AWS Direct Connect used to connect your on-premises to each Direct Connect gateway or virtual private gateway.,['redundancy'],,Ensure Direct Connect virtual interface(s) are providing redundant connections,,[],,['Resilience'],directconnect_virtual_interface_redundancy,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To build Direct Connect location resiliency, you can configure the Direct Connect gateway or virtual private gateway to connect to at least two distinct Direct Connect locations.', 'Url': 'https://aws.amazon.com/directconnect/resiliency-recommendation/'}}",medium,[],arn:partition:directconnect:region:account-id:directconnect/resource-id,,"This check alerts you if any Direct Connect gateway or virtual private gateway isn't configured with virtual interfaces across at least two distinct Direct Connect locations. Lack of location resiliency can result in unexpected downtime during maintenance, a fiber cut, a device failure, or a complete location failure."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/mq/mq_broker_not_publicly_accessible/mq_broker_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/using-amazon-mq-securely.html#prefer-brokers-without-public-accessibility,mq,Brokers created without public accessibility can't be accessed from outside of your VPC. This greatly reduces your broker's susceptibility to Distributed Denial of Service (DDoS) attacks from the public internet.,['internet-exposed'],,MQ brokers should not be publicly accessible.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],mq_broker_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MQ/publicly-accessible.html#', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that the Amazon MQ brokers provisioned in your AWS account are not publicly accessible from the Internet in order to avoid exposing sensitive data and minimize security risks.', 'Url': 'https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/using-amazon-mq-securely.html#prefer-brokers-without-public-accessibility'}}",medium,[],arn:aws:mq:region:account-id:broker:broker-id,AwsAmazonMQBroker,"Public Amazon MQ brokers can be accessed directly, outside of a Virtual Private Cloud (VPC), therefore every machine on the Internet can reach your brokers through their public endpoints and this can increase the opportunity for malicious activity such as cross-site scripting (XSS) and clickjacking attacks. "
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/mq/mq_broker_active_deployment_mode/mq_broker_active_deployment_mode.metadata.json,,https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/amazon-mq-basic-elements.html,mq,Ensure Amazon MQ Apache ActiveMQ brokers are configured in active/standby mode for high availability and fault tolerance.,['redundancy'],,Apache ActiveMQ brokers should be configured in active/standby mode.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],mq_broker_active_deployment_mode,"{'Code': {'CLI': 'aws mq create-broker --broker-name <broker-name> --engine-type ActiveMQ --deployment-mode ACTIVE_STANDBY_MULTI_AZ', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-5', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MQ/deployment-mode.html'}, 'Recommendation': {'Text': 'Ensure Amazon MQ Apache ActiveMQ brokers use active/standby deployment mode for high availability and fault tolerance.', 'Url': 'https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/amazon-mq-broker-architecture.html#active-standby-broker-deployment'}}",low,[],arn:aws:mq:region:account-id:broker:broker-id,AwsAmazonMQBroker,"Apache ActiveMQ brokers not configured in active/standby mode lack high availability, increasing the risk of downtime and data loss during failures."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/mq/mq_broker_cluster_deployment_mode/mq_broker_cluster_deployment_mode.metadata.json,,https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/rabbitmq-basic-elements.html,mq,Ensure that RabbitMQ Brokers use cluster deployment mode.,['redundancy'],,MQ RabbitMQ Brokers should use cluster deployment mode.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],mq_broker_cluster_deployment_mode,"{'Code': {'CLI': 'aws mq create-broker --broker-name <your-broker-name> --engine-type RabbitMQ --deployment-mode CLUSTER_MULTI_AZ', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure RabbitMQ brokers are deployed in cluster mode to enhance resilience and prevent data loss during failures.', 'Url': 'https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/rabbitmq-broker-architecture.html#rabbitmq-broker-architecture-cluster'}}",low,[],arn:aws:mq:region:account-id:broker:broker-id,AwsAmazonMQBroker,"Using a single-instance RabbitMQ broker limits fault tolerance and high availability. Without cluster deployment, broker failures could lead to significant downtime and potential data loss."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/mq/mq_broker_auto_minor_version_upgrades/mq_broker_auto_minor_version_upgrades.metadata.json,,https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/upgrading-brokers.html#upgrading-brokers-automatic-upgrades,mq,Ensure that automatic minor version upgrades are enabled on Amazon MQ brokers.,[],,MQ Broker Auto Minor Version Upgrades should be enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],mq_broker_auto_minor_version_upgrades,"{'Code': {'CLI': 'aws mq update-broker --broker-id <broker-id> --auto-minor-version-upgrade', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-mqbrokers-minor-version-updates-are-enabled/', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-3', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MQ/auto-minor-version-upgrade.html'}, 'Recommendation': {'Text': 'Ensure that automatic minor version upgrades are enabled on Amazon MQ brokers to receive the latest security patches and improvements automatically.', 'Url': 'https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/upgrading-brokers.html#upgrading-brokers-automatic-upgrades.html'}}",low,[],arn:aws:mq:region:account-id:broker:broker-id,AwsAmazonMQBroker,"Amazon MQ brokers without automatic minor version upgrades may miss critical updates, leaving them vulnerable to security risks, bugs, and performance issues."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/mq/mq_broker_logging_enabled/mq_broker_logging_enabled.metadata.json,,https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/security-logging-monitoring.html,mq,Ensure MQ brokers are configured to stream audit logs to CloudWatch to enhance monitoring and detect security-related issues.,['logging'],,MQ brokers should stream audit logs to CloudWatch.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],mq_broker_logging_enabled,"{'Code': {'CLI': ""aws mq update-broker --broker-id <broker-id> --logs 'audit=true'"", 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_10/#terraform', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/mq-controls.html#mq-2', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/MQ/log-exports.html'}, 'Recommendation': {'Text': 'Ensure MQ brokers are configured to stream audit logs to CloudWatch to enhance monitoring and detect security-related issues.', 'Url': 'https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/configure-logging-monitoring-activemq.html'}}",medium,[],arn:aws:mq:region:account-id:broker:broker-id,AwsAmazonMQBroker,"Without streaming audit logs to CloudWatch, monitoring and alerting on suspicious activity or security incidents is limited. This reduces visibility into the broker's operations and potential security breaches."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_peering_routing_tables_with_least_privilege/vpc_peering_routing_tables_with_least_privilege.metadata.json,,https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/VPC/vpc-peering-access.html#,vpc,Ensure routing tables for VPC peering are least access.,[],,Ensure routing tables for VPC peering are least access.,,[],route_table,['Infrastructure Security'],vpc_peering_routing_tables_with_least_privilege,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_5', 'Terraform': ''}, 'Recommendation': {'Text': 'Review routing tables of peered VPCs for whether they route all subnets of each VPC and whether that is necessary to accomplish the intended purposes for peering the VPCs.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/peering/peering-configurations-partial-access.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2VpcPeeringConnection,Being highly selective in peering routing tables is a very effective way of minimizing the impact of breach as resources outside of these routes are inaccessible to the peered VPC.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_subnet_no_public_ip_by_default/vpc_subnet_no_public_ip_by_default.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/subnet-auto-assign-public-ip-disabled.html,vpc,Ensure VPC subnets do not assign public IP by default,[],,Ensure VPC subnets do not assign public IP by default,,[],subnet,['Infrastructure Security'],vpc_subnet_no_public_ip_by_default,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default#terraform'}, 'Recommendation': {'Text': 'VPC subnets should not allow automatic public IP assignment', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/subnet-auto-assign-public-ip-disabled.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Subnet,VPC subnet is a part of the VPC having its own rules for traffic. Assigning the Public IP to the subnet automatically (on launch) can accidentally expose the instances within this subnet to internet and should be edited to 'No' post creation of the Subnet.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_subnet_different_az/vpc_subnet_different_az.metadata.json,,https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html,vpc,Ensure all VPC has subnets in more than one availability zone,['redundancy'],,Ensure all VPC has subnets in more than one availability zone,,[],subnet,['Infrastructure Security'],vpc_subnet_different_az,"{'Code': {'CLI': 'aws ec2 create-subnet', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure all VPC has subnets in more than one availability zone', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Vpc,
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_vpn_connection_tunnels_up/vpc_vpn_connection_tunnels_up.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/vpc-vpn-2-tunnels-up.html,vpc,A VPN tunnel is an encrypted link where data can pass from the customer network to or from AWS within an AWS Site-to-Site VPN connection. Each VPN connection includes two VPN tunnels which you can simultaneously use for high availability. Ensuring that both VPN tunnels are up for a VPN connection is important for confirming a secure and highly available connection between an AWS VPC and your remote network.,['redundancy'],,Both VPN tunnels for an AWS Site-to-Site VPN connection should be up,,[],,['Software and Configuration Checks/AWS Security Best Practices'],vpc_vpn_connection_tunnels_up,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-20', 'Terraform': ''}, 'Recommendation': {'Text': 'To modify VPN tunnel options, see Modifying Site-to-Site VPN tunnel options in the AWS Site-to-Site VPN User Guide.', 'Url': 'https://docs.aws.amazon.com/vpn/latest/s2svpn/modify-vpn-tunnel-options.html'}}",medium,[],arn:partition:service:region:account-id:vpn-connection/resource-id,AwsEc2ClientVpnEndpoint,"If one or both VPN tunnels are down, it can compromise the security and availability of the connection between your AWS VPC and your remote network. This could result in connectivity issues and potential data exposure or loss during the downtime, affecting business operations and overall network security."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_endpoint_services_allowed_principals_trust_boundaries/vpc_endpoint_services_allowed_principals_trust_boundaries.metadata.json,,,vpc,Find trust boundaries in VPC endpoint services allowlisted principles.,['trustboundaries'],,Find trust boundaries in VPC endpoint services allowlisted principles.,,[],service_endpoint,['Infrastructure Security'],vpc_endpoint_services_allowed_principals_trust_boundaries,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_9#aws-vpc-endpoints-are-exposed', 'Terraform': ''}, 'Recommendation': {'Text': 'In multi Account environments identify untrusted links. Check trust chaining and dependencies between accounts.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-access.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2VpcEndpointService,Account VPC could be linked to other accounts.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_endpoint_connections_trust_boundaries/vpc_endpoint_connections_trust_boundaries.metadata.json,,,vpc,Find trust boundaries in VPC endpoint connections.,['trustboundaries'],,Find trust boundaries in VPC endpoint connections.,,[],endpoint,['Infrastructure Security'],vpc_endpoint_connections_trust_boundaries,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_9#aws-vpc-endpoints-are-exposed', 'Terraform': ''}, 'Recommendation': {'Text': 'In multi Account environments identify untrusted links. Check trust chaining and dependencies between accounts.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-access.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2VpcEndpointService,Account VPC could be linked to other accounts.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_flow_logs_enabled/vpc_flow_logs_enabled.metadata.json,,,vpc,Ensure VPC Flow Logging is Enabled in all VPCs.,"['forensics-ready', 'logging']",,Ensure VPC Flow Logging is Enabled in all VPCs.,,[],flow_log,['Logging and Monitoring'],vpc_flow_logs_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/logging-policies/logging_9-enable-vpc-flow-logging#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/logging_9-enable-vpc-flow-logging#terraform'}, 'Recommendation': {'Text': 'It is recommended that VPC Flow Logs be enabled for packet Rejects for VPCs.', 'Url': 'http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Vpc,VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_endpoint_for_ec2_enabled/vpc_endpoint_for_ec2_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/service-vpc-endpoint-enabled.html,ec2,Ensure that a service endpoint for Amazon EC2 is created for each VPC. The check fails if a VPC does not have a VPC endpoint created for the Amazon EC2 service.,[],,Amazon EC2 should be configured to use VPC endpoints that are created for the Amazon EC2 service.,,[],,[],vpc_endpoint_for_ec2_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-10', 'Terraform': ''}, 'Recommendation': {'Text': 'To improve the security posture of your VPC, configure Amazon EC2 to use an interface VPC endpoint powered by AWS PrivateLink.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/interface-vpc-endpoints.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2VpcEndpointService,"Without VPC endpoints, network traffic between your VPC and Amazon EC2 may traverse the public internet, increasing the risk of unintended access or data exposure."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_different_regions/vpc_different_regions.metadata.json,,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html,vpc,Ensure there are VPCs in more than one region,[],,Ensure there are VPCs in more than one region,,[],subnet,['Infrastructure Security'],vpc_different_regions,"{'Code': {'CLI': 'aws ec2 create-vpc', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure there are VPCs in more than one region', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/vpc-example-private-subnets-nat.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Vpc,
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_endpoint_multi_az_enabled/vpc_endpoint_multi_az_enabled.metadata.json,,https://docs.aws.amazon.com/vpc/latest/privatelink/interface-endpoints.html,vpc,"Ensure that all vpc interface endpoints have ENIs in multiple subnets. If a VPC endpoint has an ENI in only a single subnet then this check will fail. You cannot create VPC Endpoints in 2 different subnets in the same AZ. So, for the purpose of VPC endpoints, having multiple subnets implies multiple AZs.",['redundancy'],,Amazon VPC Interface Endpoints should have ENIs in more than one subnet.,,[],,[],vpc_endpoint_multi_az_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To improve the availability of your services residing in your VPC, configure multiple subnets for VPC Interface Endpoints.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/interface-vpc-endpoints.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsVpcEndpointService,Without VPC endpoints ENIs in multiple subnets an AZ impacting event could lead to increased downtime or your network traffic between your VPC and Amazon services may traverse the public internet.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/vpc/vpc_subnet_separate_private_public/vpc_subnet_separate_private_public.metadata.json,,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html,vpc,Ensure all VPC has public and private subnets defined,[],,Ensure all VPC has public and private subnets defined,,[],subnet,['Infrastructure Security'],vpc_subnet_separate_private_public,"{'Code': {'CLI': 'aws ec2 create-subnet', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure all VPC has public and private subnets defined', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Vpc,
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/codeartifact/codeartifact_packages_external_public_publishing_disabled/codeartifact_packages_external_public_publishing_disabled.metadata.json,,https://docs.aws.amazon.com/codeartifact/latest/ug/package-origin-controls.html,codeartifact,Ensure CodeArtifact internal packages do not allow external public source publishing.,['internet-exposed'],,Ensure CodeArtifact internal packages do not allow external public source publishing.,,[],,[],codeartifact_packages_external_public_publishing_disabled,"{'Code': {'CLI': ""aws codeartifact put-package-origin-configuration --package 'MyPackage' --namespace 'MyNamespace' --domain 'MyDomain' --repository 'MyRepository' --domain-owner 'MyOwnerAccount' --format 'MyFormat' --restrictions 'publish=ALLOW,upstream=BLOCK'"", 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure package origin controls on a package in a repository to limit how versions of that package can be added to the repository.', 'Url': 'https://docs.aws.amazon.com/codeartifact/latest/ug/package-origin-controls.html'}}",critical,[],arn:partition:codeartifact:region:account-id:repository/repository-name,Other,Allowing package versions of a package to be added both by direct publishing and ingesting from public repositories makes you vulnerable to a dependency substitution attack.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_no_high_severity_findings/guardduty_no_high_severity_findings.metadata.json,,https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings.html,guardduty,There are High severity GuardDuty findings ,[],,There are High severity GuardDuty findings ,,[],,[],guardduty_no_high_severity_findings,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/GuardDuty/findings.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Review and remediate critical GuardDuty findings as quickly as possible.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings.html'}}",high,[],arn:aws:guardduty:region:account-id/detector-id,AwsGuardDutyDetector,If critical findings are not addressed threats can spread in the environment.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_eks_runtime_monitoring_enabled/guardduty_eks_runtime_monitoring_enabled.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/guardduty-eks-protection-runtime-enabled.html,guardduty,"This control checks whether GuardDuty EKS Runtime Monitoring with automated agent management is enabled. For a standalone account, the control fails if GuardDuty EKS Runtime Monitoring with automated agent management is disabled in the account. In a multi-account environment, the control fails if the delegated GuardDuty administrator account and all member accounts don't have EKS Runtime Monitoring with automated agent management enabled.",[],,GuardDuty EKS Runtime Monitoring should be enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices'],guardduty_eks_runtime_monitoring_enabled,"{'Code': {'CLI': 'aws guardduty update-organization-configuration --detector-id <detector-id> --eks-runtime-monitoring-configuration Enable=true --auto-enable', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-7', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable GuardDuty EKS Runtime Monitoring with automated agent management to protect EKS clusters.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring-configuration.html'}}",medium,[],arn:aws:guardduty:{region}:{account-id}:detector/{detector-id},AwsGuardDutyDetector,"Without EKS Runtime Monitoring in GuardDuty, your Amazon EKS clusters may lack necessary protection against potential threats that can compromise container security, leading to unmonitored security risks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_ec2_malware_protection_enabled/guardduty_ec2_malware_protection_enabled.metadata.json,,https://docs.aws.amazon.com/guardduty/latest/ug/malware-protection.html,guardduty,GuardDuty Malware Protection for EC2 helps you detect the potential presence of malware by scanning the Amazon Elastic Block Store (Amazon EBS) volumes that are attached to Amazon Elastic Compute Cloud (Amazon EC2) instances and container workloads.,[],,Ensure that GuardDuty Malware Protection for EC2 is enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],guardduty_ec2_malware_protection_enabled,"{'Code': {'CLI': 'aws guardduty update-detector --detector-id <detector-id> --data-sources MalwareProtection={ScanEc2InstanceWithFindings={EbsVolumes=true}}', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-8', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Malware Protection for EC2 in GuardDuty.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/configure-malware-protection-single-account.html'}}",high,[],arn:aws:guardduty:region:account-id/detector-id,AwsGuardDutyDetector,"Malware can compromise your EC2 instances and container workloads, leading to data breaches, data exfiltration, and other security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_is_enabled/guardduty_is_enabled.metadata.json,,https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_settingup.html,guardduty,Check if GuardDuty is enabled,['forensics-ready'],,Check if GuardDuty is enabled,,[],,[],guardduty_is_enabled,"{'Code': {'CLI': 'aws guardduty create-detector --region <REGION> --enable', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/GuardDuty/guardduty-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-guardduty-is-enabled-to-specific-orgregion#fix---buildtime'}, 'Recommendation': {'Text': 'Enable GuardDuty and analyze its findings.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_settingup.html'}}",medium,[],arn:aws:guardduty:region:account-id/detector-id,AwsGuardDutyDetector,Amazon GuardDuty is a continuous security monitoring service that analyzes and processes several datasources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_s3_protection_enabled/guardduty_s3_protection_enabled.metadata.json,,https://docs.aws.amazon.com/guardduty/latest/ug/s3_detection.html,guardduty,This control checks whether GuardDuty S3 Protection is enabled in the account.,[],,Check if GuardDuty S3 Protection is enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],guardduty_s3_protection_enabled,"{'Code': {'CLI': ""aws guardduty update-detector --detector-id <detector-id> --data-sources S3Logs={Enable=true}}'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-10', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable GuardDuty S3 Protection to monitor object-level API operations in your S3 buckets.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/s3_detection.html'}}",high,[],arn:aws:guardduty:<region>:<account-id>:detector/<detector-id>,AwsGuardDutyDetector,"Without GuardDuty S3 Protection enabled, your S3 buckets are not monitored for potential security risks at the object level, which may lead to undetected malicious activities and data breaches."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_rds_protection_enabled/guardduty_rds_protection_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/guard-duty-rds-protection.html,guardduty,Check if GuardDuty RDS Protection is enabled to ensure monitoring and threat detection for RDS activity.,[],,Check if GuardDuty RDS Protection is enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],guardduty_rds_protection_enabled,"{'Code': {'CLI': 'aws guardduty update-detector --detector-id <detector-id> --features Name=RDS_LOGIN_EVENTS,Status=ENABLED', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-9', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable GuardDuty RDS Protection to continuously monitor and detect anomalous login behaviors on your Aurora databases, helping to identify and respond to potential access threats without impacting database performance.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/rds-protection.html'}}",high,[],arn:aws:guardduty:<region>:<account-id>:detector/<detector-id>,AwsGuardDutyDetector,"Without GuardDuty RDS Protection enabled, suspicious login activities to your databases may go undetected, increasing the risk of unauthorized access, data breaches, or compromised database security."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_eks_audit_log_enabled/guardduty_eks_audit_log_enabled.metadata.json,,https://docs.aws.amazon.com/guardduty/latest/ug/kubernetes-protection.html,guardduty,Checks whether GuardDuty EKS Audit Log Monitoring is enabled as source in a detector.,['logging'],,GuardDuty EKS Audit Log Monitoring Enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis'],guardduty_eks_audit_log_enabled,"{'Code': {'CLI': 'aws guardduty update-detector --detector-id <detector-id> --data-sources Kubernetes={AuditLogs={Enable=true}}', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-5', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable GuardDuty EKS Audit Log Monitoring to detect potentially suspicious activities in your Amazon Elastic Kubernetes Service (Amazon EKS) clusters.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/eks-protection-enable-standalone-account.html'}}",high,[],arn:aws:guardduty:region:account-id/detector-id,AwsGuardDutyDetector,"Without GuardDuty EKS Audit Log Monitoring enabled, you may not be able to detect potentially suspicious activities in your Amazon Elastic Kubernetes Service (Amazon EKS) clusters."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_lambda_protection_enabled/guardduty_lambda_protection_enabled.metadata.json,,https://docs.aws.amazon.com/guardduty/latest/ug/lambda-protection.html,guardduty,"GuardDuty Lambda Protection helps you identify potential security threats when an AWS Lambda function gets invoked. After you enable Lambda Protection, GuardDuty starts monitoring Lambda network activity logs associated with the Lambda functions in your AWS account.",[],,Check if GuardDuty Lambda Protection is enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],guardduty_lambda_protection_enabled,"{'Code': {'CLI': 'aws guardduty update-detector --detector-id <detector-id> --features Name=LAMBDA_NETWORK_LOGS,Status=ENABLED', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/guardduty-controls.html#guardduty-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Lambda Protection in your GuardDuty detector to start monitoring Lambda Network Activity in your account.', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/configure-lambda-protection-standalone-acc.html'}}",high,[],arn:aws:guardduty:region:account-id/detector-id,AwsGuardDutyDetector,"If Lambda Protection is not enabled, GuardDuty will not be able to monitor Lambda network activity logs and may miss potential security threats."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/guardduty/guardduty_centrally_managed/guardduty_centrally_managed.metadata.json,,https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_accounts.html,guardduty,GuardDuty is centrally managed,[],,GuardDuty is centrally managed,,[],,[],guardduty_centrally_managed,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure GuardDuty to be centrally managed', 'Url': 'https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_accounts.html'}}",medium,[],arn:aws:guardduty:region:account-id/detector-id,AwsGuardDutyDetector,"If GuardDuty is not centrally managed, it is not possible to centrally manage the GuardDuty findings, settings, and member accounts."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/trustedadvisor/trustedadvisor_premium_support_plan_subscribed/trustedadvisor_premium_support_plan_subscribed.metadata.json,,https://aws.amazon.com/premiumsupport/plans/,support,Check if a Premium support plan is subscribed.,[],,Check if a Premium support plan is subscribed,,[],,[],trustedadvisor_premium_support_plan_subscribed,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/Support/support-plan.html', 'Terraform': ''}, 'Recommendation': {'Text': ""It is recommended that you subscribe to the AWS Business Support tier or higher for all of your AWS production accounts. If you don't have premium support, you must have an action plan to handle issues which require help from AWS Support. AWS Support provides a mix of tools and technology, people, and programs designed to proactively help you optimize performance, lower costs, and innovate faster."", 'Url': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/Support/support-plan.html'}}",low,[],arn:aws:iam::AWS_ACCOUNT_NUMBER:root,Other,"Ensure that the appropriate support level is enabled for the necessary AWS accounts. For example, if an AWS account is being used to host production systems and environments, it is highly recommended that the minimum AWS Support Plan should be Business."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/trustedadvisor/trustedadvisor_errors_and_warnings/trustedadvisor_errors_and_warnings.metadata.json,,https://aws.amazon.com/premiumsupport/technology/trusted-advisor/best-practice-checklist/,trustedadvisor,Check Trusted Advisor for errors and warnings.,[],,Check Trusted Advisor for errors and warnings.,,[],,[],trustedadvisor_errors_and_warnings,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/TrustedAdvisor/checks.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Review and act upon its recommendations.', 'Url': 'https://aws.amazon.com/premiumsupport/technology/trusted-advisor/best-practice-checklist/'}}",medium,[],arn:aws:service:region:account-id,Other,"Improve the security of your application by closing gaps, enabling various AWS security features and examining your permissions."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/firehose/firehose_stream_encrypted_at_rest/firehose_stream_encrypted_at_rest.metadata.json,,https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html,firehose,,[],,DataFirehose delivery streams should be encrypted at rest.,,[],Ensure DataFirehose delivery streams are encrypted at rest.,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],firehose_stream_encrypted_at_rest,"{'Code': {'CLI': 'aws firehose update-delivery-stream --delivery-stream-name <delivery-stream-name> --delivery-stream-encryption-configuration-input \'{ ""KeyType"": ""CUSTOMER_MANAGED_CMK"", ""KeyARN"": ""<kms-key-arn>"" }\'', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted/', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/datafirehose-controls.html#datafirehose-1', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Firehose/delivery-stream-encrypted-with-kms-customer-master-keys.html'}, 'Recommendation': {'Text': 'Enable server-side encryption for Kinesis Firehose delivery streams using AWS Key Management Service (KMS). This encrypts data at rest, ensuring that sensitive information remains secure and compliant with regulatory standards.', 'Url': 'https://docs.aws.amazon.com/firehose/latest/dev/encryption.html'}}",medium,[],arn:partition:firehose:region:account-id:deliverystream/delivery-stream-id,AwsKinesisFirehoseDeliveryStream,"Without encryption at rest, data in Amazon Kinesis Data Firehose delivery streams is vulnerable to unauthorized access if the storage layer is compromised. This increases the risk of sensitive information exposure, potentially leading to data breaches or non-compliance with security regulations."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_endpoint_mongodb_authentication_enabled/dms_endpoint_mongodb_authentication_enabled.metadata.json,,https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Source.MongoDB.html,dms,This control checks whether an AWS DMS endpoint for MongoDB is configured with an authentication mechanism. The control fails if an authentication type isn't set for the endpoint.,[],,Check if DMS endpoints for MongoDB have an authentication mechanism enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dms_endpoint_mongodb_authentication_enabled,"{'Code': {'CLI': 'aws dms modify-endpoint --endpoint-arn <endpoint-arn> --username <username> --password <password> --authentication-type <authentication-type>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-11', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable an authentication mechanism on DMS endpoints for MongoDB to ensure secure access control during migration.', 'Url': 'https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Source.MongoDB.html'}}",medium,[],arn:aws:dms:region:account-id:endpoint/endpoint-id,AwsDmsEndpoint,"Without an authentication mechanism enabled, unauthorized users may gain access to sensitive data during migration, increasing the risk of data breaches and security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_replication_task_target_logging_enabled/dms_replication_task_target_logging_enabled.metadata.json,,https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Monitoring.html#CHAP_Monitoring.ManagingLogs,dms,This control checks whether logging is enabled with the minimum severity level of LOGGER_SEVERITY_DEFAULT for DMS replication tasks TARGET_APPLY and TARGET_LOAD. The control fails if logging isn't enabled for these tasks or if the minimum severity level is less than LOGGER_SEVERITY_DEFAULT.,[],,Check if DMS replication tasks for the target database have logging enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dms_replication_task_target_logging_enabled,"{'Code': {'CLI': 'aws dms modify-replication-task --replication-task-arn <task-arn> --task-settings \'{""Logging"":{""EnableLogging"":true,""LogComponents"":[{""Id"":""TARGET_APPLY"",""Severity"":""LOGGER_SEVERITY_DEFAULT""},{""Id"":""TARGET_LOAD"",""Severity"":""LOGGER_SEVERITY_DEFAULT""}]}}\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-7', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logging for target database DMS replication tasks with a minimum severity level of LOGGER_SEVERITY_DEFAULT.', 'Url': 'https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Tasks.CustomizingTasks.TaskSettings.Logging.html'}}",medium,[],arn:aws:dms:region:account-id:task/task-id,AwsDmsReplicationTask,"Without logging enabled, issues in data migration may go undetected, affecting the integrity and compliance of replicated data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_instance_multi_az_enabled/dms_instance_multi_az_enabled.metadata.json,,https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#,dms,Ensure DMS instances have multi az enabled.,['redundancy'],,Ensure DMS instances have multi az enabled.,,[],,[],dms_instance_multi_az_enabled,"{'Code': {'CLI': 'aws dms modify-replication-instance --region <REGION> --replication-instance-arn arn:aws:dms:<REGION>:<ACCOUNT_ID>:rep:<REPLICATION_ID> --multi-az --apply-immediately', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#'}, 'Recommendation': {'Text': 'Enable multi az for all DMS replication instances.', 'Url': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/multi-az.html#'}}",medium,[],arn:aws:rdmsds:region:account-id:rep,AwsDmsReplicationInstance,"Ensure that your Amazon Database Migration Service (DMS) replication instances are using Multi-AZ deployment configurations to provide High Availability (HA) through automatic failover to standby replicas in the event of a failure such as an Availability Zone (AZ) outage, an internal hardware or network outage, a software failure or in case of a planned maintenance session."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_instance_no_public_access/dms_instance_no_public_access.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-1,dms,Ensure DMS instances are not publicly accessible.,['internet-exposed'],,Ensure DMS instances are not publicly accessible.,,[],,[],dms_instance_no_public_access,"{'Code': {'CLI': '', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/publicly-accessible.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/publicly-accessible.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/publicly-accessible.html#'}, 'Recommendation': {'Text': 'Restrict DMS Replication instances security groups to only required IPs, or re-create these instances that is only accessible privately.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-1'}}",critical,[],arn:aws:rdmsds:region:account-id:rep,AwsDmsReplicationInstance,"Ensure that your Amazon Database Migration Service (DMS) are not publicly accessible from the Internet in order to avoid exposing private data and minimize security risks. A DMS replication instance should have a private IP address and the Publicly Accessible feature disabled when both the source and the target databases are in the same network that is connected to the instance's VPC through a VPN, VPC peering connection, or using an AWS Direct Connect dedicated connection."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_endpoint_redis_in_transit_encryption_enabled/dms_endpoint_redis_in_transit_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Source.Redis.html,dms,This control checks whether an AWS DMS endpoint for Redis OSS is configured with a TLS connection. The control fails if the endpoint doesn't have TLS enabled.,[],,Check if DMS endpoints for Redis OSS are encrypted in transit.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dms_endpoint_redis_in_transit_encryption_enabled,"{'Code': {'CLI': ""aws dms modify-endpoint --endpoint-arn <endpoint-arn> --redis-settings '{'SslSecurityProtocol': 'ssl-encryption'}'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-12', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable TLS for DMS endpoints for Redis OSS to ensure encrypted communication during data migration.', 'Url': 'https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Redis.html#CHAP_Target.Redis.EndpointSettings'}}",medium,[],arn:aws:dms:region:account-id:endpoint/endpoint-id,AwsDmsEndpoint,"Without TLS, data transmitted between databases may be vulnerable to interception or eavesdropping, increasing the risk of data breaches and other security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_instance_minor_version_upgrade_enabled/dms_instance_minor_version_upgrade_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-6,dms,Ensure DMS instances have auto minor version upgrade enabled.,[],,Ensure DMS instances have auto minor version upgrade enabled.,,[],,[],dms_instance_minor_version_upgrade_enabled,"{'Code': {'CLI': 'aws dms modify-replication-instance --region <REGION> --replication-instance-arn arn:aws:dms:<REGION>:<ACCOUNT_ID>:rep:<REPLICATION_ID> --auto-minor-version-upgrade --apply-immediately', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/auto-minor-version-upgrade.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/auto-minor-version-upgrade.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/auto-minor-version-upgrade.html#'}, 'Recommendation': {'Text': 'Enable auto minor version upgrade for all DMS replication instances.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-6'}}",medium,[],arn:aws:rdmsds:region:account-id:rep,AwsDmsReplicationInstance,Ensure that your Amazon Database Migration Service (DMS) replication instances have the Auto Minor Version Upgrade feature enabled in order to receive automatically minor engine upgrades.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_endpoint_ssl_enabled/dms_endpoint_ssl_enabled.metadata.json,,https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Security.SSL.html,dms,This check ensures that SSL mode is enabled for all AWS Database Migration Service (DMS) endpoints. Enabling SSL provides encryption in transit for data transferred through these endpoints.,['encryption'],,Ensure SSL mode is enabled in DMS endpoint,,[],endpoint,"['Effects', 'Data Exposure']",dms_endpoint_ssl_enabled,"{'Code': {'CLI': 'aws dms modify-endpoint --endpoint-arn <endpoint_arn> --ssl-mode require', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-9', 'Terraform': ''}, 'Recommendation': {'Text': ""Enable SSL mode for all DMS endpoints. Use 'require' as the minimum SSL mode, and consider using 'verify-ca' or 'verify-full' for higher security."", 'Url': 'https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Security.SSL.html'}}",high,[],arn:partition:dms:region:account-id:endpoint:resource-id,AwsDmsEndpoint,"Without SSL enabled, data transferred through DMS endpoints is not encrypted, potentially exposing sensitive information to unauthorized access or interception during transit."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_endpoint_neptune_iam_authorization_enabled/dms_endpoint_neptune_iam_authorization_enabled.metadata.json,,https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Neptune.html,dms,This control checks whether an AWS DMS endpoint for an Amazon Neptune database is configured with IAM authorization. The control fails if the DMS endpoint doesn't have IAM authorization enabled.,[],,Check if DMS endpoints for Neptune databases have IAM authorization enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dms_endpoint_neptune_iam_authorization_enabled,"{'Code': {'CLI': 'aws dms modify-endpoint --endpoint-arn <endpoint-arn> --service-access-role-arn <iam-role-arn>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-10', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable IAM authorization on DMS endpoints for Neptune databases by specifying a service role in the ServiceAccessRoleARN parameter.', 'Url': 'https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Neptune.html'}}",medium,[],arn:aws:dms:region:account-id:endpoint/endpoint-id,AwsDmsEndpoint,"Without IAM authorization, DMS endpoints for Neptune databases may lack granular access control, increasing the risk of unauthorized access to sensitive data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/dms/dms_replication_task_source_logging_enabled/dms_replication_task_source_logging_enabled.metadata.json,,https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Monitoring.html#CHAP_Monitoring.ManagingLogs,dms,This control checks whether logging is enabled with the minimum severity level of LOGGER_SEVERITY_DEFAULT for DMS replication tasks SOURCE_CAPTURE and SOURCE_UNLOAD. The control fails if logging isn't enabled for these tasks or if the minimum severity level is less than LOGGER_SEVERITY_DEFAULT.,[],,Check if DMS replication tasks for the source database have logging enabled.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],dms_replication_task_source_logging_enabled,"{'Code': {'CLI': 'aws dms modify-replication-task --replication-task-arn <task-arn> --task-settings \'{""Logging"":{""EnableLogging"":true,""LogComponents"":[{""Id"":""SOURCE_CAPTURE"",""Severity"":""LOGGER_SEVERITY_DEFAULT""},{""Id"":""SOURCE_UNLOAD"",""Severity"":""LOGGER_SEVERITY_DEFAULT""}]}}\'', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/dms-controls.html#dms-8', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logging for source database DMS replication tasks with a minimum severity level of LOGGER_SEVERITY_DEFAULT.', 'Url': 'https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Tasks.CustomizingTasks.TaskSettings.Logging.html'}}",medium,[],arn:aws:dms:region:account-id:task/task-id,AwsDmsReplicationTask,"Without logging enabled, issues in data migration may go undetected, affecting the integrity and compliance of replicated data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ses/ses_identity_not_publicly_accessible/ses_identity_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/ses/latest/dg/identity-authorization-policies.html,ses,This control checks whether SES identities are not publicly accessible via resource policies.,['internet-exposed'],,Ensure that SES identities are not publicly accessible,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ses_identity_not_publicly_accessible,"{'Code': {'CLI': 'aws ses delete-email-identity-policy --identity <IDENTITY-NAME> --policy-name <POLICY-NAME>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Review and restrict SES identity policies to prevent public access. Ensure policies follow the Principle of Least Privilege.', 'Url': 'https://docs.aws.amazon.com/ses/latest/dg/policy-anatomy.html'}}",high,[],arn:aws:ses:region:account-id:identity/<IDENTITY-NAME>,AwsSesIdentity,"Publicly accessible SES identities can allow unauthorized email sending or receiving, leading to potential abuse or phishing attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/account/account_maintain_current_contact_details/account_maintain_current_contact_details.metadata.json,,,account,Maintain current contact details.,[],,Maintain current contact details.,,[],,['IAM'],account_maintain_current_contact_details,"{'Code': {'CLI': 'No command available.', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_18-maintain-contact-details#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Using the Billing and Cost Management console complete contact details.', 'Url': 'https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html'}}",medium,[],arn:partition:service:region:account-id,AwsAccount,"Ensure contact email and telephone details for AWS accounts are current and map to more than one individual in your organization. An AWS account supports a number of contact details, and AWS will use these to contact the account owner if activity judged to be in breach of Acceptable Use Policy. If an AWS account is observed to be behaving in a prohibited or suspicious manner, AWS will attempt to contact the account owner by email and phone using the contact details listed. If this is unsuccessful and the account behavior needs urgent mitigation, proactive measures may be taken, including throttling of traffic between the account exhibiting suspicious behavior and the AWS API endpoints and the Internet. This will result in impaired service to and from the account in question."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/account/account_maintain_different_contact_details_to_security_billing_and_operations/account_maintain_different_contact_details_to_security_billing_and_operations.metadata.json,,https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html,account,"Maintain different contact details to security, billing and operations.",[],,"Maintain different contact details to security, billing and operations.",,[],,['IAM'],account_maintain_different_contact_details_to_security_billing_and_operations,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_18-maintain-contact-details#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Using the Billing and Cost Management console complete contact details.', 'Url': 'https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html'}}",medium,[],arn:partition:service:region:account-id,AwsAccount,"Ensure contact email and telephone details for AWS accounts are current and map to more than one individual in your organization. An AWS account supports a number of contact details, and AWS will use these to contact the account owner if activity judged to be in breach of Acceptable Use Policy. If an AWS account is observed to be behaving in a prohibited or suspicious manner, AWS will attempt to contact the account owner by email and phone using the contact details listed. If this is unsuccessful and the account behavior needs urgent mitigation, proactive measures may be taken, including throttling of traffic between the account exhibiting suspicious behavior and the AWS API endpoints and the Internet. This will result in impaired service to and from the account in question."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/account/account_security_questions_are_registered_in_the_aws_account/account_security_questions_are_registered_in_the_aws_account.metadata.json,,,account,Ensure security questions are registered in the AWS account.,[],,Ensure security questions are registered in the AWS account.,,[],,['IAM'],account_security_questions_are_registered_in_the_aws_account,"{'Code': {'CLI': 'No command available.', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_15', 'Terraform': ''}, 'Recommendation': {'Text': 'Login as root account and from My Account configure Security questions.', 'Url': 'https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-security-challenge.html'}}",medium,[],arn:partition:service:region:account-id,AwsAccount,The AWS support portal allows account owners to establish security questions that can be used to authenticate individuals calling AWS customer service for support. It is recommended that security questions be established. When creating a new AWS account a default super user is automatically created. This account is referred to as the root account. It is recommended that the use of this account be limited and highly controlled. During events in which the root password is no longer accessible or the MFA token associated with root is lost/destroyed it is possible through authentication using secret questions and associated answers to recover root login access.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/account/account_security_contact_information_is_registered/account_security_contact_information_is_registered.metadata.json,,,account,Ensure security contact information is registered.,[],,Ensure security contact information is registered.,,[],,['IAM'],account_security_contact_information_is_registered,"{'Code': {'CLI': 'No command available.', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/iam-policies/iam_19#aws-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Go to the My Account section and complete alternate contacts.', 'Url': 'https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact.html'}}",medium,[],arn:partition:service:region:account-id,AwsAccount,AWS provides customers with the option of specifying the contact information for accounts security team. It is recommended that this information be provided. Specifying security-specific contact information will help ensure that security advisories sent by AWS reach the team in your organization that is best equipped to respond to them.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_group_multiple_instance_types/autoscaling_group_multiple_instance_types.metadata.json,,https://docs.aws.amazon.com/autoscaling/ec2/userguide/ec2-auto-scaling-mixed-instances-groups.html,autoscaling,"This control checks whether an Amazon EC2 Auto Scaling group uses multiple instance types in all the Availability Zones, meaning that there should be multiple Availability Zones with multiple instances on each one. The control fails if the Auto Scaling group has only one instance type defined.",[],,EC2 Auto Scaling Group should use multiple instance types in multiple Availability Zones.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],autoscaling_group_multiple_instance_types,"{'Code': {'CLI': 'aws autoscaling create-auto-scaling-group --mixed-instances-policy ...', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure your EC2 Auto Scaling group to use multiple instance types across multiple Availability Zones.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/AutoScaling/asg-multiple-instance-type-az.html'}}",medium,[],arn:partition:autoscaling:region:account-id:autoScalingGroupName/resource-name,AwsAutoScalingAutoScalingGroup,"Using only one instance type in an Auto Scaling group reduces the flexibility to launch new instances when there is insufficient capacity for that specific type, potentially affecting the availability of the application."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_group_launch_configuration_requires_imdsv2/autoscaling_group_launch_configuration_requires_imdsv2.metadata.json,,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-IMDS-new-instances.html,autoscaling,"This control checks whether IMDSv2 is enabled on all instances launched by Amazon EC2 Auto Scaling groups. The control fails if the Instance Metadata Service (IMDS) version isn't included in the launch configuration or is configured as token optional, which allows either IMDSv1 or IMDSv2.",[],,Check if Auto Scaling group launch configurations require Instance Metadata Service Version 2 (IMDSv2).,,[],,['Software and Configuration Checks/AWS Security Best Practices'],autoscaling_group_launch_configuration_requires_imdsv2,"{'Code': {'CLI': ""aws autoscaling create-launch-configuration --launch-configuration-name <new-launch-config> --metadata-options 'HttpTokens=required'"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Create a new launch configuration that requires IMDSv2 and update your Auto Scaling groups to use the new configuration.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-IMDS-new-instances.html'}}",high,[],arn:aws:autoscaling:region:account-id:launchConfiguration/launchConfigurationName,AwsAutoScalingLaunchConfiguration,"If IMDSv2 is not enforced, instances may be vulnerable to certain types of attacks that target the metadata service, potentially exposing sensitive instance information."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_group_launch_configuration_no_public_ip/autoscaling_group_launch_configuration_no_public_ip.metadata.json,,https://docs.aws.amazon.com/autoscaling/ec2/userguide/create-auto-scaling-groups-launch-configuration.html,autoscaling,This control checks whether an Auto Scaling group's associated launch configuration assigns a public IP address to the group's instances. The control fails if the associated launch configuration assigns a public IP address.,['internet-exposed'],,Check if Amazon EC2 instances launched using Auto Scaling group launch configurations have Public IP addresses.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],autoscaling_group_launch_configuration_no_public_ip,"{'Code': {'CLI': 'aws autoscaling create-launch-configuration --launch-configuration-name <new-launch-config> --associate-public-ip-address false', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-5', 'Terraform': ''}, 'Recommendation': {'Text': 'Create a new launch configuration without a public IP address and update your Auto Scaling groups to use the new configuration.', 'Url': 'https://docs.aws.amazon.com/autoscaling/ec2/userguide/change-launch-config.html'}}",high,[],arn:aws:autoscaling:region:account-id:launchConfiguration/launchConfigurationName,AwsAutoScalingLaunchConfiguration,"Assigning a public IP address to EC2 instances can expose them directly to the internet, increasing the risk of unauthorized access and potential security breaches."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_group_capacity_rebalance_enabled/autoscaling_group_capacity_rebalance_enabled.metadata.json,,https://docs.aws.amazon.com/autoscaling/ec2/userguide/ec2-auto-scaling-capacity-rebalancing.html,autoscaling,This control checks whether an Amazon EC2 Auto Scaling group has capacity rebalance enabled.,['redundancy'],,Check if Amazon EC2 Auto Scaling groups have capacity rebalance enabled.,,[],,['Resilience'],autoscaling_group_capacity_rebalance_enabled,"{'Code': {'CLI': 'aws autoscaling create-auto-scaling-group --capacity-rebalance', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/autoscaling/ec2/userguide/enable-capacity-rebalancing-console-cli.html', 'Terraform': ''}, 'Recommendation': {'Text': ""When you enable Capacity Rebalancing for your Auto Scaling group, Amazon EC2 Auto Scaling attempts to proactively replace the Spot Instances in your group that have received a rebalance recommendation. This provides an opportunity to rebalance your workload to new Spot Instances that aren't at an elevated risk of interruption."", 'Url': 'https://docs.aws.amazon.com/awssupport/latest/user/fault-tolerance-checks.html#amazon-ec2-auto-scaling-group-capacity-rebalance-enabled'}}",medium,[],arn:aws:autoscaling:region:account-id:autoScalingGroup/autoScalingGroupName,AwsAutoScalingAutoScalingGroup,"When you don't use Capacity Rebalancing, Amazon EC2 Auto Scaling doesn't replace Spot Instances until after the Amazon EC2 Spot service interrupts the instances and their health check fails. Before interrupting an instance, Amazon EC2 always gives both an EC2 instance rebalance recommendation and a Spot two-minute instance interruption notice."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_group_multiple_az/autoscaling_group_multiple_az.metadata.json,,https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-add-availability-zone.html,autoscaling,EC2 Auto Scaling Group should use multiple Availability Zones,['redundancy'],,EC2 Auto Scaling Group should use multiple Availability Zones,,[],,[],autoscaling_group_multiple_az,"{'Code': {'CLI': 'aws autoscaling update-auto-scaling-group', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/AutoScaling/multiple-availability-zones.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure multiple Availability Zones for EC2 Auto Scaling Group', 'Url': 'https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-add-availability-zone.html'}}",medium,[],arn:partition:autoscaling:region:account-id:autoScalingGroupName/resource-name,AwsAutoScalingAutoScalingGroup,"In case of a failure in a single Availability Zone, the Auto Scaling Group will not be able to launch new instances to replace the failed ones."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_group_elb_health_check_enabled/autoscaling_group_elb_health_check_enabled.metadata.json,,https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-add-elb-healthcheck.html#as-add-elb-healthcheck-console,autoscaling,This control checks whether an Amazon EC2 Auto Scaling group that is associated with a load balancer uses Elastic Load Balancing (ELB) health checks. The control fails if the Auto Scaling group doesn't use ELB health checks.,[],,Check if Auto Scaling groups associated with a load balancer use ELB health checks.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],autoscaling_group_elb_health_check_enabled,"{'Code': {'CLI': 'aws autoscaling update-auto-scaling-group --auto-scaling-group-name <auto-scaling-group-name> --health-check-type ELB', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Configure your Auto Scaling groups to use ELB health checks to improve the monitoring and availability of your applications.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/AutoScaling/auto-scaling-group-health-check.html'}}",low,[],arn:aws:autoscaling:region:account-id:autoScalingGroup/autoScalingGroupName,AwsAutoScalingAutoScalingGroup,"If ELB health checks are not enabled, the Auto Scaling group might not be able to accurately determine the health of instances, which could impact the availability and reliability of the applications running on these instances."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_group_using_ec2_launch_template/autoscaling_group_using_ec2_launch_template.metadata.json,,https://docs.aws.amazon.com/autoscaling/ec2/userguide/create-asg-launch-template.html,autoscaling,This control checks whether an Amazon EC2 Auto Scaling group is created using an EC2 launch template. The control fails if the Auto Scaling group is not created with a launch template or if a launch template is not specified in a mixed instances policy.,[],,Check if Amazon EC2 Auto Scaling groups use EC2 launch templates.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],autoscaling_group_using_ec2_launch_template,"{'Code': {'CLI': 'aws autoscaling create-auto-scaling-group --launch-template LaunchTemplateId=<template-id>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/autoscaling-controls.html#autoscaling-9', 'Terraform': ''}, 'Recommendation': {'Text': 'Use EC2 launch templates when creating Auto Scaling groups to ensure access to the latest features and improvements.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/AutoScaling/asg-launch-template.html'}}",medium,[],arn:aws:autoscaling:region:account-id:autoScalingGroup/autoScalingGroupName,AwsAutoScalingAutoScalingGroup,"Using launch configurations instead of launch templates may limit your access to the latest EC2 features and improvements, reducing the flexibility and efficiency of your Auto Scaling groups."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/autoscaling/autoscaling_find_secrets_ec2_launch_configuration/autoscaling_find_secrets_ec2_launch_configuration.metadata.json,,,autoscaling,[DEPRECATED] Find secrets in EC2 Auto Scaling Launch Configuration,['secrets'],,[DEPRECATED] Find secrets in EC2 Auto Scaling Launch Configuration,,[],,['IAM'],autoscaling_find_secrets_ec2_launch_configuration,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Do not include sensitive information in user data within the launch configuration, try to use Secrets Manager instead.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html'}}",critical,[],arn:partition:autoscaling:region:account-id:autoScalingGroupName/resource-name,AwsAutoScalingLaunchConfiguration,"The use of a hard-coded password increases the possibility of password guessing.  If hard-coded passwords are used, it is possible that malicious users gain access through the account in question."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_cross_zone_load_balancing_enabled/elbv2_cross_zone_load_balancing_enabled.metadata.json,,https://docs.aws.amazon.com/elasticloadbalancing/latest/network/network-load-balancers.html#cross-zone-load-balancing,elbv2,"Checks whether cross-zone load balancing is enabled for Network Load Balancers (NLBs) and Gateway Load Balancers (GWLB). Cross-zone load balancing ensures even distribution of traffic across all registered targets in all Availability Zones, improving fault tolerance and load distribution.",[],,Ensure Cross-Zone Load Balancing is enabled for Network (NLBs) and Gateway (GWLB) Load Balancers,,[],,[],elbv2_cross_zone_load_balancing_enabled,"{'Code': {'CLI': 'aws elbv2 modify-load-balancer-attributes --load-balancer-name <load-balancer-name> --attributes Key=load_balancing.cross_zone.enabled,Value=true', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/enable-cross-zone-load-balancing.html#', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable cross-zone load balancing for Network and Gateway Load Balancers to ensure even traffic distribution and enhance fault tolerance across Availability Zones.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/network/network-load-balancers.html#cross-zone-load-balancing'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,"If cross-zone load balancing is not enabled, traffic may not be evenly distributed across Availability Zones, leading to over-utilization of resources in certain zones and potential application performance degradation or outages."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_nlb_tls_termination_enabled/elbv2_nlb_tls_termination_enabled.metadata.json,,https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/network-load-balancer-listener-security.html#,elbv2,Check if Network Load Balancers (NLB) has TLS listeners.,['encryption'],,Check if Network Load Balancers (NLB) has TLS termination enabled.,,[],,['Data Protection'],elbv2_nlb_tls_termination_enabled,"{'Code': {'CLI': 'aws elbv2 create-listener --load-balancer-arn <nlb_arn> --protocol TLS --port 443 --ssl-policy ELBSecurityPolicy-TLS13-1-2-2021-06 --certificates CertificateArn=<certificate_arn> --default-actions Type=forward,TargetGroupArn=<target_group_arn>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/network-load-balancer-listener-security.html#', 'Terraform': ''}, 'Recommendation': {'Text': 'When Transport Layer Security (TLS) termination is enabled, you can offload the encryption and decryption of the TLS traffic from your backend application servers to your Amazon Network Load Balancer, enhancing the performance of your backend servers while keeping the workload secure. ', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/network/listener-update-rules.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,Ensure that your Amazon Network Load Balancers (NLBs) are configured to terminate TLS connections in order to optimize the performance of the backend servers while encrypting the communication between the load balancer and the associated targets (i.e. server instances).
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_waf_acl_attached/elbv2_waf_acl_attached.metadata.json,,,elbv2,Check if Application Load Balancer has a WAF ACL attached.,[],,Check if Application Load Balancer has a WAF ACL attached.,,[],,['Infrastructure Security'],elbv2_waf_acl_attached,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Using the AWS Management Console open the AWS WAF console to attach an ACL.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,If not WAF ACL is attached risk of web attacks increases.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_logging_enabled/elbv2_logging_enabled.metadata.json,,,elbv2,Check if Elastic Load Balancers have logging enabled.,"['forensics-ready', 'logging']",,Check if Elastic Load Balancers have logging enabled.,,[],,['Logging and Monitoring'],elbv2_logging_enabled,"{'Code': {'CLI': 'aws elbv2 modify-load-balancer-attributes --load-balancer-arn <lb_arn> --attributes Key=access_logs.s3.enabled,Value=true Key=access_logs.s3.bucket,Value=<bucket_name> Key=access_logs.s3.prefix,Value=<prefix>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_22#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/access-log.html', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/bc_aws_logging_22#terraform'}, 'Recommendation': {'Text': 'Enable ELB logging, create a log lifecycle and define use cases.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,If logs are not enabled monitoring of service use and threat analysis is not possible.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_desync_mitigation_mode/elbv2_desync_mitigation_mode.metadata.json,,https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#desync-mitigation-mode,elbv2,"Check whether the Application Load Balancer is configured with strictest desync mitigation mode, if not check if at least is configured with the drop_invalid_header_fields attribute",[],,"Check whether the Application Load Balancer is configured with strictest desync mitigation mode, if not check if at least is configured with the drop_invalid_header_fields attribute",,[],,['Data Protection'],elbv2_desync_mitigation_mode,"{'Code': {'CLI': 'aws elbv2 modify-load-balancer-attributes --load-balancer-arn <alb arn> --attributes Key=routing.http.desync_mitigation_mode,Value=<defensive/strictest>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-12', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure Application Load Balancer is configured with strictest desync mitigation mode or with the drop_invalid_header_fields attribute enabled', 'Url': 'https://aws.amazon.com/about-aws/whats-new/2020/08/application-and-classic-load-balancers-adding-defense-in-depth-with-introduction-of-desync-mitigation-mode/'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,"HTTP Desync issues can lead to request smuggling and make your applications vulnerable to request queue or cache poisoning, which could lead to credential hijacking or execution of unauthorized commands."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_is_in_multiple_az/elbv2_is_in_multiple_az.metadata.json,,https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/how-elastic-load-balancing-works.html#availability-zones,elbv2,"Ensure whether Elastic Load Balancer V2 (Application, Network, or Gateway Load Balancer) is configured to operate across multiple Availability Zones (AZs). Ensuring that your load balancer is spread across at least two AZs helps maintain high availability and fault tolerance in case of an AZ failure.",['redundancy'],,Elastic Load Balancer V2 (ELBv2) is Configured Across Multiple Availability Zones (AZs),,[],,[],elbv2_is_in_multiple_az,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-13', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/enable-multi-az.html'}, 'Recommendation': {'Text': 'It is recommended to configure your ELBv2 to operate across at least two Availability Zones to enhance fault tolerance and availability.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-subnets.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,"If an ELBv2 is not configured across multiple AZs, there is a risk that an Availability Zone failure could lead to downtime for your application. This could result in a single point of failure, impacting the availability and reliability of your services."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_insecure_ssl_ciphers/elbv2_insecure_ssl_ciphers.metadata.json,,,elbv2,Check if Elastic Load Balancers have insecure SSL ciphers.,['encryption'],,Check if Elastic Load Balancers have insecure SSL ciphers.,,[],,['Data Protection'],elbv2_insecure_ssl_ciphers,"{'Code': {'CLI': 'aws elbv2 modify-listener --listener-arn <lb_arn> --ssl-policy ELBSecurityPolicy-TLS13-1-2-Ext2-2021-06', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/security-policy.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_43#terraform'}, 'Recommendation': {'Text': 'Use a Security policy with ciphers that are as strong as possible. Drop legacy and insecure ciphers.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html#describe-ssl-policies'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,Using insecure ciphers could affect privacy of in transit information.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_internet_facing/elbv2_internet_facing.metadata.json,,,elbv2,Check for internet facing Elastic Load Balancers.,['internet-exposed'],,Check for internet facing Elastic Load Balancers.,,[],,['Data Protection'],elbv2_internet_facing,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/internet-facing-load-balancers.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure the load balancer should be publicly accessible. If publicly exposed ensure a WAF ACL is implemented.', 'Url': 'https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,Publicly accessible load balancers could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_ssl_listeners/elbv2_ssl_listeners.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/elb-controls.html#elb-1,elbv2,Check if Elastic Load Balancers have SSL listeners.,['encryption'],,Check if Elastic Load Balancers have SSL listeners.,,[],,['Data Protection'],elbv2_ssl_listeners,"{'Code': {'CLI': 'aws elbv2 create-listener --load-balancer-arn <lb_arn> --protocol HTTPS --port 443 --ssl-policy <ssl_policy> --certificates CertificateArn=<certificate_arn>,IsDefault=true', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_36#aws-ec2-console', 'Terraform': ''}, 'Recommendation': {'Text': 'Scan for Load Balancers with HTTP or TCP listeners and understand the reason for each of them. Check if the listener can be implemented as TLS instead.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,Clear text communication could affect privacy of information in transit.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_deletion_protection/elbv2_deletion_protection.metadata.json,,,elbv2,Check if Elastic Load Balancers have deletion protection enabled.,[],,Check if Elastic Load Balancers have deletion protection enabled.,,[],,['Data Protection'],elbv2_deletion_protection,"{'Code': {'CLI': 'aws elbv2 modify-load-balancer-attributes --load-balancer-arn <lb_arn> --attributes Key=deletion_protection.enabled,Value=true', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/ELBv2/deletion-protection.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_networking_62#terraform'}, 'Recommendation': {'Text': 'Enable deletion protection attribute, this is not enabled by default.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#deletion-protection'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,"If deletion protection is not enabled, the resource is not protected against deletion."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elbv2/elbv2_listeners_underneath/elbv2_listeners_underneath.metadata.json,,,elbv2,Check if ELBV2 has listeners underneath.,[],,Check if ELBV2 has listeners underneath.,,[],,['Data Protection'],elbv2_listeners_underneath,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Add listeners to Elastic Load Balancers V2.', 'Url': 'https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsElbv2LoadBalancer,The rules that are defined for a listener determine how the load balancer routes requests to its registered targets.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/securityhub/securityhub_enabled/securityhub_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-enable-disable.html,securityhub,Check if Security Hub is enabled and its standard subscriptions.,[],,Check if Security Hub is enabled and its standard subscriptions.,,[],,['Logging and Monitoring'],securityhub_enabled,"{'Code': {'CLI': 'aws securityhub enable-security-hub --enable-default-standards', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Security Hub is Regional. When you enable or disable a security standard, it is enabled or disabled only in the current Region or in the Region that you specify.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-enable-disable.html'}}",medium,[],arn:partition:securityhub:region:account-id:hub/hub-id,Other,AWS Security Hub gives you a comprehensive view of your security alerts and security posture across your AWS accounts.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/backup/backup_recovery_point_encrypted/backup_recovery_point_encrypted.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/encryption.html,backup,This control checks if an AWS Backup recovery point is encrypted at rest. The control fails if the recovery point isn't encrypted at rest.,['encryption'],,Check if AWS Backup recovery points are encrypted at rest.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],backup_recovery_point_encrypted,"{'Code': {'CLI': 'aws backup update-backup-vault --backup-vault-name <backup_vault_name> --encryption-key-arn <kms_key_arn>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/backup-controls.html#backup-1', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that AWS Backup recovery points are encrypted at rest by using an AWS KMS key when creating backups.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/encryption.html'}}",medium,[],arn:aws:backup:region:account-id:recovery-point/recovery-point-id,AwsBackupRecoveryPoint,"Without encryption at rest, AWS Backup recovery points are vulnerable to unauthorized access, which could compromise the confidentiality and integrity of the backed-up data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/backup/backup_reportplans_exist/backup_reportplans_exist.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/create-report-plan-console.html,backup,This check ensures that there is at least one backup report plan in place.,[],,Ensure that there is at least one AWS Backup report plan,,[],,"['Recover', 'Resilience', 'Backup']",backup_reportplans_exist,"{'Code': {'CLI': 'aws backup create-report-plan --report-plan-name <report-plan-name> --report-delivery-channel <value> --report-setting <value>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use AWS Backup to create backup report plans that provide visibility into the success or failure of backup operations.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/create-report-plan-console.html'}}",low,[],arn:partition:service:region:account-id:backup-report-plan:backup-report-plan-id,AwsBackupBackupPlan,"Without a backup report plan, an organization may lack visibility into the success or failure of backup operations."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/backup/backup_vaults_exist/backup_vaults_exist.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/vaults.html,backup,This check ensures that AWS Backup vaults exist to provide a secure and durable storage location for backup data.,[],,Ensure AWS Backup vaults exist,,[],,"['Recover', 'Resilience', 'Backup']",backup_vaults_exist,"{'Code': {'CLI': 'aws backup create-backup-vault --backup-vault-name <backup_vault_name>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use AWS Backup to create backup vaults for your critical data and services.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/vaults.html'}}",low,[],arn:partition:service:region:account-id:backup-vault:backup-vault-id,AwsBackupBackupVault,"Without an AWS Backup vault, an organization's critical data may be at risk of being lost in the event of an accidental deletion, system failures, or natural disasters."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/backup/backup_vaults_encrypted/backup_vaults_encrypted.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/encryption.html,backup,This check ensures that AWS Backup vaults are encrypted with AWS KMS.,[],,Ensure that AWS Backup vaults are encrypted with AWS KMS,,[],,['Software and Configuration Checks/AWS Security Best Practices'],backup_vaults_encrypted,"{'Code': {'CLI': 'aws backup update-backup-vault --backup-vault-name <backup_vault_name> --encryption-key-arn <kms_key_arn>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Athena/encrypted-with-cmk.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Use AWS KMS to encrypt your AWS Backup vaults and backup data.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/encryption.html'}}",medium,[],arn:partition:service:region:account-id:backup-vault:backup-vault-id,AwsBackupBackupVault,"Without encryption using AWS KMS, an organization's backup data may be at risk of unauthorized access, which can lead to data breaches and other security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/backup/backup_plans_exist/backup_plans_exist.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/about-backup-plans.html,backup,This check ensures that there is at least one backup plan in place.,[],,Ensure that there is at least one AWS Backup plan,,[],,"['Recover', 'Resilience', 'Backup']",backup_plans_exist,"{'Code': {'CLI': 'aws backup create-backup-plan --backup-plan <backup_plan_name> --backup-plan-rule <backup_rule_name>', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use AWS Backup to create backup plans for your critical data and services.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/about-backup-plans.html'}}",low,[],arn:partition:service:region:account-id:backup-plan:backup-plan-id,AwsBackupBackupPlan,"Without a backup plan, an organization may be at risk of losing important data due to accidental deletion, system failures, or natural disasters. This can result in significant financial and reputational damage for the organization."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudformation/cloudformation_stack_outputs_find_secrets/cloudformation_stack_outputs_find_secrets.metadata.json,,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/outputs-section-structure.html,cloudformation,Find secrets in CloudFormation outputs,['secrets'],Infrastructure Protection,Find secrets in CloudFormation outputs,,[],,[],cloudformation_stack_outputs_find_secrets,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_2', 'Terraform': ''}, 'Recommendation': {'Text': 'Implement automated detective control to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets.', 'Url': 'https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html'}}",critical,[],arn:partition:cloudformation:region:account-id:stack/resource-id,AwsCloudFormationStack,Secrets hardcoded into CloudFormation outputs can be used by malware and bad actors to gain lateral access to other services.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudformation/cloudformation_stacks_termination_protection_enabled/cloudformation_stacks_termination_protection_enabled.metadata.json,,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-protect-stacks.html,cloudformation,Enable termination protection for Cloudformation Stacks,[],Infrastructure Protection,Enable termination protection for Cloudformation Stacks,,[],,[],cloudformation_stacks_termination_protection_enabled,"{'Code': {'CLI': 'aws cloudformation update-termination-protection --region <REGION_NAME> --stack-name <STACK_NAME> --enable-termination-protection', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure termination protection is enabled for the cloudformation stacks.', 'Url': 'https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-protect-stacks.html'}}",medium,[],arn:partition:cloudformation:region:account-id:stack/resource-id,AwsCloudFormationStack,"Without termination protection enabled, a critical cloudformation stack can be accidently deleted."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/cloudformation/cloudformation_stack_cdktoolkit_bootstrap_version/cloudformation_stack_cdktoolkit_bootstrap_version.metadata.json,,https://docs.aws.amazon.com/cdk/latest/guide/bootstrapping.html,cloudformation,Ensure that CDKToolkit stacks have a Bootstrap version of 21 or higher to mitigate security risks.,[],,Ensure that CDKToolkit stacks have a Bootstrap version of 21 or higher to mitigate security risks.,,[],,[],cloudformation_stack_cdktoolkit_bootstrap_version,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Update the CDKToolkit stack Bootstrap version to 21 or later by running the cdk bootstrap command with the latest CDK version.', 'Url': 'https://docs.aws.amazon.com/cdk/latest/guide/bootstrapping.html'}}",high,[],arn:partition:cloudformation:region:account-id:stack/resource-id,AwsCloudFormationStack,Using outdated CDKToolkit Bootstrap versions can expose accounts to risks such as bucket takeover or privilege escalation.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_redis_cluster_automatic_failover_enabled/elasticache_redis_cluster_automatic_failover_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/AutoFailover.html,elasticache,Ensure Elasticache Redis OSS cache clusters use automatic failover.,['redundancy'],,Ensure Elasticache Redis clusters have automatic failover enabled.,,[],,[],elasticache_redis_cluster_automatic_failover_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-3', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-elasticache-redis-cluster-with-multi-az-automatic-failover-feature-set-to-enabled/'}, 'Recommendation': {'Text': 'Enable automatic failover for ElastiCache (Redis OSS) clusters to ensure high availability and minimize downtime during failures.', 'Url': 'https://redis.io/blog/highly-available-in-memory-cloud-datastores/'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,"If automatic failover is not enabled, a failure in the primary node could result in significant downtime, impacting the availability and resilience of your application."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_cluster_uses_public_subnet/elasticache_cluster_uses_public_subnet.metadata.json,,https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/VPCs.html,elasticache,Ensure Elasticache Cluster is not using a public subnet,['internet-exposed'],,Ensure Elasticache Cluster is not using a public subnet,,[],,[],elasticache_cluster_uses_public_subnet,"{'Code': {'CLI': 'aws elasticache modify-cache-cluster --cache-cluster-id my-elasticache-cluster --cache-subnet-group-name my-private-subnet-group', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'To ensure your Elasticache cluster is not using a public subnet, follow the recommended remediation steps based on your preferred method.', 'Url': 'https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/VPCs.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,There is a risk of exposing sensitive data if Elasticache Cluster uses a public subnet.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_redis_cluster_backup_enabled/elasticache_redis_cluster_backup_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-1,elasticache,Ensure Elasticache Redis cache cluster has automatic backups enabled.,[],,Ensure Elasticache Redis cache cluster has automatic backups enabled.,,[],,[],elasticache_redis_cluster_backup_enabled,"{'Code': {'CLI': 'aws elasticache modify-replication-group --region <value> --replication-group-id <value> --snapshot-retention-limit <value> --apply-immediately', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-amazon-elasticache-redis-clusters-have-automatic-backup-turned-on/'}, 'Recommendation': {'Text': 'Ensure Elasticache Cluster has automatic backups enabled.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-1'}}",high,[],arn:partition:service:region:account-id:resource-id,Other,Ensure that your Amazon ElastiCache Redis cache clusters have a sufficient backup retention period set in order to fulfill your organization's compliance requirements. The retention period represents the number of days for which Amazon ElastiCache service retains automatic Redis cluster backups before deleting them.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_redis_cluster_multi_az_enabled/elasticache_redis_cluster_multi_az_enabled.metadata.json,,https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/ElastiCache/elasticache-multi-az.html#,elasticache,Ensure Elasticache Redis cache cluster has Multi-AZ enabled.,['redundancy'],,Ensure Elasticache Redis cache cluster has Multi-AZ enabled.,,[],,[],elasticache_redis_cluster_multi_az_enabled,"{'Code': {'CLI': 'aws elasticache modify-replication-group --region <value> --replication-group-id <value> --multi-az-enabled --apply-immediately', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/ElastiCache/elasticache-multi-az.html#', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-elasticache-redis-cluster-with-multi-az-automatic-failover-feature-set-to-enabled/'}, 'Recommendation': {'Text': 'Ensure Elasticache Redis cache cluster has Multi-AZ enabled.', 'Url': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/ElastiCache/elasticache-multi-az.html#'}}",medium,[],arn:partition:service:region:account-id:resource-id,AWSElastiCacheClusters,Ensure that your Amazon ElastiCache Redis cache clusters has Multi-AZ enabled.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_redis_cluster_in_transit_encryption_enabled/elasticache_redis_cluster_in_transit_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-5,elasticache,Ensure Elasticache Redis cache clusters have in transit encryption enabled.,['encryption'],,Ensure Elasticache Redis cache clusters have in transit encryption enabled.,,[],,[],elasticache_redis_cluster_in_transit_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_10#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/general_10/', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_10#terraform'}, 'Recommendation': {'Text': 'Ensure your Elasticache Redis cache clusters have in transit encryption enabled.', 'Url': 'https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/in-transit-encryption.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,There is a risk of exposing sensitive data if Elasticache Redis cache cluster does not have in transit encryption enabled.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_redis_cluster_rest_encryption_enabled/elasticache_redis_cluster_rest_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-4,elasticache,Ensure Elasticache Redis cache clusters have at rest encryption enabled.,['encryption'],,Ensure Elasticache Redis cache clusters have at rest encryption enabled.,,[],,[],elasticache_redis_cluster_rest_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_9#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/general_9/', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_9#terraform'}, 'Recommendation': {'Text': 'Ensure your Elasticache Redis cache clusters have at rest encryption enabled.', 'Url': 'https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/at-rest-encryption.html#at-rest-encryption-enable'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,There is a risk of exposing sensitive data if Elasticache Redis cache clusters does not have at rest encryption enabled.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_redis_replication_group_auth_enabled/elasticache_redis_replication_group_auth_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/auth.html,elasticache,Ensure Elasticache Redis replication groups of earlier versions use Redis OSS AUTH.,[],,Ensure Elasticache Elasticache Redis replication groups of earlier versions should have Redis OSS AUTH enabled.,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls'],elasticache_redis_replication_group_auth_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Redis AUTH to require authentication before accessing your Redis instance, and for Redis 6.0 and later, consider implementing Role-Based Access Control (RBAC) for enhanced security.', 'Url': 'https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/auth.html#auth-modifyng-token'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,"Without Redis AUTH enabled, your ElastiCache (Redis) instance is vulnerable to unauthorized access and potential data breaches."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/elasticache/elasticache_redis_cluster_auto_minor_version_upgrades/elasticache_redis_cluster_auto_minor_version_upgrades.metadata.json,,https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/VersionManagement.html,elasticache,Ensure Elasticache Redis cache clusters have automatic minor upgrades enabled.,[],,Ensure Elasticache Redis cache clusters have automatic minor upgrades enabled.,,[],,[],elasticache_redis_cluster_auto_minor_version_upgrades,"{'Code': {'CLI': 'aws elasticache modify-cache-cluster --cache-cluster-id <cluster_id> --apply-immediately --auto-minor-version-upgrade', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/elasticache-controls.html#elasticache-2', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure Elasticache clusters have automatic minor upgrades enabled.', 'Url': 'https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/Clusters.html#Modify'}}",high,[],arn:partition:service:region:account-id:resource-id,Other,"Not enabling automatic minor version upgrades can expose your Redis cluster to security vulnerabilities, performance issues, and increased operational overhead due to the need for manual updates."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/appstream/appstream_fleet_maximum_session_duration/appstream_fleet_maximum_session_duration.metadata.json,,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,appstream,Ensure user maximum session duration is no longer than 10 hours.,[],Infrastructure Security,Ensure user maximum session duration is no longer than 10 hours.,,[],,['Infrastructure Security'],appstream_fleet_maximum_session_duration,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Change the Maximum session duration is set to 600 minutes or less for the AppStream Fleet.', 'Url': 'https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html'}}",medium,[],arn:partition:appstream:region:account-id:fleet/resource-id,Other,Having a session duration lasting longer than 10 hours should not be necessary and if running for any malicious reasons provides a greater time for usage than should be allowed.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/appstream/appstream_fleet_default_internet_access_disabled/appstream_fleet_default_internet_access_disabled.metadata.json,,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,appstream,Ensure default Internet Access from your Amazon AppStream fleet streaming instances should remain unchecked.,[],Infrastructure Security,Ensure default Internet Access from your Amazon AppStream fleet streaming instances should remain unchecked.,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",appstream_fleet_default_internet_access_disabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Uncheck the default internet access for the AppStream Fleet.', 'Url': 'https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html'}}",medium,[],arn:partition:appstream:region:account-id:fleet/resource-id,Other,Default Internet Access from your fleet streaming instances should be controlled using a NAT gateway in the VPC.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/appstream/appstream_fleet_session_idle_disconnect_timeout/appstream_fleet_session_idle_disconnect_timeout.metadata.json,,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,appstream,Ensure session idle disconnect timeout is set to 10 minutes or less.,[],Infrastructure Security,Ensure session idle disconnect timeout is set to 10 minutes or less.,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",appstream_fleet_session_idle_disconnect_timeout,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Change the session idle timeout to 10 minutes or less for the AppStream Fleet.', 'Url': 'https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html'}}",medium,[],arn:partition:appstream:region:account-id:fleet/resource-id,Other,Idle disconnect timeout in minutes is the amount of time that users can be inactive before they are disconnected from their streaming session and the Disconnect timeout in minutes time begins.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/appstream/appstream_fleet_session_disconnect_timeout/appstream_fleet_session_disconnect_timeout.metadata.json,,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,appstream,Ensure session disconnect timeout is set to 5 minutes or less,[],Infrastructure Security,Ensure session disconnect timeout is set to 5 minutes or less.,,[],,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",appstream_fleet_session_disconnect_timeout,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Change the Disconnect timeout to 5 minutes or less for the AppStream Fleet.', 'Url': 'https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html'}}",medium,[],arn:partition:appstream:region:account-id:fleet/resource-id,Other,"Disconnect timeout in minutes, is the amount of of time that a streaming session remains active after users disconnect."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_multi_az/rds_instance_multi_az.metadata.json,,https://aws.amazon.com/rds/features/multi-az/,rds,Check if RDS instances have multi-AZ enabled.,['redundancy'],,Check if RDS instances have multi-AZ enabled.,,[],,[],rds_instance_multi_az,"{'Code': {'CLI': 'aws rds create-db-instance --db-instance-identifier <db_instance_id> --multi-az true', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_73#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-multi-az.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_73#terraform'}, 'Recommendation': {'Text': 'Enable multi-AZ deployment for production databases.', 'Url': 'https://aws.amazon.com/rds/features/multi-az/'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"In case of failure, with a single-AZ deployment configuration, should an availability zone specific database failure occur, Amazon RDS can not automatically fail over to the standby availability zone."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_deprecated_engine_version/rds_instance_deprecated_engine_version.metadata.json,,https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-engine-versions.html,rds,"Check if RDS is using a supported engine version for MariaDB, MySQL and PostgreSQL",[],,Check if RDS instance is using a supported engine version,,[],,[],rds_instance_deprecated_engine_version,"{'Code': {'CLI': ""aws rds describe-db-engine-versions --engine <my_engine>'"", 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure all the RDS instances are using a supported engine version', 'Url': 'https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-engine-versions.html'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,If not enabled RDS instances may be vulnerable to security issues
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_event_subscription_parameter_groups/rds_instance_event_subscription_parameter_groups.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html,rds,Ensure that Amazon RDS event notification subscriptions are enabled for database parameter groups events.,[],,Check if RDS Parameter Group events are subscribed.,,[],,[],rds_instance_event_subscription_parameter_groups,"{'Code': {'CLI': ""aws rds create-event-subscription --source-type db-instance --event-categories 'configuration change' --sns-topic-arn <sns-topic-arn>"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-21', 'Terraform': ''}, 'Recommendation': {'Text': 'To subscribe to RDS instance event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.Subscribing.html'}}",low,[],arn:aws:rds:region:account-id:account,AwsAccount,"Amazon RDS event subscriptions for database parameter groups are designed to provide incident notification of events that may affect the security, availability, and reliability of the RDS database instances associated with these parameter groups."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_minor_version_upgrade_enabled/rds_cluster_minor_version_upgrade_enabled.metadata.json,,https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/,rds,Ensure RDS clusters have minor version upgrade enabled.,[],,Ensure RDS clusters have minor version upgrade enabled.,,[],,[],rds_cluster_minor_version_upgrade_enabled,"{'Code': {'CLI': 'aws rds modify-db-cluster --db-cluster-identifier <db_cluster_id> --auto-minor-version-upgrade --apply-immediately', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically#cloudformation', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-35', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically#terraform'}, 'Recommendation': {'Text': 'Enable auto minor version upgrade for all databases and environments.', 'Url': 'https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,Auto Minor Version Upgrade is a feature that you can enable to have your database automatically upgraded when a new minor database engine version is available. Minor version upgrades often patch security vulnerabilities and fix bugs and therefore should be applied.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_integration_cloudwatch_logs/rds_cluster_integration_cloudwatch_logs.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_LogAccess.html,rds,"Check if RDS cluster is integrated with CloudWatch Logs. The types valid are Aurora MySQL, Aurora PostgreSQL, MySQL, PostgreSQL.",['logging'],,Check if RDS cluster is integrated with CloudWatch Logs.,,[],,[],rds_cluster_integration_cloudwatch_logs,"{'Code': {'CLI': ""aws rds modify-db-cluster --db-cluster-identifier <db_cluster_id> --cloudwatch-logs-export-configuration {'EnableLogTypes':['audit',error','general','slowquery']} --apply-immediately"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-34', 'Terraform': ''}, 'Recommendation': {'Text': 'Use CloudWatch Logs to perform real-time analysis of the log data. Create alarms and view metrics.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/publishing_cloudwatchlogs.html'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_storage_encrypted/rds_instance_storage_encrypted.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html,rds,Check if RDS instances storage is encrypted.,[],,Check if RDS instances storage is encrypted.,,[],,[],rds_instance_storage_encrypted,"{'Code': {'CLI': 'aws rds create-db-instance --db-instance-identifier <db_instance_id> --db-instance-class <instance_class> --engine <engine> --storage-encrypted true', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_4#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_4#terraform'}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_copy_tags_to_snapshots/rds_cluster_copy_tags_to_snapshots.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Tagging.html#USER_Tagging.CopyTags,rds,"Check if RDS DB clusters have copy tags to snapshots enabled, Aurora instances do not support this feature at instance level so those who are clustered will be scan by this check.",[],,Check if RDS DB clusters have copy tags to snapshots enabled,,[],,[],rds_cluster_copy_tags_to_snapshots,"{'Code': {'CLI': 'aws rds modify-db-cluster --db-cluster-identifier <cluster-identifier> --copy-tags-to-snapshot', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-16', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that the `CopyTagsToSnapshot` setting is enabled for all RDS clusters to propagate cluster tags to their snapshots for improved tracking and compliance.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Tagging.html#USER_Tagging.CopyTags'}}",low,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"If RDS clusters are not configured to copy tags to snapshots, it could lead to compliance issues as the snapshots will not inherit necessary metadata such as environment, owner, or purpose tags. This could result in inefficient tracking and management of RDS resources and their snapshots."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_copy_tags_to_snapshots/rds_instance_copy_tags_to_snapshots.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Tagging.html#USER_Tagging.CopyTags,rds,"Check if RDS DB instances have copy tags to snapshots enabled, Aurora instances can not have this feature enabled at this level, they will have it at cluster level",[],,Check if RDS DB instances have copy tags to snapshots enabled,,[],,[],rds_instance_copy_tags_to_snapshots,"{'Code': {'CLI': 'aws rds modify-db-instance --db-instance-identifier <instance-identifier> --copy-tags-to-snapshot', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-17', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that the `CopyTagsToSnapshot` setting is enabled for all RDS instances to propagate instance tags to their snapshots for improved tracking and compliance.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html'}}",low,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"If RDS instances are not configured to copy tags to snapshots, it could lead to compliance issues as the snapshots will not inherit necessary metadata such as environment, owner, or purpose tags. This could result in inefficient tracking and management of RDS resources and their snapshots."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_storage_encrypted/rds_cluster_storage_encrypted.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html,rds,Check if RDS clusters storage is encrypted.,[],,Check if RDS clusters storage is encrypted.,,[],,[],rds_cluster_storage_encrypted,"{'Code': {'CLI': 'aws rds create-db-cluster --db-cluster-identifier <db_cluster_id> --db-cluster-class <cluster_class> --engine <engine> --storage-encrypted true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-27', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Overview.Encryption.html#Overview.Encryption.Enabling'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_default_admin/rds_instance_default_admin.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-25,rds,Ensure that your Amazon RDS instances are not using the default master username.,[],,Ensure that your Amazon RDS instances are not using the default master username.,,[],,[],rds_instance_default_admin,"{'Code': {'CLI': '', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#'}, 'Recommendation': {'Text': 'To change the master username configured for your Amazon RDS database instances you must re-create them and migrate the existing data.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-25'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,Since admin is the Amazon's example for the RDS database master username and postgres is the default PostgreSQL master username. Many AWS customers will use this username for their RDS database instances in production. Malicious users can use this information to their advantage and frequently try to use default master username during brute-force attacks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_iam_authentication_enabled/rds_cluster_iam_authentication_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html,rds,Check if RDS clusters have IAM authentication enabled.,[],,Check if RDS clusters have IAM authentication enabled.,,[],,[],rds_cluster_iam_authentication_enabled,"{'Code': {'CLI': 'aws rds modify-db-instance --region <REGION> --db-instance-identifier <DB_CLUSTER_ID> --enable-iam-database-authentication --apply-immediately', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/iam-database-authentication.html#', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-12', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/iam-database-authentication.html#'}, 'Recommendation': {'Text': 'Enable IAM authentication for supported RDS clusters.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"Ensure that the IAM Database Authentication feature is enabled for your RDS database clusters in order to use the Identity and Access Management (IAM) service to manage database access to your MySQL and PostgreSQL database clusters. With this feature enabled, you don't have to use a password when you connect to your MySQL/PostgreSQL database, instead you can use an authentication token. An authentication token is a unique string of characters with a lifetime of 15 minutes that Amazon RDS generates on your request. IAM Database Authentication removes the need of storing user credentials within the database configuration, because authentication is managed externally using Amazon IAM."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_backtrack_enabled/rds_cluster_backtrack_enabled.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-14,rds,"Ensure that the Backtrack feature is enabled for your Amazon Aurora (with MySQL compatibility) database clusters in order to backtrack your clusters to a specific time, without using backups. Backtrack is an Amazon RDS feature that allows you to specify the amount of time that an Aurora MySQL database cluster needs to retain change records, in order to have a fast way to recover from user errors, such as dropping the wrong table or deleting the wrong row by moving your MySQL database to a prior point in time without the need to restore from a recent backup.",[],,Check if RDS Aurora MySQL Clusters have backtrack enabled.,,[],,[],rds_cluster_backtrack_enabled,"{'Code': {'CLI': 'aws rds restore-db-cluster-to-point-in-time --region <REGION> --source-db-cluster-identifier <SOURCE_DB_CLUSTER_ID> --db-cluster-identifier <DB_CLUSTER_ID> --restore-type copy-on-write --use-latest-restorable-time --backtrack-window 86400', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/backtrack.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/backtrack.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/backtrack.html#'}, 'Recommendation': {'Text': 'Backups help you to recover more quickly from a security incident. They also strengthens the resilience of your systems. Aurora backtracking reduces the time to recover a database to a point in time. It does not require a database restore to do so. You cannot enable backtracking on an existing cluster. Instead, you can create a clone that has backtracking enabled.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-14'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"Once the Backtrack feature is enabled, Amazon RDS can quickly 'rewind' your Aurora MySQL database cluster to a point in time that you specify. In contrast to the backup and restore method, with Backtrack you can easily undo a destructive action, such as a DELETE query without a WHERE clause, with minimal downtime, you can rewind your Aurora cluster in just few minutes, and you can repeatedly backtrack a database cluster back and forth in time to help determine when a particular data change occurred."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_critical_event_subscription/rds_instance_critical_event_subscription.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html,rds,"Ensure that Amazon RDS event notification subscriptions are enabled for database database events, particularly maintenance, configuration change and failure.",[],,Check if RDS Instances events are subscribed.,,[],,"['Software and Configuration Checks, AWS Security Best Practices']",rds_instance_critical_event_subscription,"{'Code': {'CLI': ""aws rds create-event-subscription --source-type db-instance --event-categories 'failure' 'maintenance' 'configuration change' --sns-topic-arn <sns-topic-arn>"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-20', 'Terraform': ''}, 'Recommendation': {'Text': 'To subscribe to RDS instance event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.Subscribing.html'}}",low,[],arn:aws:rds:region:account-id:db-instance,AwsRdsEventSubscription,"Without event subscriptions for critical events, such as maintenance, configuration changes and failures, you may not be aware of issues affecting your RDS instances, leading to downtime or security vulnerabilities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_enhanced_monitoring_enabled/rds_instance_enhanced_monitoring_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html,rds,Check if RDS instances has enhanced monitoring enabled.,[],,Check if RDS instances has enhanced monitoring enabled.,,[],,[],rds_instance_enhanced_monitoring_enabled,"{'Code': {'CLI': 'aws rds create-db-instance --db-instance-identifier <db_instance_id> --db-instance-class <instance_class> --engine <engine> --storage-encrypted true', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances#terraform'}, 'Recommendation': {'Text': 'To use Enhanced Monitoring, you must create an IAM role, and then enable Enhanced Monitoring.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html'}}",low,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,A smaller monitoring interval results in more frequent reporting of OS metrics.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_inside_vpc/rds_instance_inside_vpc.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.WorkingWithRDSInstanceinaVPC.html#USER_VPC.Subnets,rds,Check if RDS instances are deployed within a VPC.,[],,Check if RDS instances are deployed within a VPC.,,[],,"['Software and Configuration Checks, AWS Security Best Practices']",rds_instance_inside_vpc,"{'Code': {'CLI': 'aws rds modify-db-instance --db-instance-identifier <instance-identifier> --vpc-security-group-ids <vpc-security-group-ids>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-18', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that your RDS instances are deployed within a VPC to provide an additional layer of security to your database instances.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html'}}",high,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"If your RDS instances are not deployed within a VPC, they are not isolated from the public internet and are exposed to potential security threats. Deploying RDS instances within a VPC allows you to control inbound and outbound traffic to and from the instances, and provides an additional layer of security to your database instances."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_deletion_protection/rds_instance_deletion_protection.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html,rds,Check if RDS instances have deletion protection enabled.,[],,Check if RDS instances have deletion protection enabled.,,[],,[],rds_instance_deletion_protection,"{'Code': {'CLI': 'aws rds modify-db-instance --db-instance-identifier <db_instance_id> --deletion-protection --apply-immediately', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/instance-deletion-protection.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled#terraform'}, 'Recommendation': {'Text': 'Enable deletion protection using the AWS Management Console for production DB instances.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,You can only delete instances that do not have deletion protection enabled.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_snapshots_public_access/rds_snapshots_public_access.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/rds-snapshots-public-prohibited.html,rds,Check if RDS Snapshots and Cluster Snapshots are public.,['internet-exposed'],,Check if RDS Snapshots and Cluster Snapshots are public.,,[],,[],rds_snapshots_public_access,"{'Code': {'CLI': 'aws rds modify-db-snapshot-attribute --db-snapshot-identifier <snapshot_id> --attribute-name restore --values-to-remove all', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/public-snapshots.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Use AWS Config to identify any snapshot that is public.', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/rds-snapshots-public-prohibited.html'}}",critical,[],arn:aws:rds:region:account-id:snapshot,AwsRdsDbSnapshot,"Publicly accessible services could expose sensitive data to bad actors. t is recommended that your RDS snapshots should not be public in order to prevent potential leak or misuse of sensitive data or any other kind of security threat. If your RDS snapshot is public, then the data which is backed up in that snapshot is accessible to all other AWS accounts."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_certificate_expiration/rds_instance_certificate_expiration.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.SSL-certificate-rotation.html,rds,"To maintain Amazon RDS database security and avoid interruption of the applications that are using RDS and/or Aurora databases, rotate the required SSL/TLS certificates and update the deprecated Certificate Authority (CA) certificates at the Amazon RDS instance level.",['encryption'],,Ensure that the SSL/TLS certificates configured for your Amazon RDS are not expired.,,[],,[],rds_instance_certificate_expiration,"{'Code': {'CLI': 'aws rds modify-db-instance --region us-east-1 --db-instance-identifier cc-project5-mysql-database --ca-certificate-identifier ""rds-ca-2019"" --apply-immediately', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rotate-rds-certificates.html', 'Terraform': ''}, 'Recommendation': {'Text': 'To maintain Amazon RDS database security and avoid interruption of the applications that are using RDS and/or Aurora databases, rotate the required SSL/TLS certificates and update the deprecated Certificate Authority (CA) certificates at the Amazon RDS instance level.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.SSL-certificate-rotation.html'}}",high,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,Interruption of application if the certificate expires.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_no_public_access/rds_instance_no_public_access.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/rds-instance-public-access-check.html,rds,Ensure there are no Public Accessible RDS instances.,['internet-exposed'],,Ensure there are no Public Accessible RDS instances.,,[],,[],rds_instance_no_public_access,"{'Code': {'CLI': 'aws rds modify-db-instance --db-instance-identifier <db_instance_id> --no-publicly-accessible --apply-immediately', 'NativeIaC': 'https://docs.prowler.com/checks/aws/public-policies/public_2#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-publicly-accessible.html', 'Terraform': 'https://docs.prowler.com/checks/aws/public-policies/public_2#terraform'}, 'Recommendation': {'Text': 'Using an AWS Config rule check for RDS public instances periodically and check there is a business reason for it.', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/rds-instance-public-access-check.html'}}",critical,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,Publicly accessible databases could expose sensitive data to bad actors.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_critical_event_subscription/rds_cluster_critical_event_subscription.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html,rds,"Ensure that Amazon RDS event notification subscriptions are enabled for database cluster events, particularly maintenance and failure.",[],,Check if RDS Cluster critical events are subscribed.,,[],,"['Software and Configuration Checks, AWS Security Best Practices']",rds_cluster_critical_event_subscription,"{'Code': {'CLI': ""aws rds create-event-subscription --source-type db-cluster --event-categories 'failure' 'maintenance' --sns-topic-arn <sns-topic-arn>"", 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-19', 'Terraform': ''}, 'Recommendation': {'Text': 'To subscribe to RDS cluster event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.Subscribing.html'}}",low,[],arn:aws:rds:region:account-id:account,AwsAccount,"Without event subscriptions for critical events, such as maintenance and failures, you may not be aware of issues affecting your RDS clusters, leading to downtime or security vulnerabilities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_non_default_port/rds_instance_non_default_port.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html,rds,Checks if an instance uses a port other than the default port of the database engine. The control fails if the RDS instance uses the default port.,[],,Check if RDS instances are using non-default ports.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],rds_instance_non_default_port,"{'Code': {'CLI': 'aws rds modify-db-instance --db-instance-identifier <db-instance-id> --port <non-default-port>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-23', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the RDS instance to use a non-default port, and ensure that the security group permits access to the new port.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html'}}",low,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"Using a default database port exposes the instance to potential security vulnerabilities, as attackers are more likely to target known, commonly-used ports. This may result in unauthorized access to the database or increased susceptibility to automated attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_deletion_protection/rds_cluster_deletion_protection.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html,rds,Check if RDS clusters have deletion protection enabled.,[],,Check if RDS clusters have deletion protection enabled.,,[],,[],rds_cluster_deletion_protection,"{'Code': {'CLI': 'aws rds modify-db-cluster --db-cluster-identifier <db_cluster_id> --deletion-protection --apply-immediately', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-7', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled#terraform'}, 'Recommendation': {'Text': 'Enable deletion protection using the AWS Management Console for production DB clusters.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html'}}",low,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,You can only delete clusters that do not have deletion protection enabled.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_non_default_port/rds_cluster_non_default_port.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html,rds,Checks if an cluster uses a port other than the default port of the database engine. The control fails if the RDS cluster uses the default port.,[],,Check if RDS clusters are using non-default ports.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],rds_cluster_non_default_port,"{'Code': {'CLI': 'aws rds modify-db-cluster --db-cluster-identifier <db-cluster-id> --port <non-default-port>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-23', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the RDS cluster to use a non-default port, and ensure that the security group permits access to the new port.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html'}}",low,[],arn:aws:rds:region:account-id:cluster:db-cluster,AwsRdsDbCluster,"Using a default database port exposes the cluster to potential security vulnerabilities, as attackers are more likely to target known, commonly-used ports. This may result in unauthorized access to the database or increased susceptibility to automated attacks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_multi_az/rds_cluster_multi_az.metadata.json,,https://aws.amazon.com/rds/features/multi-az/,rds,Check if RDS clusters have multi-AZ enabled.,['redundancy'],,Check if RDS clusters have multi-AZ enabled.,,[],,[],rds_cluster_multi_az,"{'Code': {'CLI': 'aws rds create-db-cluster --db-cluster-identifier <db_cluster_id> --multi-az true', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_73#cloudformation', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-15', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_73#terraform'}, 'Recommendation': {'Text': 'Enable multi-AZ deployment for production databases.', 'Url': 'https://aws.amazon.com/rds/features/multi-az/'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,"In case of failure, with a single-AZ deployment configuration, should an availability zone specific database failure occur, Amazon RDS can not automatically fail over to the standby availability zone."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_backup_enabled/rds_instance_backup_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html,rds,Check if RDS instances have backup enabled.,[],,Check if RDS instances have backup enabled.,,[],,[],rds_instance_backup_enabled,"{'Code': {'CLI': 'aws rds modify-db-instance --db-instance-identifier <db_instance_id> --backup-retention-period 7 --apply-immediately', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-automated-backups-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-rds-instances-have-backup-policy#terraform'}, 'Recommendation': {'Text': 'Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"If backup is not enabled, data is vulnerable. Human error or bad actors could erase or modify data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_default_admin/rds_cluster_default_admin.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-24,rds,Ensure that your Amazon RDS clusters are not using the default master username.,[],,Ensure that your Amazon RDS clusters are not using the default master username.,,[],,[],rds_cluster_default_admin,"{'Code': {'CLI': '', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-master-username.html#'}, 'Recommendation': {'Text': 'To change the master username configured for your Amazon RDS database clusters you must re-create them and migrate the existing data.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-24'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbCluster,Since admin is the Amazon's example for the RDS database master username and postgres is the default PostgreSQL master username. Many AWS customers will use this username for their RDS database instances in production. Malicious users can use this information to their advantage and frequently try to use default master username during brute-force attacks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_minor_version_upgrade_enabled/rds_instance_minor_version_upgrade_enabled.metadata.json,,https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/,rds,Ensure RDS instances have minor version upgrade enabled.,[],,Ensure RDS instances have minor version upgrade enabled.,,[],,[],rds_instance_minor_version_upgrade_enabled,"{'Code': {'CLI': 'aws rds modify-db-instance --db-instance-identifier <db_instance_id> --auto-minor-version-upgrade --apply-immediately', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-auto-minor-version-upgrade.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically#terraform'}, 'Recommendation': {'Text': 'Enable auto minor version upgrade for all databases and environments.', 'Url': 'https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/'}}",low,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,Auto Minor Version Upgrade is a feature that you can enable to have your database automatically upgraded when a new minor database engine version is available. Minor version upgrades often patch security vulnerabilities and fix bugs and therefore should be applied.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_snapshots_encrypted/rds_snapshots_encrypted.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-4,rds,Check if RDS Snapshots and Cluster Snapshots are encrypted.,['encryption'],,Check if RDS Snapshots and Cluster Snapshots are encrypted.,,[],,[],rds_snapshots_encrypted,"{'Code': {'CLI': '', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/snapshot-encrypted.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/snapshot-encrypted.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/snapshot-encrypted.html#'}, 'Recommendation': {'Text': 'When working with production databases that hold sensitive and critical data, it is strongly recommended to implement encryption at rest and protect your data from attackers or unauthorized personnel. ', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-4'}}",medium,[],arn:aws:rds:region:account-id:snapshot,AwsRdsDbSnapshot,Ensure that your manual Amazon RDS database snapshots are encrypted in order to achieve compliance for data-at-rest encryption within your organization.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_event_subscription_security_groups/rds_instance_event_subscription_security_groups.metadata.json,,https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-22,rds,Ensure that Amazon RDS event notification subscriptions are enabled for database security groups events.,[],,Check if RDS Security Group events are subscribed.,,[],,[],rds_instance_event_subscription_security_groups,"{'Code': {'CLI': '', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-db-security-groups-events.html#', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-db-security-groups-events.html#', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/rds-db-security-groups-events.html#'}, 'Recommendation': {'Text': 'To subscribe to RDS instance event notifications, see Subscribing to Amazon RDS event notification in the Amazon RDS User Guide.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-22'}}",medium,[],arn:aws:rds:region:account-id:es,AwsRdsEventSubscription,"Amazon RDS event subscriptions for database security groups are designed to provide incident notification of events that may affect the security, availability, and reliability of the RDS database instances associated with these security groups."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_cluster_protected_by_backup_plan/rds_cluster_protected_by_backup_plan.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html,rds,Check if RDS clusters are protected by a backup plan.,[],,Check if RDS clusters are protected by a backup plan.,,[],,"['Software and Configuration Checks, AWS Security Best Practices']",rds_cluster_protected_by_backup_plan,"{'Code': {'CLI': 'aws backup create-backup-plan --backup-plan , aws backup tag-resource --resource-arn <rds-cluster-arn> --tags Key=backup,Value=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-26', 'Terraform': ''}, 'Recommendation': {'Text': 'Create a backup plan for the RDS cluster to protect it from data loss, accidental deletion, or corruption.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html'}}",medium,[],arn:aws:rds:region:account-id:db-cluster,AwsRdsDbInstance,"Without a backup plan, RDS clusters are vulnerable to data loss, accidental deletion, or corruption. This could lead to significant operational disruptions or loss of critical data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_protected_by_backup_plan/rds_instance_protected_by_backup_plan.metadata.json,,https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html,rds,Check if RDS instances are protected by a backup plan.,[],,Check if RDS instances are protected by a backup plan.,,[],,"['Software and Configuration Checks, AWS Security Best Practices']",rds_instance_protected_by_backup_plan,"{'Code': {'CLI': 'aws backup create-backup-plan --backup-plan , aws backup tag-resource --resource-arn <rds-instance-arn> --tags Key=backup,Value=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-26', 'Terraform': ''}, 'Recommendation': {'Text': 'Create a backup plan for the RDS instance to protect it from data loss, accidental deletion, or corruption.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"Without a backup plan, RDS instances are vulnerable to data loss, accidental deletion, or corruption. This could lead to significant operational disruptions or loss of critical data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_iam_authentication_enabled/rds_instance_iam_authentication_enabled.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html,rds,Check if RDS instances have IAM authentication enabled.,[],,Check if RDS instances have IAM authentication enabled.,,[],,[],rds_instance_iam_authentication_enabled,"{'Code': {'CLI': 'aws rds modify-db-instance --region <REGION> --db-instance-identifier <DB_INSTANCE_ID> --enable-iam-database-authentication --apply-immediately', 'NativeIaC': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/iam-database-authentication.html#', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/rds-controls.html#rds-10', 'Terraform': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/iam-database-authentication.html#'}, 'Recommendation': {'Text': 'Enable IAM authentication for supported RDS instances.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.Enabling.html'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"Ensure that the IAM Database Authentication feature is enabled for your RDS database instances in order to use the Identity and Access Management (IAM) service to manage database access to your MySQL and PostgreSQL database instances. With this feature enabled, you don't have to use a password when you connect to your MySQL/PostgreSQL database, instead you can use an authentication token. An authentication token is a unique string of characters with a lifetime of 15 minutes that Amazon RDS generates on your request. IAM Database Authentication removes the need of storing user credentials within the database configuration, because authentication is managed externally using Amazon IAM."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_integration_cloudwatch_logs/rds_instance_integration_cloudwatch_logs.metadata.json,,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/publishing_cloudwatchlogs.html,rds,Check if RDS instances is integrated with CloudWatch Logs.,['logging'],,Check if RDS instances is integrated with CloudWatch Logs.,,[],,[],rds_instance_integration_cloudwatch_logs,"{'Code': {'CLI': ""aws rds modify-db-instance --db-instance-identifier <db_instance_id> --cloudwatch-logs-export-configuration {'EnableLogTypes':['audit',error','general','slowquery']} --apply-immediately"", 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/log-exports.html', 'Terraform': 'https://docs.prowler.com/checks/aws/iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled#terraform'}, 'Recommendation': {'Text': 'Use CloudWatch Logs to perform real-time analysis of the log data. Create alarms and view metrics.', 'Url': 'https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/publishing_cloudwatchlogs.html'}}",medium,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/rds/rds_instance_transport_encrypted/rds_instance_transport_encrypted.metadata.json,,https://aws.amazon.com/premiumsupport/knowledge-center/rds-connect-ssl-connection/,rds,"For SQL Server, PostgreSQL, and Aurora PostgreSQL databases, if the `rds.force_ssl` parameter value is set to 0, SSL/TLS connections are not enforced. For MySQL, Aurora MySQL, and MariaDB databases, if the `require_secure_transport` parameter value is set to OFF, SSL/TLS connections are not enforced. Enforcing SSL/TLS ensures that all client connections to RDS instances are encrypted, protecting sensitive information in transit.",['encryption'],,"Check if RDS instances enforce SSL/TLS encryption for client connections (Microsoft SQL Server, PostgreSQL, MySQL, MariaDB, Aurora PostgreSQL, and Aurora MySQL).",,[],,[],rds_instance_transport_encrypted,"{'Code': {'CLI': ""aws rds modify-db-parameter-group --region <REGION_NAME> --db-parameter-group-name <PARAMETER_GROUP_NAME> --parameters ParameterName='rds.force_ssl',ParameterValue='1',ApplyMethod='pending-reboot'"", 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/transport-encryption.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that instances provisioned with Amazon RDS enforce SSL/TLS for client connections to meet security and compliance requirements.', 'Url': 'https://aws.amazon.com/premiumsupport/knowledge-center/rds-connect-ssl-connection/'}}",high,[],arn:aws:rds:region:account-id:db-instance,AwsRdsDbInstance,"If not enabled, sensitive information in transit is not protected."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/stepfunctions/stepfunctions_statemachine_logging_enabled/stepfunctions_statemachine_logging_enabled.metadata.json,,https://docs.aws.amazon.com/step-functions/latest/dg/logging.html,stepfunctions,This control checks if AWS Step Functions state machines have logging enabled. The control fails if the state machine doesn't have the loggingConfiguration property defined.,['logging'],,Step Functions state machines should have logging enabled,,[],,['Software and Configuration Checks/AWS Security Best Practices'],stepfunctions_statemachine_logging_enabled,"{'Code': {'CLI': 'aws stepfunctions update-state-machine --state-machine-arn <state-machine-arn> --logging-configuration file://logging-config.json', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/stepfunctions-controls.html#stepfunctions-1', 'Terraform': 'https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sfn_state_machine#logging_configuration'}, 'Recommendation': {'Text': 'Configure logging for your Step Functions state machines to ensure that operational data is captured and available for debugging, monitoring, and auditing purposes.', 'Url': 'https://docs.aws.amazon.com/step-functions/latest/dg/logging.html'}}",medium,[],arn:aws:states:{region}:{account-id}:stateMachine/{stateMachine-id},AwsStepFunctionStateMachine,"Without logging enabled, important operational data may be lost, making it difficult to troubleshoot issues, monitor performance, and ensure compliance with auditing requirements."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_public/apigateway_restapi_public.metadata.json,,,apigateway,Check if API Gateway endpoint is public or private.,['internet-exposed'],,Check if API Gateway endpoint is public or private.,['apigateway_public'],[],rest_api,['Infrastructure Security'],apigateway_restapi_public,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Verify that any public Api Gateway is protected and audited. Detective controls for common risks should be implemented.', 'Url': 'https://d1.awsstatic.com/whitepapers/api-gateway-security.pdf?svrd_sip6'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayRestApi,If accessible from internet without restrictions opens up attack / abuse surface for any malicious user.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_tracing_enabled/apigateway_restapi_tracing_enabled.metadata.json,,https://docs.aws.amazon.com/xray/latest/devguide/xray-services-apigateway.html,apigateway,This control checks whether AWS X-Ray active tracing is enabled for your Amazon API Gateway REST API stages.,[],,Check if AWS X-Ray tracing is enabled for API Gateway REST API stages.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],apigateway_restapi_tracing_enabled,"{'Code': {'CLI': 'aws apigateway update-stage --rest-api-id <restapi-id> --stage-name <stage-name> --patch-operations op=replace,path=/tracingEnabled,value=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable AWS X-Ray tracing for API Gateway REST API stages to monitor and analyze performance in real time.', 'Url': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/APIGateway/tracing.html'}}",low,[],arn:aws:apigateway:region:account-id:/restapis/restapi-id/stages/stage-name,AwsApiGatewayStage,"Without X-Ray active tracing, it may be difficult to quickly identify and respond to performance issues that could lead to decreased availability or degradation of the API's performance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_waf_acl_attached/apigateway_restapi_waf_acl_attached.metadata.json,,,apigateway,Check if API Gateway Stage has a WAF ACL attached.,[],,Check if API Gateway Stage has a WAF ACL attached.,['apigateway_waf_acl_attached'],[],rest_api,['Infrastructure Security'],apigateway_restapi_waf_acl_attached,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use AWS WAF to protect your API Gateway API from common web exploits, such as SQL injection and cross-site scripting (XSS) attacks. These could affect API availability and performance, compromise security or consume excessive resources.', 'Url': 'https://docs.aws.amazon.com/apigateway/latest/developerguide/security-monitoring.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayRestApi,"Potential attacks and / or abuse of service, more even for even for internet reachable services."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_logging_enabled/apigateway_restapi_logging_enabled.metadata.json,,,apigateway,Check if API Gateway Stage has logging enabled.,"['forensics-ready', 'logging']",,Check if API Gateway Stage has logging enabled.,['apigateway_logging_enabled'],[],rest_api,['Logging and Monitoring'],apigateway_restapi_logging_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate#terraform'}, 'Recommendation': {'Text': 'Monitoring is an important part of maintaining the reliability, availability and performance of API Gateway and your AWS solutions. You should collect monitoring data from all of the parts of your AWS solution. CloudTrail provides a record of actions taken by a user, role, or an AWS service in API Gateway. Using the information collected by CloudTrail, you can determine the request that was made to API Gateway, the IP address from which the request was made, who made the request, etc.', 'Url': 'https://docs.aws.amazon.com/apigateway/latest/developerguide/security-monitoring.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayRestApi,"If not enabled, monitoring of service use is not possible. Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_client_certificate_enabled/apigateway_restapi_client_certificate_enabled.metadata.json,,,apigateway,Check if API Gateway Stage has client certificate enabled to access your backend endpoint.,[],,Check if API Gateway Stage has client certificate enabled to access your backend endpoint.,['apigateway_client_certificate_enabled'],[],rest_api,['Data Protection'],apigateway_restapi_client_certificate_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable client certificate. Mutual TLS is recommended and commonly used for business-to-business (B2B) applications. It is used in standards such as Open Banking. API Gateway now provides integrated mutual TLS authentication at no additional cost.', 'Url': 'https://aws.amazon.com/blogs/compute/introducing-mutual-tls-authentication-for-amazon-api-gateway/'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayRestApi,Possible man in the middle attacks and other similar risks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_cache_encrypted/apigateway_restapi_cache_encrypted.metadata.json,,https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-caching.html#enable-api-gateway-caching,apigateway,This control checks whether all methods in API Gateway REST API stages that have cache enabled are encrypted. The control fails if any method in an API Gateway REST API stage is configured to cache and the cache is not encrypted.,['encryption'],,Check if API Gateway REST API cache data is encrypted at rest.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],apigateway_restapi_cache_encrypted,"{'Code': {'CLI': 'aws apigateway update-stage --rest-api-id <restapi-id> --stage-name <stage-name> --patch-operations op=replace,path=/<resourcePath>/<httpMethod>/caching/enabled,value=true op=replace,path=/<resourcePath>/<httpMethod>/caching/dataEncrypted,value=true', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/apigateway-controls.html#apigateway-5', 'Terraform': ''}, 'Recommendation': {'Text': ""Ensure that API Gateway REST API cache data is encrypted at rest by enabling the 'Encrypt cache data' setting in the API Gateway stage configuration."", 'Url': 'https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-caching.html#enable-api-gateway-caching'}}",medium,[],arn:aws:apigateway:region:account-id:/restapis/restapi-id/stages/stage-name,AwsApiGatewayStage,"Without encryption, cached data in API Gateway REST APIs may be vulnerable to unauthorized access, potentially exposing sensitive information to users not authenticated to AWS."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_authorizers_enabled/apigateway_restapi_authorizers_enabled.metadata.json,,,apigateway,Check if API Gateway has configured authorizers at api or method level.,[],,Check if API Gateway has configured authorizers at api or method level.,['apigateway_authorizers_enabled'],[],rest_api,['IAM'],apigateway_restapi_authorizers_enabled,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/public-policies/public_6-api-gateway-authorizer-set#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/public-policies/public_6-api-gateway-authorizer-set#terraform'}, 'Recommendation': {'Text': 'Implement Amazon Cognito or a Lambda function to control access to your API.', 'Url': 'https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayRestApi,If no authorizer is enabled anyone can use the service.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/apigateway/apigateway_restapi_public_with_authorizer/apigateway_restapi_public_with_authorizer.metadata.json,,https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-endpoint-types.html,apigateway,Check if API Gateway public endpoint has an authorizer configured.,['internet-exposed'],,Check if API Gateway public endpoint has an authorizer configured.,['apigateway_public_with_authorizer'],[],rest_api,['Infrastructure Security'],apigateway_restapi_public_with_authorizer,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Verify that any public API Gateway is protected and audited. Detective controls for common risks should be implemented.', 'Url': 'https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-endpoint-types.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsApiGatewayRestApi,If accessible from internet without restrictions opens up attack / abuse surface for any malicious user.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/efs/efs_multi_az_enabled/efs_multi_az_enabled.metadata.json,,https://docs.aws.amazon.com/efs/latest/ug/creating-using-create-fs.html#availabiltydurability,efs,Check if EFS File systems has Multi-AZ enabled.,['redundancy'],,Check if EFS File systems are configured with Multi-AZ.,,[],,[],efs_multi_az_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable EFS file systems Multi-AZ with mount targets in multiple AZs.', 'Url': 'https://docs.aws.amazon.com/efs/latest/ug/creating-using-create-fs.html#availabiltydurability'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEfsFileSystem,Ensure that your Amazon EFS are using Multi-AZ deployment configurations to provide High Availability (HA).
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/efs/efs_mount_target_not_publicly_accessible/efs_mount_target_not_publicly_accessible.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/efs-mount-target-public-accessible.html,efs,This control checks whether an Amazon EFS mount target is associated with a public subnet since it can be accessed from the internet.,['internet-exposed'],,EFS mount targets should not be publicly accessible,,[],,['Software and Configuration Checks/AWS Security Best Practices'],efs_mount_target_not_publicly_accessible,"{'Code': {'CLI': 'aws efs create-mount-target --file-system-id <filesystem-id> --subnet-id <private-subnet-id> --security-groups <sg-ids>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-6', 'Terraform': ''}, 'Recommendation': {'Text': 'Recreate the EFS mount target in a private subnet to ensure it is not publicly accessible.', 'Url': 'https://docs.aws.amazon.com/efs/latest/ug/accessing-fs.html'}}",medium,[],arn:aws:elasticfilesystem:{region}:{account-id}:file-system/{filesystem-id},AwsEfsFileSystem,Mount targets in public subnets may expose your EFS to unauthorized access or attacks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/efs/efs_not_publicly_accessible/efs_not_publicly_accessible.metadata.json,,,efs,Check if EFS have policies which allow access to any client within the VPC,['internet-exposed'],,Check if EFS have policies which allow access to any client within the VPC,,[],,"['Protect', 'Data protection']",efs_not_publicly_accessible,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure efs has some policy but it does not have principle as *', 'Url': 'https://docs.aws.amazon.com/efs/latest/ug/access-control-block-public-access.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEfsFileSystem,Restricting access to EFS file systems is a security best practice. Allowing access to any client within the VPC can lead to unauthorized access to the file system.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/efs/efs_encryption_at_rest_enabled/efs_encryption_at_rest_enabled.metadata.json,,,efs,Check if EFS protects sensitive data with encryption at rest,['encryption'],,Check if EFS protects sensitive data with encryption at rest,,[],,"['Protect', 'Data protection', 'Encryption of data at rest']",efs_encryption_at_rest_enabled,"{'Code': {'CLI': 'aws efs create-file-system --creation-token $(uuidgen) --performance-mode generalPurpose --encrypted --kms-key-id user/customer-managedCMKalias', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_17#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_17#terraform'}, 'Recommendation': {'Text': 'Ensure that encryption at rest is enabled for EFS file systems. Encryption at rest can only be enabled during the file system creation.', 'Url': 'https://docs.aws.amazon.com/efs/latest/ug/encryption-at-rest.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEfsFileSystem,EFS should be encrypted at rest to prevent exposure of sensitive data to bad actors
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/efs/efs_access_point_enforce_user_identity/efs_access_point_enforce_user_identity.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/efs-access-point-enforce-user-identity.html,efs,This control checks whether Amazon EFS access points are configured to enforce a user identity. This control fails if a POSIX user identity is not defined while creating the EFS access point.,['trustboundaries'],,EFS access points should enforce a user identity,,[],,['Software and Configuration Checks/AWS Security Best Practices'],efs_access_point_enforce_user_identity,"{'Code': {'CLI': 'aws efs create-access-point --file-system-id <file-system-id> --posix-user Uid=<uid>,Gid=<gid>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Create or update the EFS access point to enforce a user identity using POSIX attributes for Uid and Gid.', 'Url': 'https://docs.aws.amazon.com/efs/latest/ug/enforce-identity-access-points.html'}}",medium,[],arn:aws:elasticfilesystem:{region}:{account-id}:access-point/{access-point-id},AwsEfsAccessPoint,"Without enforcing a user identity, access to the file system can become less controlled, leading to potential unauthorized access or modifications."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/efs/efs_have_backup_enabled/efs_have_backup_enabled.metadata.json,,,efs,Check if EFS File systems have backup enabled,[],,Check if EFS File systems have backup enabled,,[],,"['Recover', 'Resilience', 'Backup']",efs_have_backup_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.', 'Url': 'https://docs.aws.amazon.com/efs/latest/ug/whatisefs.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEfsFileSystem,"If backup is not enabled, data is vulnerable. Human error or bad actors could erase or modify data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/efs/efs_access_point_enforce_root_directory/efs_access_point_enforce_root_directory.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/efs-access-point-enforce-root-directory.html,efs,This control checks if Amazon EFS access points are configured to enforce a root directory. The control fails if the value of Path is set to / (the default root directory of the file system).,['vulnerabilities'],,EFS access points should enforce a root directory,,[],access-point,['Software and Configuration Checks/AWS Security Best Practices'],efs_access_point_enforce_root_directory,"{'Code': {'CLI': 'aws efs update-access-point --access-point-id <access-point-id> --root-directory Path=<non-root-directory-path>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/efs-controls.html#efs-3', 'Terraform': ''}, 'Recommendation': {'Text': 'Update the EFS access point to enforce a non-root directory. This ensures clients can only access a specified subdirectory.', 'Url': 'https://docs.aws.amazon.com/efs/latest/ug/enforce-root-directory-access-point.html'}}",medium,[],arn:aws:elasticfilesystem:{region}:{account-id}:access-point/{access-point-id},AwsEfsAccessPoint,"Access points without enforced root directories can potentially expose the entire file system's root directory to clients, which may result in unauthorized access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_training_jobs_network_isolation_enabled/sagemaker_training_jobs_network_isolation_enabled.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,sagemaker,Check if Amazon SageMaker Training jobs have network isolation enabled,['gen-ai'],,Check if Amazon SageMaker Training jobs have network isolation enabled,,[],,[],sagemaker_training_jobs_network_isolation_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html'}}",medium,[],arn:aws:sagemaker:region:account-id:training-job,Other,This could provide an avenue for unauthorized access to your data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_endpoint_config_prod_variant_instances/sagemaker_endpoint_config_prod_variant_instances.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/sagemaker-endpoint-config-prod-instance-count.html,sagemaker,This control checks whether production variants of an Amazon SageMaker endpoint have an initial instance count greater than 1. A single instance creates a single point of failure and reduces availability.,"['redundancy', 'gen-ai']",,SageMaker endpoint production variants should have at least two initial instances,,[],,['Software and Configuration Checks/AWS Security Best Practices'],sagemaker_endpoint_config_prod_variant_instances,"{'Code': {'CLI': 'aws sagemaker update-endpoint --endpoint-name <endpoint-name> --endpoint-config-name <config-name>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/sagemaker-controls.html#sagemaker-4', 'Terraform': ''}, 'Recommendation': {'Text': 'To increase the initial instance count, configure your SageMaker endpoint to use more than 1 instance in the production variant for high availability.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/serverless-endpoints-create.html#serverless-endpoints-create-config'}}",medium,[],arn:aws:sagemaker:region:account-id:endpoint-config/resource-id,Other,"Having only one instance for a SageMaker endpoint production variant can lead to reduced availability, single points of failure, and slow recovery during incidents, especially if the instance becomes unavailable due to failure or security incidents."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_models_vpc_settings_configured/sagemaker_models_vpc_settings_configured.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html,sagemaker,Check if Amazon SageMaker Models have VPC settings configured,['gen-ai'],,Check if Amazon SageMaker Models have VPC settings configured,,[],,[],sagemaker_models_vpc_settings_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html'}}",medium,[],arn:aws:sagemaker:region:account-id:model,Other,This could provide an avenue for unauthorized access to your data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_training_jobs_volume_and_output_encryption_enabled/sagemaker_training_jobs_volume_and_output_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html,sagemaker,Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled,"['encryption', 'gen-ai']",,Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled,,[],,[],sagemaker_training_jobs_volume_and_output_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Specify AWS KMS keys to use for input and output from S3 and EBS.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html'}}",medium,[],arn:aws:sagemaker:region:account-id:training-job,Other,Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_training_jobs_vpc_settings_configured/sagemaker_training_jobs_vpc_settings_configured.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,sagemaker,Check if Amazon SageMaker Training job have VPC settings configured.,['gen-ai'],,Check if Amazon SageMaker Training job have VPC settings configured.,,[],,[],sagemaker_training_jobs_vpc_settings_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html'}}",medium,[],arn:aws:sagemaker:region:account-id:training-job,Other,This could provide an avenue for unauthorized access to your data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_notebook_instance_root_access_disabled/sagemaker_notebook_instance_root_access_disabled.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-root-access.html,sagemaker,Check if Amazon SageMaker Notebook instances have root access disabled,['gen-ai'],,Check if Amazon SageMaker Notebook instances have root access disabled,,[],,[],sagemaker_notebook_instance_root_access_disabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Set the RootAccess field to Disabled. You can also disable root access for users when you create or update a notebook instance in the Amazon SageMaker console.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-root-access.html'}}",medium,[],arn:aws:sagemaker:region:account-id:notebook-instance,AwsSageMakerNotebookInstance,"Users with root access have administrator privileges, users can access and edit all files on a notebook instance with root access enabled"
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_training_jobs_intercontainer_encryption_enabled/sagemaker_training_jobs_intercontainer_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,sagemaker,Check if Amazon SageMaker Training jobs have intercontainer encryption enabled,"['encryption', 'gen-ai']",,Check if Amazon SageMaker Training jobs have intercontainer encryption enabled,,[],,[],sagemaker_training_jobs_intercontainer_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Internetwork communications support TLS 1.2 encryption between all components and clients.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html'}}",medium,[],arn:aws:sagemaker:region:account-id:training-job,Other,If not restricted unintended access could happen.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_models_network_isolation_enabled/sagemaker_models_network_isolation_enabled.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html,sagemaker,Check if Amazon SageMaker Models have network isolation enabled,['gen-ai'],,Check if Amazon SageMaker Models have network isolation enabled,,[],,[],sagemaker_models_network_isolation_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html'}}",medium,[],arn:aws:sagemaker:region:account-id:model,Other,This could provide an avenue for unauthorized access to your data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_notebook_instance_without_direct_internet_access_configured/sagemaker_notebook_instance_without_direct_internet_access_configured.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,sagemaker,Check if Amazon SageMaker Notebook instances have direct internet access,"['internet-exposed', 'gen-ai']",,Check if Amazon SageMaker Notebook instances have direct internet access,,[],,[],sagemaker_notebook_instance_without_direct_internet_access_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-direct-internet-access.html', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-that-direct-internet-access-is-disabled-for-an-amazon-sagemaker-notebook-instance#fix---buildtime'}, 'Recommendation': {'Text': 'Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html'}}",medium,[],arn:aws:sagemaker:region:account-id:notebook-instance,AwsSageMakerNotebookInstance,This could provide an avenue for unauthorized access to your data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_notebook_instance_encryption_enabled/sagemaker_notebook_instance_encryption_enabled.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html,sagemaker,Check if Amazon SageMaker Notebook instances have data encryption enabled,"['encryption', 'gen-ai']",,Check if Amazon SageMaker Notebook instances have data encryption enabled,,[],,[],sagemaker_notebook_instance_encryption_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-data-encrypted.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_40#fix---buildtime'}, 'Recommendation': {'Text': 'Specify AWS KMS keys to use for input and output from S3 and EBS.', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html'}}",medium,[],arn:aws:sagemaker:region:account-id:notebook-instance,AwsSageMakerNotebookInstance,Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/sagemaker/sagemaker_notebook_instance_vpc_settings_configured/sagemaker_notebook_instance_vpc_settings_configured.metadata.json,,https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html,sagemaker,Check if Amazon SageMaker Notebook instances have VPC settings configured,['gen-ai'],,Check if Amazon SageMaker Notebook instances have VPC settings configured,,[],,[],sagemaker_notebook_instance_vpc_settings_configured,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SageMaker/notebook-instance-in-vpc.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing..', 'Url': 'https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html'}}",medium,[],arn:aws:sagemaker:region:account-id:notebook-instance,AwsSageMakerNotebookInstance,This could provide an avenue for unauthorized access to your data.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/acm/acm_certificates_with_secure_key_algorithms/acm_certificates_with_secure_key_algorithms.metadata.json,,https://docs.aws.amazon.com/acm/latest/userguide/acm-certificate.html,acm,"Check if ACM Certificates use a secure key algorithm (RSA 2048 bits or more, or ECDSA 256 bits or more). For example certificates that use RSA-1024 can be compromised because the encryption could be broken in no more than 2^80 guesses making it vulnerable to a factorization attack.",[],,Check if ACM Certificates use a secure key algorithm,,[],,['Data Protection'],acm_certificates_with_secure_key_algorithms,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that all ACM certificates use a secure key algorithm. If any certificates use smaller keys, regenerate them with a secure key size and update any systems that rely on these certificates.', 'Url': 'https://docs.aws.amazon.com/securityhub/latest/userguide/acm-controls.html#acm-2'}}",high,[],arn:partition:acm:region:account-id:certificate/resource-id,AwsCertificateManagerCertificate,"Certificates with weak RSA or ECDSA keys can be compromised because the length of the key defines the security of the encryption. The number of bits in the key determines the number of guesses an attacker would have to make in order to decrypt the data. The more bits in the key, the more secure the encryption."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/acm/acm_certificates_expiration_check/acm_certificates_expiration_check.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/acm-certificate-expiration-check.html,acm,Check if ACM Certificates are about to expire in specific days or less,[],,Check if ACM Certificates are about to expire in specific days or less,,[],,['Data Protection'],acm_certificates_expiration_check,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Monitor certificate expiration and take automated action to renew, replace or remove. Having shorter TTL for any security artifact is a general recommendation, but requires additional automation in place. If not longer required delete certificate. Use AWS config using the managed rule: acm-certificate-expiration-check.', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/acm-certificate-expiration-check.html'}}",high,[],arn:partition:acm:region:account-id:certificate/resource-id,AwsCertificateManagerCertificate,Expired certificates can impact service availability.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/acm/acm_certificates_transparency_logs_enabled/acm_certificates_transparency_logs_enabled.metadata.json,,https://aws.amazon.com/blogs/security/how-to-get-ready-for-certificate-transparency/,acm,Check if ACM certificates have Certificate Transparency logging enabled,['logging'],,Check if ACM certificates have Certificate Transparency logging enabled,,[],,['Logging and Monitoring'],acm_certificates_transparency_logs_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Make sure you are logging information about Lambda operations. Create a lifecycle and use cases for each trail.', 'Url': 'https://aws.amazon.com/blogs/security/how-to-get-ready-for-certificate-transparency/'}}",medium,[],arn:partition:acm:region:account-id:certificate/resource-id,AwsCertificateManagerCertificate,"Domain owners can search the log to identify unexpected certificates, whether issued by mistake or malice. Domain owners can also identify Certificate Authorities (CAs) that are improperly issuing certificates."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/athena/athena_workgroup_logging_enabled/athena_workgroup_logging_enabled.metadata.json,,https://docs.aws.amazon.com/athena/latest/ug/security-logging-monitoring.html,athena,"Enabling logging for a workgroup provides valuable insights into query activity, including user actions, query execution details, and potential security events.",['logging'],,Ensure that logging is enabled for Amazon Athena workgroups to capture query activity.,,[],,['Software and Configuration Checks/AWS Security Best Practices/Logging'],athena_workgroup_logging_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/athena-controls.html#athena-4', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable logging for your Athena workgroups to capture query activity and enhance security monitoring. Configure the output location for logs in a secure S3 bucket and ensure appropriate encryption is applied.', 'Url': 'https://docs.aws.amazon.com/athena/latest/ug/athena-cloudwatch-metrics-enable.html'}}",medium,[],arn:partition:athena:region:account-id:workgroup/resource-id,AwsAthenaWorkGroup,"Without logging enabled, it can be difficult to track and investigate potential security incidents or unauthorized access to Athena data. This can lead to data breaches, compliance violations, and increased security risks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/athena/athena_workgroup_enforce_configuration/athena_workgroup_enforce_configuration.metadata.json,,https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html,athena,Ensure that workgroup configuration is enforced so it cannot be overriden by client-side settings.,[],,Ensure that workgroup configuration is enforced so it cannot be overriden by client-side settings.,,[],,['Software and Configuration Checks'],athena_workgroup_enforce_configuration,"{'Code': {'CLI': 'aws athena update-work-group --region <REGION> --work-group <workgroup_name> --configuration-updates EnforceWorkGroupConfiguration=True', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_33#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_33#terraform'}, 'Recommendation': {'Text': 'Ensure that workgroup configuration is enforced so it cannot be overriden by client-side settings.', 'Url': 'https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html'}}",medium,[],arn:partition:athena:region:account-id:workgroup/resource-id,AwsAthenaWorkGroup,If workgroup configuration is not enforced security settings like encryption can be overriden by client-side settings.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/athena/athena_workgroup_encryption/athena_workgroup_encryption.metadata.json,,https://docs.aws.amazon.com/athena/latest/ug/encryption.html,athena,Ensure that encryption at rest is enabled for Amazon Athena query results stored in Amazon S3 in order to secure data and meet compliance requirements for data-at-rest encryption.,['encryption'],,Ensure that encryption at rest is enabled for Amazon Athena query results stored in Amazon S3 in order to secure data and meet compliance requirements for data-at-rest encryption.,,[],,['Software and Configuration Checks'],athena_workgroup_encryption,"{'Code': {'CLI': 'aws athena update-work-group --region <REGION> --work-group <workgroup_name> --configuration-updates ResultConfigurationUpdates={EncryptionConfiguration={EncryptionOption=SSE_S3|SSE_KMS|CSE_KMS}}', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Athena/encryption-enabled.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-that-athena-workgroup-is-encrypted#terraform'}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.', 'Url': 'https://docs.aws.amazon.com/athena/latest/ug/encrypting-query-results-stored-in-s3.html'}}",medium,[],arn:partition:athena:region:account-id:workgroup/resource-id,AwsAthenaWorkGroup,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/route53/route53_public_hosted_zones_cloudwatch_logging_enabled/route53_public_hosted_zones_cloudwatch_logging_enabled.metadata.json,,https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/monitoring-hosted-zones-with-cloudwatch.html,route53,Check if Route53 public hosted zones are logging queries to CloudWatch Logs.,['forensics-ready'],,Check if Route53 public hosted zones are logging queries to CloudWatch Logs.,,[],,[],route53_public_hosted_zones_cloudwatch_logging_enabled,"{'Code': {'CLI': 'aws route53 create-query-logging-config  --hosted-zone-id <zone_id>  --cloud-watch-logs-log-group-arn <log_group_arn>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Route53/enable-query-logging.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable CloudWatch logs and define metrics and uses cases for the events recorded.', 'Url': 'https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/monitoring-hosted-zones-with-cloudwatch.html'}}",medium,[],,AwsRoute53HostedZone,"If logs are not enabled, monitoring of service use and threat analysis is not possible."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/route53/route53_domains_transferlock_enabled/route53_domains_transferlock_enabled.metadata.json,,https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-lock.html,route53,Enable Transfer Lock for a Route53 Domain.,[],,Enable Transfer Lock for a Route53 Domain.,,[],,[],route53_domains_transferlock_enabled,"{'Code': {'CLI': 'aws route53domains enable-domain-transfer-lock --domain-name DOMAIN', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure transfer lock is enabled.', 'Url': 'https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-lock.html'}}",medium,[],,Other,"Without transfer lock enabled, a domain name could be incorrectly moved to a new registrar."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/route53/route53_domains_privacy_protection_enabled/route53_domains_privacy_protection_enabled.metadata.json,,https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-privacy-protection.html,route53,Enable Privacy Protection for for a Route53 Domain.,[],,Enable Privacy Protection for for a Route53 Domain.,,[],,[],route53_domains_privacy_protection_enabled,"{'Code': {'CLI': 'aws route53domains update-domain-contact-privacy --domain-name domain.com --registrant-privacy', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Route53/privacy-protection.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure default Privacy is enabled.', 'Url': 'https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-privacy-protection.html'}}",medium,[],,Other,"Without privacy protection enabled, ones personal information is published to the public WHOIS database."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/route53/route53_dangling_ip_subdomain_takeover/route53_dangling_ip_subdomain_takeover.metadata.json,,,route53,Check if Route53 Records contains dangling IPs.,['forensics-ready'],,Check if Route53 Records contains dangling IPs.,,[],,[],route53_dangling_ip_subdomain_takeover,"{'Code': {'CLI': 'aws route53 change-resource-record-sets --hosted-zone-id <resource_id>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Route53/dangling-dns-records.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that any dangling DNS records are deleted from your Amazon Route 53 public hosted zones in order to maintain the integrity and authenticity of your domains/subdomains and to protect against domain hijacking attacks.', 'Url': 'https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-deleting.html'}}",high,[],,Other,"When an ephemeral AWS resource such as an Elastic IP (EIP) is released into the Amazon's Elastic IP pool, an attacker may acquire the EIP resource and effectively control the domain/subdomain associated with that EIP in your Route 53 DNS records."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_ldap_exposed_to_internet/ec2_instance_port_ldap_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 389 or 636 (LDAP).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 389 or 636 (LDAP).,,[],instance,['Infrastructure Security'],ec2_instance_port_ldap_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP port 389 or 636 (LDAP).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,LDAP is a protocol used for authentication and authorization. Exposing LDAP to the internet can lead to unauthorized access to the LDAP server and the data it contains.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_any_port/ec2_securitygroup_allow_ingress_from_internet_to_any_port.metadata.json,,,ec2,"Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port and not attached to a network interface with not allowed network interface types or instance owners. By default, the allowed network interface types are 'api_gateway_managed' and 'vpc_endpoint', and the allowed instance owners are 'amazon-elb', you can customize these values by setting the 'ec2_allowed_interface_types' and 'ec2_allowed_instance_owners' variables.",['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_any_port,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,The security group allows all traffic from the internet to any port. This could allow an attacker to access the instance.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_kerberos_exposed_to_internet/ec2_instance_port_kerberos_exposed_to_internet.metadata.json,,,ec2,"Ensure no EC2 instances allow ingress from the internet to TCP port 88, 464, 749 or 750 (Kerberos).",['internet-exposed'],,"Ensure no EC2 instances allow ingress from the internet to TCP port 88, 464, 749 or 750 (Kerberos).",,[],instance,['Infrastructure Security'],ec2_instance_port_kerberos_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP port 88, 464, 749 or 750 (Kerberos).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"Kerberos is a network authentication protocol that uses secret-key cryptography to authenticate clients and servers. It is typically used in environments where users need to authenticate to access network resources. If an EC2 instance allows ingress from the internet to TCP port 88 or 464, it may be vulnerable to unauthorized access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_detailed_monitoring_enabled/ec2_instance_detailed_monitoring_enabled.metadata.json,,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html,ec2,Check if EC2 instances have detailed monitoring enabled.,[],,Check if EC2 instances have detailed monitoring enabled.,,[],,['Infrastructure Security'],ec2_instance_detailed_monitoring_enabled,"{'Code': {'CLI': 'aws ec2 monitor-instances --instance-ids <EC2_INSTANCE_ID>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/instance-detailed-monitoring.html', 'Terraform': 'https://docs.prowler.com/checks/aws/logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances#terraform'}, 'Recommendation': {'Text': 'Enable detailed monitoring for EC2 instances to gain better insights into performance metrics.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html#enable-detailed-monitoring-instance'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Enabling detailed monitoring provides enhanced monitoring and granular insights into EC2 instance metrics. Not having detailed monitoring enabled may limit the ability to troubleshoot performance issues effectively.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_from_launch_wizard/ec2_securitygroup_from_launch_wizard.metadata.json,,,ec2,Security Groups created by EC2 Launch Wizard.,[],,Security Groups created by EC2 Launch Wizard.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_from_launch_wizard,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-prefixed-with-launch-wizard.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Apply Zero Trust approach. Implement a process to scan and remediate security groups created by the EC2 Wizard. Recommended best practices is to use an authorized security group.', 'Url': 'https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,Security Groups Created on the AWS Console using the EC2 wizard may allow port 22 from 0.0.0.0/0.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_not_used/ec2_securitygroup_not_used.metadata.json,,,ec2,Ensure there are no Security Groups not being used.,[],,Ensure there are no Security Groups not being used.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_not_used,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'List all the security groups and then use the cli to check if they are attached to an instance.', 'Url': 'https://aws.amazon.com/premiumsupport/knowledge-center/ec2-find-security-group-resources/'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,Having clear definition and scope for Security Groups creates a better administration environment.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_elastic_ip_unassigned/ec2_elastic_ip_unassigned.metadata.json,,,ec2,Check if there is any unassigned Elastic IP.,[],,Check if there is any unassigned Elastic IP.,,[],,['Infrastructure Security'],ec2_elastic_ip_unassigned,"{'Code': {'CLI': 'aws ec2 release-address --public-ip <theIPyoudontneed>', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_19#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/general_19#ec2-console', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_19#terraform'}, 'Recommendation': {'Text': 'Ensure Elastic IPs are not unassigned.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsEc2Eip,Unassigned Elastic IPs may result in extra cost.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_secrets_user_data/ec2_instance_secrets_user_data.metadata.json,,,ec2,Find secrets in EC2 User Data.,['secrets'],,Find secrets in EC2 User Data.,,[],,['IAM'],ec2_instance_secrets_user_data,"{'Code': {'CLI': 'aws ec2 describe-instance-attribute --attribute userData --region <REGION> --instance-id <INSTANCE_ID> --query UserData.Value --output text > encodeddata; base64 --decode encodeddata', 'NativeIaC': 'https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_1#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_1', 'Terraform': 'https://docs.prowler.com/checks/aws/secrets-policies/bc_aws_secrets_1#terraform'}, 'Recommendation': {'Text': 'Implement automated detective control (e.g. using tools like Prowler) to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html'}}",critical,[],arn:partition:access-analyzer:region:account-id:analyzer/resource-id,AwsEc2Instance,Secrets hardcoded into instance user data can be used by malware and bad actors to gain lateral access to other services.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_cassandra_7199_9160_8888/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_cassandra_7199_9160_8888.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_cassandra_7199_9160_8888,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_default_restrict_traffic/ec2_securitygroup_default_restrict_traffic.metadata.json,,,ec2,Ensure the default security group of every VPC restricts all traffic.,[],,Ensure the default security group of every VPC restricts all traffic.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_default_restrict_traffic,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_4#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/networking_4#terraform'}, 'Recommendation': {'Text': 'Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive security groups. Recommended best practices is to narrow the definition for the minimum ports required.', 'Url': 'https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,"Even having a perimeter firewall, having security groups open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_cifs_exposed_to_internet/ec2_instance_port_cifs_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 139 or 445 (CIFS).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 139 or 445 (CIFS).,,[],instance,['Infrastructure Security'],ec2_instance_port_cifs_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP port 389 or 636 (LDAP).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,CIFS is a file sharing protocol that is used to access files and printers on remote systems. It is not recommended to expose CIFS to the internet.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_uses_single_eni/ec2_instance_uses_single_eni.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ec2-instance-multiple-eni-check.html,ec2,"This control checks whether an EC2 instance uses multiple Elastic Network Interfaces (ENIs) or Elastic Fabric Adapters (EFAs). This control passes if a single network adapter is used. The control includes an optional parameter list to identify the allowed ENIs. This control also fails if an EC2 instance that belongs to an Amazon EKS cluster uses more than one ENI. If your EC2 instances need to have multiple ENIs as part of an Amazon EKS cluster, you can suppress those control findings.",['trustboundaries'],,Amazon EC2 instances should not use multiple ENIs,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ec2_instance_uses_single_eni,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-17', 'Terraform': ''}, 'Recommendation': {'Text': 'To detach a network interface from an EC2 instance, follow the instructions in the Amazon EC2 User Guide.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#detach_eni'}}",low,[],arn:partition:service:region:account-id:instance/resource-id,AwsEc2Instance,"Multiple ENIs can cause dual-homed instances, meaning instances that have multiple subnets. This can add network security complexity and introduce unintended network paths and access."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_kafka_exposed_to_internet/ec2_instance_port_kafka_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 9092 (Kafka).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 9092 (Kafka).,,[],instance,['Infrastructure Security'],ec2_instance_port_kafka_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 9092 (Kafka).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"Kafka is a distributed streaming platform that is used to build real-time data pipelines and streaming applications. Exposing the Kafka port to the internet can lead to unauthorized access to the Kafka cluster, which can result in data leakage, data corruption, and data loss."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_oracle_1521_2483/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_oracle_1521_2483.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_oracle_1521_2483,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_account_imdsv2_enabled/ec2_instance_account_imdsv2_enabled.metadata.json,,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-IMDS-new-instances.html#set-imdsv2-account-defaults,ec2,Ensure Instance Metadata Service Version 2 (IMDSv2) is enforced for EC2 instances at the account level to protect against SSRF vulnerabilities.,['internet-exposed'],,Ensure Instance Metadata Service Version 2 (IMDSv2) is enforced for EC2 instances at the account level to protect against SSRF vulnerabilities.,,[],,['Data Protection'],ec2_instance_account_imdsv2_enabled,"{'Code': {'CLI': 'aws ec2 modify-instance-metadata-defaults --region <region> --http-tokens required --http-put-response-hop-limit 2', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Enable Instance Metadata Service Version 2 (IMDSv2) on the EC2 instances. Apply this configuration at the account level for each AWS Region to set the default instance metadata version.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-IMDS-new-instances.html#set-imdsv2-account-defaults'}}",high,[],arn:partition:service:region:account-id,AwsAccount,EC2 instances that use IMDSv1 are vulnerable to SSRF attacks.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ebs_snapshot_account_block_public_access/ec2_ebs_snapshot_account_block_public_access.metadata.json,,https://docs.aws.amazon.com/ebs/latest/userguide/block-public-access-snapshots-work.html#block-public-access-snapshots-enable,ec2,"EBS snapshots can be shared with other AWS accounts or made public. By default, EBS snapshots are private and only the AWS account that created the snapshot can access it. If an EBS snapshot is shared with another AWS account or made public, the data in the snapshot can be accessed by the other account or by anyone on the internet. Ensure that public access to EBS snapshots is disabled.",['internet-exposed'],,Ensure that public access to EBS snapshots is disabled,,[],snapshot,['Data Protection'],ec2_ebs_snapshot_account_block_public_access,"{'Code': {'CLI': 'aws ec2 enable-snapshot-block-public-access --state block-all-sharing', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use the following procedures to configure and monitor block public access for snapshots.', 'Url': 'https://docs.aws.amazon.com/ebs/latest/userguide/block-public-access-snapshots-work.html#block-public-access-snapshots-enable'}}",high,[],arn:partition:service:region:account-id,AwsAccount,"If public access to EBS snapshots is enabled, the data in the snapshot can be accessed by anyone on the internet."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_mysql_exposed_to_internet/ec2_instance_port_mysql_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 3306 (MySQL).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 3306 (MySQL).,,[],instance,['Infrastructure Security'],ec2_instance_port_mysql_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 3306 (MySQL).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,MySQL is a popular open-source relational database management system that is widely used in web applications. Exposing MySQL to the internet can lead to unauthorized access and data exfiltration.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_kafka_9092/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_kafka_9092.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Kafka port 9092.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Kafka port 9092.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_kafka_9092,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_port_mongodb_27017_27018/ec2_securitygroup_allow_ingress_from_internet_to_port_mongodb_27017_27018.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_port_mongodb_27017_27018,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_ssh_exposed_to_internet/ec2_instance_port_ssh_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 22 (SSH).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 22 (SSH),,[],instance,['Infrastructure Security'],ec2_instance_port_ssh_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 22.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"SSH is a common target for brute force attacks. If an EC2 instance allows ingress from the internet to TCP port 22, it is at risk of being compromised."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_postgres_5432/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_postgres_5432.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_postgres_5432,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_elastic_ip_shodan/ec2_elastic_ip_shodan.metadata.json,,,ec2,Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY).,['internet-exposed'],,Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY).,,[],,['Infrastructure Security'],ec2_elastic_ip_shodan,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Check Identified IPs, consider changing them to private ones and delete them from Shodan.', 'Url': 'https://www.shodan.io/'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2Eip,Sites like Shodan index exposed systems and further expose them to wider audiences as a quick way to find exploitable systems.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_rdp_exposed_to_internet/ec2_instance_port_rdp_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 3389 (RDP).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 3389 (RDP),,[],instance,['Infrastructure Security'],ec2_instance_port_rdp_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 3389 (RDP).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,RDP is a proprietary protocol developed by Microsoft for connecting to Windows systems. Exposing RDP to the internet can allow attackers to brute force the login credentials and gain unauthorized access to the EC2 instance.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_internet_facing_with_instance_profile/ec2_instance_internet_facing_with_instance_profile.metadata.json,,,ec2,Check for internet facing EC2 instances with Instance Profiles attached.,['internet-exposed'],,Check for internet facing EC2 instances with Instance Profiles attached.,,[],,['Infrastructure Security'],ec2_instance_internet_facing_with_instance_profile,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use an ALB and apply WAF ACL.', 'Url': 'https://aws.amazon.com/blogs/aws/aws-web-application-firewall-waf-for-application-load-balancers/'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Exposing an EC2 directly to internet increases the attack surface and therefore the risk of compromise.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_redis_6379/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_redis_6379.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_redis_6379,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_paravirtual_type/ec2_instance_paravirtual_type.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ec2-paravirtual-instance-check.html,ec2,Ensure that the virtualization type of an EC2 instance is not paravirtual. The control fails if the virtualizationType of the EC2 instance is set to paravirtual.,[],,Amazon EC2 paravirtual virtualization type should not be used.,,[],,[],ec2_instance_paravirtual_type,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-24', 'Terraform': ''}, 'Recommendation': {'Text': 'To update an EC2 instance to a new instance type, see Change the instance type in the Amazon EC2 User Guide.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-resize.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"Using paravirtual instances can limit performance and security benefits offered by hardware virtual machine (HVM) instances, such as improved CPU, network, and storage efficiency."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_wide_open_public_ipv4/ec2_securitygroup_allow_wide_open_public_ipv4.metadata.json,,,ec2,Ensure no security groups allow ingress and egress from wide-open IP address with a mask between 0 and 24.,['internet-exposed'],,Ensure no security groups allow ingress and egress from wide-open IP address with a mask between 0 and 24.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_wide_open_public_ipv4,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_cassandra_exposed_to_internet/ec2_instance_port_cassandra_exposed_to_internet.metadata.json,,,ec2,"Ensure no EC2 instances allow ingress from the internet to Cassandra ports (TCP 7000, 7001, 7199, 9042, 9160).",['internet-exposed'],,"Ensure no EC2 instances allow ingress from the internet to Cassandra ports (TCP 7000, 7001, 7199, 9042, 9160).",,[],instance,['Infrastructure Security'],ec2_instance_port_cassandra_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP ports 7000, 7001, 7199, 9042 or 9160.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"Cassandra is a distributed database management system designed to handle large amounts of data across many commodity servers, providing high availability with no single point of failure. Exposing Cassandra ports to the internet can lead to unauthorized access to the database, data exfiltration, and data loss."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_launch_template_imdsv2_required/ec2_launch_template_imdsv2_required.metadata.json,,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html,ec2,This control checks if Amazon EC2 launch templates are configured with IMDSv2 enabled and required. The control fails if IMDSv2 is not enabled or required in the launch template versions.,[],,Amazon EC2 launch templates should have IMDSv2 enabled and required.,,[],,['Software and Configuration Checks/AWS Security Best Practices'],ec2_launch_template_imdsv2_required,"{'Code': {'CLI': 'aws ec2 modify-launch-template --launch-template-id <template-id> --version <version-number> --metadata-options HttpTokens=required', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-170', 'Terraform': ''}, 'Recommendation': {'Text': 'To ensure EC2 launch templates have IMDSv2 enabled and required, update the template to configure the Instance Metadata Service Version 2 as required.', 'Url': 'https://docs.aws.amazon.com/autoscaling/ec2/userguide/create-launch-template.html#change-metadata-options'}}",high,[],arn:aws:ec2:region:account-id:launch-template/resource-id,AwsEc2LaunchTemplate,"Without IMDSv2 required, EC2 instances may be vulnerable to metadata service attacks, allowing unauthorized access to instance metadata, potentially leading to compromise of instance credentials or other sensitive data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_telnet_23/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_telnet_23.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Telnet port 23.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Telnet port 23.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_telnet_23,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_sql_server_1433_1434/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_sql_server_1433_1434.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Windows SQL Server ports 1433 or 1434.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Windows SQL Server ports 1433 or 1434.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_sql_server_1433_1434,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_memcached_exposed_to_internet/ec2_instance_port_memcached_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 11211 (Memcached).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 11211 (Memcached).,,[],instance,['Infrastructure Security'],ec2_instance_port_memcached_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 11211 (Memcached).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"Memcached is an open-source, high-performance, distributed memory object caching system. It is often used to speed up dynamic database-driven websites by caching data and objects in RAM to reduce the number of times an external data source must be read. Memcached is designed to be used in trusted environments and should not be exposed to the internet. If Memcached is exposed to the internet, it can be exploited by attackers to perform distributed denial-of-service (DDoS) attacks, data exfiltration, and other malicious activities."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_managed_by_ssm/ec2_instance_managed_by_ssm.metadata.json,,,ec2,Check if EC2 instances are managed by Systems Manager.,[],,Check if EC2 instances are managed by Systems Manager.,,[],instance,['Infrastructure Security'],ec2_instance_managed_by_ssm,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SSM/ssm-managed-instances.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Verify and apply Systems Manager Prerequisites.', 'Url': 'https://docs.aws.amazon.com/systems-manager/latest/userguide/managed_instances.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"AWS Config provides AWS Managed Rules, which are predefined, customizable rules that AWS Config uses to evaluate whether your AWS resource configurations comply with common best practices."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_networkacl_allow_ingress_any_port/ec2_networkacl_allow_ingress_any_port.metadata.json,,,ec2,Ensure no Network ACLs allow ingress from 0.0.0.0/0 to any port.,['internet-exposed'],Infrastructure Security,Ensure no Network ACLs allow ingress from 0.0.0.0/0 to any port.,,[],networkacl,"['Software and Configuration Checks', 'Industry and Regulatory Standards', 'CIS AWS Foundations Benchmark']",ec2_networkacl_allow_ingress_any_port,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2NetworkAcl,"Even having a perimeter firewall, having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_mysql_3306/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_mysql_3306.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306.,,[],securitygroups,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_mysql_3306,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ebs_public_snapshot/ec2_ebs_public_snapshot.metadata.json,,,ec2,Ensure there are no EBS Snapshots set as Public.,['internet-exposed'],,Ensure there are no EBS Snapshots set as Public.,,[],snapshot,['Data Protection'],ec2_ebs_public_snapshot,"{'Code': {'CLI': 'aws ec2 modify-snapshot-attribute --region <REGION> --snapshot-id <EC2_SNAPSHOT_ID> --attribute createVolumePermission --operation remove --user-ids all', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/public-policies/public_7', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure the snapshot should be shared.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-modifying-snapshot-permissions.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,Other,"When you share a snapshot, you are giving others access to all of the data on the snapshot. Share snapshots only with people with whom you want to share all of your snapshot data."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_networkacl_unused/ec2_networkacl_unused.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/vpc-network-acl-unused-check.html,ec2,Ensure that there are no unused network access control lists (network ACLs) in your virtual private cloud (VPC). The control fails if the network ACL isn't associated with a subnet. The control doesn't generate findings for an unused default network ACL.,['internet-exposed'],Infrastructure Security,Unused Network Access Control Lists should be removed.,,[],,[],ec2_networkacl_unused,"{'Code': {'CLI': 'aws ec2 delete-network-acl --network-acl-id <nacl_id>', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-16', 'Terraform': ''}, 'Recommendation': {'Text': 'For instructions on deleting an unused network ACL, see Deleting a network ACL in the Amazon VPC User Guide.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#vpc-network-acl-delete'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsEc2NetworkAcl,"Unused network ACLs may represent a potential security risk if left in place without purpose, as they could be mistakenly associated with subnets later."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ebs_default_encryption/ec2_ebs_default_encryption.metadata.json,,,ec2,Check if EBS Default Encryption is activated.,['encryption'],,Check if EBS Default Encryption is activated.,,[],ebs,['Data Protection'],ec2_ebs_default_encryption,"{'Code': {'CLI': 'aws ec2 enable-ebs-encryption-by-default', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/ensure-ebs-default-encryption-is-enabled#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/ensure-ebs-default-encryption-is-enabled#terraform'}, 'Recommendation': {'Text': 'Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.', 'Url': 'https://aws.amazon.com/premiumsupport/knowledge-center/ebs-automatic-encryption/'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,If not enabled sensitive information at rest is not protected.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_networkacl_allow_ingress_tcp_port_3389/ec2_networkacl_allow_ingress_tcp_port_3389.metadata.json,,,ec2,Ensure no Network ACLs allow ingress from 0.0.0.0/0 to Microsoft RDP port 3389,['internet-exposed'],,Ensure no Network ACLs allow ingress from 0.0.0.0/0 to Microsoft RDP port 3389,,[],networkacl,['Infrastructure Security'],ec2_networkacl_allow_ingress_tcp_port_3389,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-3389#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-3389#terraform'}, 'Recommendation': {'Text': 'Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2NetworkAcl,"Even having a perimeter firewall, having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ebs_volume_snapshots_exists/ec2_ebs_volume_snapshots_exists.metadata.json,,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSSnapshots.html,ec2,Check if EBS snapshots exists.,['forensics-ready'],,Check if EBS snapshots exists.,,[],volume,['Data Protection'],ec2_ebs_volume_snapshots_exists,"{'Code': {'CLI': 'aws ec2 --region <REGION> create-snapshot --volume-id <VOLUME-ID>', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/EBS/ebs-volumes-recent-snapshots.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Creating point-in-time EBS snapshots periodically will allow you to handle efficiently your data recovery process in the event of a failure, to save your data before shutting down an EC2 instance, to back up data for geographical expansion and to maintain your disaster recovery stack up to date.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSSnapshots.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Volume,"Ensure that your EBS volumes (available or in-use) have recent snapshots (taken weekly) available for point-in-time recovery for a better, more reliable data backup strategy."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_transitgateway_auto_accept_vpc_attachments/ec2_transitgateway_auto_accept_vpc_attachments.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ec2-transit-gateway-auto-vpc-attach-disabled.html,ec2,Ensure EC2 transit gateways are not automatically accepting shared VPC attachments. We get a fail if a transit gateway is configured to automatically accept shared VPC attachment requests.,[],,Amazon EC2 Transit Gateways should not automatically accept VPC attachment requests,,[],transit-gateway,['Infrastructure Security'],ec2_transitgateway_auto_accept_vpc_attachments,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-23', 'Terraform': ''}, 'Recommendation': {'Text': 'Turn off AutoAcceptSharedAttachments to ensure that only authorized VPC attachment requests are accepted', 'Url': 'https://docs.aws.amazon.com/vpc/latest/tgw/tgw-transit-gateways.html#tgw-modifying'}}",high,[],arn:aws:ec2:region:account-id:transit-gateway/tgw-id,AwsEc2TransitGateway,"Turning on AutoAcceptSharedAttachments allows a transit gateway to automatically accept any cross-account VPC attachment requests without verification. This increases the risk of unauthorized VPC attachments, compromising network security."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_postgresql_exposed_to_internet/ec2_instance_port_postgresql_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 5432 (PostgreSQL).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 5432 (PostgreSQL),,[],instance,['Infrastructure Security'],ec2_instance_port_postgresql_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 5432 (PostgreSQL).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"PostgreSQL is a popular open-source relational database management system. Exposing the PostgreSQL port to the internet can lead to unauthorized access to the database, data exfiltration, and other security risks."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_ftp_port_20_21/ec2_securitygroup_allow_ingress_from_internet_to_tcp_ftp_port_20_21.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to FTP ports 20 or 21.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to FTP ports 20 or 21.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_ftp_port_20_21,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_with_many_ingress_egress_rules/ec2_securitygroup_with_many_ingress_egress_rules.metadata.json,,,ec2,Find security groups with more than 50 ingress or egress rules.,[],,Find security groups with more than 50 ingress or egress rules.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_with_many_ingress_egress_rules,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ebs_snapshots_encrypted/ec2_ebs_snapshots_encrypted.metadata.json,,,ec2,Check if EBS snapshots are encrypted.,['encryption'],,Check if EBS snapshots are encrypted.,,[],snapshot,['Data Protection'],ec2_ebs_snapshots_encrypted,"{'Code': {'CLI': 'aws ec2 --region <REGION> enable-ebs-encryption-by-default', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/general_3-encrypt-ebs-volume#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/general-policies/general_3-encrypt-ebs-volume#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/general_3-encrypt-ebs-volume#terraform'}, 'Recommendation': {'Text': 'Encrypt all EBS Snapshot and Enable Encryption by default. You can configure your AWS account to enforce the encryption of the new EBS volumes and snapshot copies that you create. For example, Amazon EBS encrypts the EBS volumes created when you launch an instance and the snapshots that you copy from an unencrypted snapshot.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default'}}",medium,[],arn:partition:service:region:account-id:resource-id,Other,Data encryption at rest prevents data visibility in the event of its unauthorized access or theft.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ami_public/ec2_ami_public.metadata.json,,,ec2,Ensure there are no EC2 AMIs set as Public.,['internet-exposed'],,Ensure there are no EC2 AMIs set as Public.,,[],ami,['Infrastructure Security'],ec2_ami_public,"{'Code': {'CLI': 'aws ec2 modify-image-attribute --region <REGION> --image-id <EC2_AMI_ID> --launch-permission {""Remove"":[{""Group"":""all""}]}', 'NativeIaC': '', 'Other': 'https://docs.prowler.com/checks/aws/public-policies/public_8', 'Terraform': ''}, 'Recommendation': {'Text': 'We recommend your EC2 AMIs are not publicly accessible, or generally available in the Community AMIs.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/cancel-sharing-an-AMI.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,Other,"When your AMIs are publicly accessible, they are available in the Community AMIs where everyone with an AWS account can use them to launch EC2 instances. Your AMIs could contain snapshots of your applications (including their data), therefore exposing your snapshots in this manner is not advised."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_oracle_exposed_to_internet/ec2_instance_port_oracle_exposed_to_internet.metadata.json,,,ec2,"Ensure no EC2 instances allow ingress from the internet to TCP port 1521, 2483 or 2484 (Oracle).",['internet-exposed'],,"Ensure no EC2 instances allow ingress from the internet to TCP port 1521, 2483 or 2484 (Oracle).",,[],instance,['Infrastructure Security'],ec2_instance_port_oracle_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP port 1521, 2483 or 2484.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Oracle database servers are a high value target for attackers. Allowing internet access to these ports could lead to unauthorized access to the database.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_older_than_specific_days/ec2_instance_older_than_specific_days.metadata.json,,,ec2,Check EC2 Instances older than specific days.,[],,Check EC2 Instances older than specific days.,,[],,['Infrastructure Security'],ec2_instance_older_than_specific_days,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/ec2-instance-too-old.html', 'Terraform': ''}, 'Recommendation': {'Text': 'Check if software running in the instance is up to date and patched accordingly. Use AWS Systems Manager to patch instances and view patching compliance information.', 'Url': 'https://docs.aws.amazon.com/systems-manager/latest/userguide/viewing-patch-compliance-results.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Having old instances within your AWS account could increase the risk of having vulnerable software.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_launch_template_no_secrets/ec2_launch_template_no_secrets.metadata.json,,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html,ec2,Find secrets in EC2 Launch Template,['secrets'],,Find secrets in EC2 Launch Template,,[],,[],ec2_launch_template_no_secrets,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Do not include sensitive information in user data within the launch templates, try to use Secrets Manager instead.', 'Url': 'https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html'}}",critical,[],arn:partition:ec2:region:account-id:launch-template/template-id,AwsEc2LaunchTemplate,"The use of a hard-coded password increases the possibility of password guessing.  If hard-coded passwords are used, it is possible that malicious users gain access through the account in question."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_elasticsearch_kibana_9200_9300_5601/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_elasticsearch_kibana_9200_9300_5601.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_elasticsearch_kibana_9200_9300_5601,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_imdsv2_enabled/ec2_instance_imdsv2_enabled.metadata.json,,,ec2,Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required.,[],,Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required.,,[],,['Infrastructure Security'],ec2_instance_imdsv2_enabled,"{'Code': {'CLI': 'aws ec2 modify-instance-metadata-options --instance-id <instance-id> --http-tokens required --http-endpoint enabled', 'NativeIaC': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_31#cloudformation', 'Other': 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/require-imds-v2.html', 'Terraform': 'https://docs.prowler.com/checks/aws/general-policies/bc_aws_general_31#terraform'}, 'Recommendation': {'Text': ""If you don't need IMDS you can turn it off. Using aws-cli you can force the instance to use only IMDSv2."", 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html#configuring-instance-metadata-options'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Using IMDSv2 will protect from misconfiguration and SSRF vulnerabilities. IMDSv1 will not.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ebs_volume_encryption/ec2_ebs_volume_encryption.metadata.json,,,ec2,Ensure there are no EBS Volumes unencrypted.,['encryption'],,Ensure there are no EBS Volumes unencrypted.,,[],volume,['Data Protection'],ec2_ebs_volume_encryption,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Encrypt all EBS volumes and Enable Encryption by default You can configure your AWS account to enforce the encryption of the new EBS volumes and snapshot copies that you create. For example, Amazon EBS encrypts the EBS volumes created when you launch an instance and the snapshots that you copy from an unencrypted snapshot.', 'Url': 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Volume,Data encryption at rest prevents data visibility in the event of its unauthorized access or theft.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_client_vpn_endpoint_connection_logging_enabled/ec2_client_vpn_endpoint_connection_logging_enabled.metadata.json,,https://docs.aws.amazon.com/vpn/latest/clientvpn-admin/what-is.html,ec2,This control checks whether an AWS Client VPN endpoint has client connection logging enabled. The control fails if the endpoint doesn't have client connection logging enabled.,[],,EC2 Client VPN endpoints should have client connection logging enabled.,,[],,[],ec2_client_vpn_endpoint_connection_logging_enabled,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-51', 'Terraform': ''}, 'Recommendation': {'Text': 'To enable connection logging, see Enable connection logging for an existing Client VPN endpoint in the AWS Client VPN Administrator Guide.', 'Url': 'https://docs.aws.amazon.com/config/latest/developerguide/ec2-client-vpn-connection-log-enabled.html'}}",low,[],arn:partition:service:region:account-id:resource-id,AwsEc2ClientVpnEndpoint,Client VPN endpoints allow remote clients to securely connect to resources in a Virtual Private Cloud (VPC) in AWS. Connection logs allow you to track user activity on the VPN endpoint and provides visibility.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_22/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_22.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to SSH port 22.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to SSH port 22.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_22,"{'Code': {'CLI': 'aws ec2 revoke-security-group-ingress --group-id <GROUP_ID> --protocol tcp --port 22 --cidr', 'NativeIaC': 'https://docs.prowler.com/checks/aws/networking-policies/networking_1-port-security#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_1-port-security', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/networking_1-port-security#terraform'}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_elasticsearch_kibana_exposed_to_internet/ec2_instance_port_elasticsearch_kibana_exposed_to_internet.metadata.json,,,ec2,"Ensure no EC2 instances allow ingress from the internet to Elasticsearch and Kibana ports (TCP 9200, 9300, 5601).",['internet-exposed'],,"Ensure no EC2 instances allow ingress from the internet to Elasticsearch and Kibana ports (TCP 9200, 9300, 5601).",,[],instance,['Infrastructure Security'],ec2_instance_port_elasticsearch_kibana_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP ports 9200, 9300, 5601.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Elasticsearch and Kibana are commonly used for log and data analysis. Allowing ingress from the internet to these ports can expose sensitive data to unauthorized users.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_redis_exposed_to_internet/ec2_instance_port_redis_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 6379 (Redis).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 6379 (Redis).,,[],instance,['Infrastructure Security'],ec2_instance_port_redis_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 6379 (Redis).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"Redis is an open-source, in-memory data structure store, used as a database, cache, and message broker. Redis is often used to store sensitive data, such as session tokens, user credentials, and other sensitive information. Allowing ingress from the internet to TCP port 6379 (Redis) can expose sensitive data to unauthorized users."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_3389/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_3389.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_3389,"{'Code': {'CLI': 'aws ec2 revoke-security-group-ingress --group-id <GROUP_ID> --protocol tcp --port 3389 --cidr', 'NativeIaC': 'https://docs.prowler.com/checks/aws/networking-policies/networking_2#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/networking-policies/networking_2', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/networking_2#terraform'}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_launch_template_no_public_ip/ec2_launch_template_no_public_ip.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ec2-launch-template-public-ip-disabled.html,ec2,This control checks if Amazon EC2 launch templates are configured to assign public IP addresses to network interfaces upon launch. The control fails if an EC2 launch template is configured to assign a public IP address to network interfaces or if there is at least one network interface that has a public IP address.,[],,Amazon EC2 launch templates should not assign public IPs to network interfaces.,,[],,[],ec2_launch_template_no_public_ip,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-25', 'Terraform': ''}, 'Recommendation': {'Text': 'To update an EC2 launch template, see Change the default network interface settings in the Amazon EC2 Auto Scaling User Guide.', 'Url': 'https://docs.aws.amazon.com/autoscaling/ec2/userguide/create-launch-template.html#change-network-interface'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2LaunchTemplate,"A public IP address is reachable from the internet, making associated resources potentially accessible from the internet. EC2 resources should not be publicly accessible to avoid unintended access to workloads."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_profile_attached/ec2_instance_profile_attached.metadata.json,,,ec2,Ensure IAM instance roles are used for AWS resource access from instances.,[],,Ensure IAM instance roles are used for AWS resource access from instances,,[],,['Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark'],ec2_instance_profile_attached,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://github.com/cloudmatos/matos/tree/master/remediations/aws/ec2/attach_iam_roles_ec2_instances', 'Terraform': ''}, 'Recommendation': {'Text': 'Create an IAM instance role if necessary and attach it to the corresponding EC2 instance..', 'Url': 'http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"AWS access from within AWS instances can be done by either encoding AWS keys into AWS API calls or by assigning the instance to a role which has an appropriate permissions policy for the required access. AWS IAM roles reduce the risks associated with sharing and rotating credentials that can be used outside of AWS itself. If credentials are compromised, they can be used from outside of the AWS account."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_sqlserver_exposed_to_internet/ec2_instance_port_sqlserver_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 1433 or 1434 (SQL Server).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 1433 or 1434 (SQL Server).,,[],instance,['Infrastructure Security'],ec2_instance_port_sqlserver_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP port 1433 or 1434 (SQL Server).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"SQL Server is a database management system that is used to store and retrieve data. If an EC2 instance allows ingress from the internet to TCP port 1433 or 1434, it may be vulnerable to unauthorized access and data exfiltration."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_ebs_volume_protected_by_backup_plan/ec2_ebs_volume_protected_by_backup_plan.metadata.json,,https://docs.aws.amazon.com/config/latest/developerguide/ebs-resources-protected-by-backup-plan.html,ec2,"Evaluates if an Amazon EBS volume in in-use state is covered by a backup plan. The check fails if an EBS volume isn't covered by a backup plan. If you set the backupVaultLockCheck parameter equal to true, the control passes only if the EBS volume is backed up in an AWS Backup locked vault.",['redundancy'],,Amazon EBS volumes should be protected by a backup plan.,,[],,"['Software and Configuration Checks, AWS Security Best Practices']",ec2_ebs_volume_protected_by_backup_plan,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': 'https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-28', 'Terraform': ''}, 'Recommendation': {'Text': 'Ensure that all in-use Amazon EBS volumes are included in a backup plan, and consider using AWS Backup Vault Lock for additional protection.', 'Url': 'https://docs.aws.amazon.com/aws-backup/latest/devguide/assigning-resources.html'}}",low,[],arn:partition:service:region:account-id:volume/volume-id,AwsEc2Volume,"Without backup coverage, Amazon EBS volumes are vulnerable to data loss or deletion, reducing the resilience of your systems and making recovery from incidents more difficult."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_memcached_11211/ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_memcached_11211.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_tcp_port_memcached_11211,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_ftp_exposed_to_internet/ec2_instance_port_ftp_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 20 or 21 (FTP).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 20 or 21 (FTP),,[],instance,['Infrastructure Security'],ec2_instance_port_ftp_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP port 20 or 21 (FTP).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"FTP is an insecure protocol and should not be used. If FTP is required, it should be used over a secure channel such as FTPS or SFTP."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_public_ip/ec2_instance_public_ip.metadata.json,,,ec2,Check for EC2 Instances with Public IP.,['internet-exposed'],,Check for EC2 Instances with Public IP.,,[],instance,['Infrastructure Security'],ec2_instance_public_ip,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/public-policies/public_12#cloudformation', 'Other': 'https://docs.prowler.com/checks/aws/public-policies/public_12#aws-console', 'Terraform': 'https://docs.prowler.com/checks/aws/public-policies/public_12#terraform'}, 'Recommendation': {'Text': 'Use an ALB and apply WAF ACL.', 'Url': 'https://aws.amazon.com/blogs/aws/aws-web-application-firewall-waf-for-application-load-balancers/'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Exposing an EC2 directly to internet increases the attack surface and therefore the risk of compromise.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_networkacl_allow_ingress_tcp_port_22/ec2_networkacl_allow_ingress_tcp_port_22.metadata.json,,,ec2,Ensure no Network ACLs allow ingress from 0.0.0.0/0 to SSH port 22,['internet-exposed'],,Ensure no Network ACLs allow ingress from 0.0.0.0/0 to SSH port 22,,[],networkacl,['Infrastructure Security'],ec2_networkacl_allow_ingress_tcp_port_22,"{'Code': {'CLI': '', 'NativeIaC': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-22#cloudformation', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-22#terraform'}, 'Recommendation': {'Text': 'Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html'}}",medium,[],arn:partition:service:region:account-id:resource-id,AwsEc2NetworkAcl,"Even having a perimeter firewall, having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_mongodb_exposed_to_internet/ec2_instance_port_mongodb_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 27017 or 27018 (MongoDB).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 27017 or 27018 (MongoDB),,[],instance,['Infrastructure Security'],ec2_instance_port_mongodb_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group to remove the rule that allows ingress from the internet to TCP port 27017 or 27018 (MongoDB).', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,"MongoDB is a popular NoSQL database that is often used in web applications. If an EC2 instance allows ingress from the internet to TCP port 27017 or 27018, it may be vulnerable to unauthorized access and data exfiltration."
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_all_ports/ec2_securitygroup_allow_ingress_from_internet_to_all_ports.metadata.json,,,ec2,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to all ports.,['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to all ports.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_all_ports,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': 'https://docs.prowler.com/checks/aws/networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports/'}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",high,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased. An attacker could exploit this misconfiguration to gain unauthorized access to resources.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_securitygroup_allow_ingress_from_internet_to_high_risk_tcp_ports/ec2_securitygroup_allow_ingress_from_internet_to_high_risk_tcp_ports.metadata.json,,,ec2,"Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to ports 25(SMTP), 110(POP3), 135(RCP), 143(IMAP), 445(CIFS), 3000(Go, Node.js, and Ruby web developemnt frameworks), 4333(ahsp), 5000(Python web development frameworks), 5500(fcp-addr-srvr1), 8080(proxy), 8088(legacy HTTP port).",['internet-exposed'],,Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to high risk ports.,,[],securitygroup,['Infrastructure Security'],ec2_securitygroup_allow_ingress_from_internet_to_high_risk_tcp_ports,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2SecurityGroup,If Security groups are not properly configured the attack surface is increased.
aws,/Users/apple/Desktop/github/prowler/providers/aws/services/ec2/ec2_instance_port_telnet_exposed_to_internet/ec2_instance_port_telnet_exposed_to_internet.metadata.json,,,ec2,Ensure no EC2 instances allow ingress from the internet to TCP port 23 (Telnet).,['internet-exposed'],,Ensure no EC2 instances allow ingress from the internet to TCP port 23 (Telnet).,,[],instance,['Infrastructure Security'],ec2_instance_port_telnet_exposed_to_internet,"{'Code': {'CLI': '', 'NativeIaC': '', 'Other': '', 'Terraform': ''}, 'Recommendation': {'Text': 'Modify the security group associated with the EC2 instance to remove the rule that allows ingress from the internet to TCP port 23.', 'Url': 'https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html'}}",critical,[],arn:partition:service:region:account-id:resource-id,AwsEc2Instance,Telnet is an insecure protocol that transmits data in plain text. Exposure of Telnet services to the internet can lead to unauthorized access to the EC2 instance.
